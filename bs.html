<!doctype html>
<html>
<head>
<style>
#hiddenstuff{
	display: none;
}
#content{
	max-width: 600px;
	text-align: center;
}
div.title{
	font-size: 24px;
	font-weight: bold;
}
div.instructions{
	margin: 20px;
	text-align: left;
}
#spork{
	margin: 20px;
}
button{
	margin: 10px;
}
#samplestuff{
	display: none;
}
table{
	margin: auto;
}
</style>
<script src='spork.js'></script>
<script>


var invZ=1.959963986;
var invT=[0, 12.70620474 , 4.30265273 , 3.182446305 , 2.776445105 , 2.570581836 , 2.446911851 , 2.364624252 , 2.306004135 , 2.262157163 , 2.228138852 , 2.20098516 , 2.17881283 , 2.160368656 , 2.144786688 , 2.131449546 , 2.119905299 , 2.109815578 , 2.10092204 , 2.093024054 , 2.085963447 , 2.079613845 , 2.073873068 , 2.06865761 , 2.063898562 , 2.059538553 , 2.055529439 , 2.051830516 , 2.048407142 , 2.045229642 , 2.042272456 , 2.039513446 , 2.036933343 , 2.034515297 , 2.032244509 , 2.030107928 , 2.028094001 , 2.026192463 , 2.024394164 , 2.02269092 , 2.02107539 , 2.01954097 , 2.018081703 , 2.016692199 , 2.015367574 , 2.014103389 , 2.012895599 , 2.011740514 , 2.010634758 , 2.009575237 , 2.008559112 , 2.00758377 , 2.006646805 , 2.005745995 , 2.004879288 , 2.004044783 , 2.003240719 , 2.002465459 , 2.001717484 , 2.000995378 , 2.000297822 , 1.999623585 , 1.998971517 , 1.998340543 , 1.997729654 , 1.997137908 , 1.996564419 , 1.996008354 , 1.995468931 , 1.994945415 , 1.994437112 , 1.993943368 , 1.993463567 , 1.992997126 , 1.992543495 , 1.992102154 , 1.99167261 , 1.991254395 , 1.990847069 , 1.99045021 , 1.990063421 , 1.989686323 , 1.989318557 , 1.98895978 , 1.988609667 , 1.988267907 , 1.987934206 , 1.987608282 , 1.987289865 , 1.9869787 , 1.986674541 , 1.986377154 , 1.986086317 , 1.985801814 , 1.985523442 , 1.985251004 , 1.984984312 , 1.984723186 , 1.984467455 , 1.984216952 , 1.983971519 , 1.983731003 , 1.983495259 , 1.983264145 , 1.983037526 , 1.982815274 , 1.982597262 , 1.98238337 , 1.982173483 , 1.98196749 , 1.981765282 , 1.981566757 , 1.981371815 , 1.981180359 , 1.980992298 , 1.980807541 , 1.980626002 , 1.980447599 , 1.980272249 , 1.980099876 , 1.979930405 , 1.979763763 , 1.979599878 , 1.979438685 , 1.979280117 , 1.979124109 , 1.978970602 , 1.978819535 , 1.97867085 , 1.978524491 , 1.978380405 , 1.978238539 , 1.978098842 , 1.977961264 , 1.977825758 , 1.977692277 , 1.977560777 , 1.977431212 , 1.977303542 , 1.977177724 , 1.97705372 , 1.976931489 , 1.976810994 , 1.976692198 , 1.976575066 , 1.976459563 , 1.976345655 , 1.976233309 , 1.976122494 , 1.976013178 , 1.975905331 , 1.975798924 , 1.975693928 , 1.975590315 , 1.975488058 , 1.975387131 , 1.975287508 , 1.975189163 , 1.975092073 , 1.974996213 , 1.97490156 , 1.974808092 , 1.974715786 , 1.974624621 , 1.974534576 , 1.97444563 , 1.974357764 , 1.974270957 , 1.974185191 , 1.974100447 , 1.974016708 , 1.973933954 , 1.973852169 , 1.973771337 , 1.97369144 , 1.973612462 , 1.973534388 , 1.973457202 , 1.973380889 , 1.973305434 , 1.973230823 , 1.973157042 , 1.973084077 , 1.973011915 , 1.972940542 , 1.972869946 , 1.972800114 , 1.972731033 , 1.972662692 , 1.972595079 , 1.972528182 , 1.97246199 , 1.972396491 , 1.972331676 , 1.972267533 , 1.972204051 , 1.972141222 , 1.972079034 , 1.972017478 , 1.971956544 , 1.971896224 , 1.971836507 , 1.971777385 , 1.971718848 , 1.971660889 , 1.971603499 , 1.971546669 , 1.971490392 , 1.971434659 , 1.971379462 , 1.971324793 , 1.971270646 , 1.971217013 , 1.971163885 , 1.971111258 , 1.971059122 , 1.971007472 , 1.970956301 , 1.970905601 , 1.970855367 , 1.970805592 , 1.97075627 , 1.970707395 , 1.970658961 , 1.970610961 , 1.97056339 , 1.970516243 , 1.970469513 , 1.970423195 , 1.970377283 , 1.970331773 , 1.970286659 , 1.970241936 , 1.970197599 , 1.970153643 , 1.970110062 , 1.970066853 , 1.97002401 , 1.96998153 , 1.969939406 , 1.969897635 , 1.969856213 , 1.969815134 , 1.969774395 , 1.969733992 , 1.969693921 , 1.969654176 , 1.969614755 , 1.969575654 , 1.969536868 , 1.969498393 , 1.969460227 , 1.969422365 , 1.969384804 , 1.96934754 , 1.96931057 , 1.96927389 , 1.969237496 , 1.969201386 , 1.969165556 , 1.969130003 , 1.969094724 , 1.969059715 , 1.969024974 , 1.968990497 , 1.968956281 , 1.968922324 , 1.968888622 , 1.968855173 , 1.968821974 , 1.968789022 , 1.968756314 , 1.968723847 , 1.96869162 , 1.968659628 , 1.968627871 , 1.968596344 , 1.968565046 , 1.968533975 , 1.968503127 , 1.9684725 , 1.968442092 , 1.968411901 , 1.968381923 , 1.968352158 , 1.968322603 , 1.968293255 , 1.968264113 , 1.968235174 , 1.968206436 , 1.968177896 , 1.968149554 , 1.968121407 , 1.968093453 , 1.968065689 , 1.968038115 , 1.968010728 , 1.967983525 , 1.967956506 , 1.967929669 , 1.967903011 , 1.967876531 , 1.967850227 , 1.967824098 , 1.967798141 , 1.967772355 , 1.967746738 , 1.967721288 , 1.967696005 , 1.967670885 , 1.967645929 , 1.967621133 , 1.967596497 , 1.967572019 , 1.967547698 , 1.967523532 , 1.967499519 , 1.967475658 , 1.967451948 , 1.967428387 , 1.967404974 , 1.967381707 , 1.967358585 , 1.967335607 , 1.967312772 , 1.967290077 , 1.967267522 , 1.967245106 , 1.967222827 , 1.967200683 , 1.967178675 , 1.9671568 , 1.967135057 , 1.967113445 , 1.967091963 , 1.96707061 , 1.967049384 , 1.967028285 , 1.967007311 , 1.966986461 , 1.966965734 , 1.966945129 , 1.966924645 , 1.966904281 , 1.966884036 , 1.966863909 , 1.966843898 , 1.966824003 , 1.966804223 , 1.966784557 , 1.966765003 , 1.966745561 , 1.96672623 , 1.966707009 , 1.966687896 , 1.966668892 , 1.966649995 , 1.966631204 , 1.966612519 , 1.966593938 , 1.96657546 , 1.966557085 , 1.966538813 , 1.966520641 , 1.966502569 , 1.966484596 , 1.966466722 , 1.966448946 , 1.966431267 , 1.966413684 , 1.966396196 , 1.966378803 , 1.966361504 , 1.966344297 , 1.966327183 , 1.966310161 , 1.966293229 , 1.966276388 , 1.966259636 , 1.966242972 , 1.966226397 , 1.966209908 , 1.966193507 , 1.966177191 , 1.966160961 , 1.966144815 , 1.966128753 , 1.966112774 , 1.966096878 , 1.966081064 , 1.966065331 , 1.966049679 , 1.966034107 , 1.966018615 , 1.966003201 , 1.965987866 , 1.965972608 , 1.965957428 , 1.965942324 , 1.965927296 , 1.965912343 , 1.965897465 , 1.965882662 , 1.965867932 , 1.965853275 , 1.965838691 , 1.965824178 , 1.965809738 , 1.965795368 , 1.965781069 , 1.96576684 , 1.96575268 , 1.965738589 , 1.965724567 , 1.965710612 , 1.965696725 , 1.965682905 , 1.965669151 , 1.965655464 , 1.965641842 , 1.965628284 , 1.965614792 , 1.965601364 , 1.965587999 , 1.965574698 , 1.965561459 , 1.965548282 , 1.965535168 , 1.965522115 , 1.965509123 , 1.965496192 , 1.96548332 , 1.965470509 , 1.965457757 , 1.965445064 , 1.965432429 , 1.965419852 , 1.965407333 , 1.965394872 , 1.965382467 , 1.965370119 , 1.965357827 , 1.965345591 , 1.96533341 , 1.965321285 , 1.965309213 , 1.965297197 , 1.965285234 , 1.965273324 , 1.965261468 , 1.965249665 , 1.965237914 , 1.965226215 , 1.965214568 , 1.965202973 , 1.965191428 , 1.965179935 , 1.965168491 , 1.965157098 , 1.965145755 , 1.965134461 , 1.965123216 , 1.96511202 , 1.965100873 , 1.965089774 , 1.965078722 , 1.965067718 , 1.965056762 , 1.965045852 , 1.965034989 , 1.965024172 , 1.965013401 , 1.965002676 , 1.964991997 , 1.964981363 , 1.964970773 , 1.964960229 , 1.964949728 , 1.964939272 , 1.964928859 , 1.96491849 , 1.964908164 , 1.964897881 , 1.964887641 , 1.964877443 , 1.964867287 , 1.964857173 , 1.964847101 , 1.96483707 , 1.96482708 , 1.964817132 , 1.964807223 , 1.964797356 , 1.964787528 , 1.96477774 , 1.964767992 , 1.964758283 , 1.964748614 , 1.964738983 , 1.964729391 , 1.964719837 , 1.964710322 , 1.964700845 , 1.964691405 , 1.964682003 , 1.964672639 , 1.964663311 , 1.964654021 , 1.964644767 , 1.964635549 , 1.964626368 , 1.964617222 , 1.964608113 , 1.964599039 , 1.96459 , 1.964580997 , 1.964572029 , 1.964563095 , 1.964554196 , 1.964545331 , 1.964536501 , 1.964527705 , 1.964518942 , 1.964510213 , 1.964501517 , 1.964492854 , 1.964484225 , 1.964475628 , 1.964467064 , 1.964458533 , 1.964450033 , 1.964441566 , 1.964433131 , 1.964424727 , 1.964416355 , 1.964408014 , 1.964399705 , 1.964391426 , 1.964383179 , 1.964374962 , 1.964366775 , 1.964358619 , 1.964350493 , 1.964342397 , 1.964334331 , 1.964326294 , 1.964318287 , 1.964310309 , 1.964302361 , 1.964294442 , 1.964286551 , 1.964278689 , 1.964270856 , 1.964263051 , 1.964255274 , 1.964247525 , 1.964239805 , 1.964232112 , 1.964224446 , 1.964216809 , 1.964209198 , 1.964201615 , 1.964194059 , 1.964186529 , 1.964179027 , 1.964171551 , 1.964164101 , 1.964156678 , 1.964149281 , 1.96414191 , 1.964134565 , 1.964127246 , 1.964119952 , 1.964112684 , 1.964105441 , 1.964098224 , 1.964091032 , 1.964083864 , 1.964076722 , 1.964069604 , 1.964062511 , 1.964055442 , 1.964048398 , 1.964041377 , 1.964034381 , 1.964027409 , 1.964020461 , 1.964013537 , 1.964006636 , 1.963999758 , 1.963992904 , 1.963986073 , 1.963979265 , 1.963972481 , 1.963965719 , 1.96395898 , 1.963952263 , 1.963945569 , 1.963938898 , 1.963932249 , 1.963925622 , 1.963919017 , 1.963912434 , 1.963905873 , 1.963899334 , 1.963892817 , 1.963886321 , 1.963879846 , 1.963873393 , 1.963866961 , 1.96386055 , 1.963854161 , 1.963847792 , 1.963841444 , 1.963835116 , 1.96382881 , 1.963822523 , 1.963816258 , 1.963810012 , 1.963803787 , 1.963797582 , 1.963791397 , 1.963785232 , 1.963779086 , 1.963772961 , 1.963766855 , 1.963760768 , 1.963754701 , 1.963748654 , 1.963742625 , 1.963736616 , 1.963730626 , 1.963724655 , 1.963718703 , 1.963712769 , 1.963706855 , 1.963700959 , 1.963695081 , 1.963689222 , 1.963683381 , 1.963677559 , 1.963671755 , 1.963665969 , 1.963660201 , 1.963654451 , 1.963648718 , 1.963643004 , 1.963637307 , 1.963631628 , 1.963625967 , 1.963620322 , 1.963614696 , 1.963609086 , 1.963603494 , 1.963597919 , 1.963592361 , 1.96358682 , 1.963581295 , 1.963575788 , 1.963570297 , 1.963564823 , 1.963559366 , 1.963553925 , 1.963548501 , 1.963543093 , 1.963537701 , 1.963532325 , 1.963526966 , 1.963521623 , 1.963516295 , 1.963510984 , 1.963505688 , 1.963500409 , 1.963495145 , 1.963489896 , 1.963484664 , 1.963479446 , 1.963474244 , 1.963469058 , 1.963463887 , 1.963458731 , 1.96345359 , 1.963448464 , 1.963443354 , 1.963438258 , 1.963433177 , 1.963428112 , 1.96342306 , 1.963418024 , 1.963413002 , 1.963407995 , 1.963403002 , 1.963398024 , 1.96339306 , 1.963388111 , 1.963383175 , 1.963378254 , 1.963373348 , 1.963368455 , 1.963363576 , 1.963358711 , 1.96335386 , 1.963349023 , 1.9633442 , 1.96333939 , 1.963334594 , 1.963329812 , 1.963325043 , 1.963320288 , 1.963315546 , 1.963310818 , 1.963306103 , 1.963301401 , 1.963296712 , 1.963292037 , 1.963287374 , 1.963282725 , 1.963278089 , 1.963273465 , 1.963268855 , 1.963264257 , 1.963259672 , 1.9632551 , 1.963250541 , 1.963245994 , 1.963241459 , 1.963236937 , 1.963232428 , 1.963227931 , 1.963223447 , 1.963218974 , 1.963214514 , 1.963210066 , 1.963205631 , 1.963201207 , 1.963196796 , 1.963192396 , 1.963188008 , 1.963183633 , 1.963179269 , 1.963174917 , 1.963170577 , 1.963166248 , 1.963161932 , 1.963157626 , 1.963153333 , 1.963149051 , 1.96314478 , 1.963140521 , 1.963136273 , 1.963132037 , 1.963127812 , 1.963123598 , 1.963119395 , 1.963115204 , 1.963111023 , 1.963106854 , 1.963102696 , 1.963098548 , 1.963094412 , 1.963090286 , 1.963086172 , 1.963082068 , 1.963077975 , 1.963073893 , 1.963069821 , 1.96306576 , 1.96306171 , 1.96305767 , 1.963053641 , 1.963049622 , 1.963045614 , 1.963041616 , 1.963037629 , 1.963033651 , 1.963029684 , 1.963025728 , 1.963021781 , 1.963017845 , 1.963013919 , 1.963010003 , 1.963006096 , 1.9630022 , 1.962998314 , 1.962994438 , 1.962990572 , 1.962986715 , 1.962982869 , 1.962979032 , 1.962975205 , 1.962971387 , 1.962967579 , 1.962963781 , 1.962959993 , 1.962956214 , 1.962952444 , 1.962948684 , 1.962944934 , 1.962941193 , 1.962937461 , 1.962933739 , 1.962930026 , 1.962926322 , 1.962922627 , 1.962918942 , 1.962915266 , 1.962911599 , 1.962907941 , 1.962904292 , 1.962900652 , 1.962897021 , 1.962893399 , 1.962889786 , 1.962886182 , 1.962882587 , 1.962879001 , 1.962875423 , 1.962871855 , 1.962868294 , 1.962864743 , 1.962861201 , 1.962857667 , 1.962854141 , 1.962850624 , 1.962847116 , 1.962843616 , 1.962840125 , 1.962836642 , 1.962833168 , 1.962829702 , 1.962826244 , 1.962822795 , 1.962819354 , 1.962815921 , 1.962812497 , 1.962809081 , 1.962805672 , 1.962802273 , 1.962798881 , 1.962795497 , 1.962792121 , 1.962788754 , 1.962785394 , 1.962782043 , 1.962778699 , 1.962775363 , 1.962772035 , 1.962768716 , 1.962765403 , 1.962762099 , 1.962758803 , 1.962755514 , 1.962752233 , 1.96274896 , 1.962745694 , 1.962742436 , 1.962739186 , 1.962735943 , 1.962732708 , 1.96272948 , 1.96272626 , 1.962723047 , 1.962719842 , 1.962716644 , 1.962713454 , 1.962710271 , 1.962707095 , 1.962703927 , 1.962700766 , 1.962697612 , 1.962694466 , 1.962691327 , 1.962688195 , 1.96268507 , 1.962681952 , 1.962678842 , 1.962675739 , 1.962672642 , 1.962669553 , 1.962666471 , 1.962663396 , 1.962660328 , 1.962657266 , 1.962654212 , 1.962651165 , 1.962648124 , 1.962645091 , 1.962642064 , 1.962639044 , 1.962636031 , 1.962633025 , 1.962630025 , 1.962627032 , 1.962624046 , 1.962621067 , 1.962618094 , 1.962615128 , 1.962612168 , 1.962609216 , 1.962606269 , 1.96260333 , 1.962600396 , 1.96259747 , 1.962594549 , 1.962591636 , 1.962588728 , 1.962585827 , 1.962582933 , 1.962580045 , 1.962577163 , 1.962574288 , 1.962571419 , 1.962568556 , 1.962565699 , 1.962562849 , 1.962560005 , 1.962557168 , 1.962554336 , 1.962551511 , 1.962548691 , 1.962545878 , 1.962543071 , 1.96254027 , 1.962537476 , 1.962534687 , 1.962531904 , 1.962529127 , 1.962526357 , 1.962523592 , 1.962520833 , 1.96251808 , 1.962515333 , 1.962512592 , 1.962509857 , 1.962507128 , 1.962504405 , 1.962501687 , 1.962498975 , 1.962496269 , 1.962493569 , 1.962490875 , 1.962488186 , 1.962485503 , 1.962482826 , 1.962480154 , 1.962477488 , 1.962474828 , 1.962472173 , 1.962469524 , 1.96246688 , 1.962464243 , 1.96246161 , 1.962458983 , 1.962456362 , 1.962453746 , 1.962451136 , 1.962448531 , 1.962445932 , 1.962443338 , 1.962440749 , 1.962438166 , 1.962435588 , 1.962433016 , 1.962430449 , 1.962427887 , 1.96242533 , 1.962422779 , 1.962420234 , 1.962417693 , 1.962415158 , 1.962412628 , 1.962410103 , 1.962407583 , 1.962405069 , 1.962402559 , 1.962400055 , 1.962397556 , 1.962395062 , 1.962392573 , 1.96239009 , 1.962387611 , 1.962385137 , 1.962382669 , 1.962380205 , 1.962377747 , 1.962375294 , 1.962372845 , 1.962370401 , 1.962367963 , 1.962365529 , 1.962363101 , 1.962360677 , 1.962358258 , 1.962355844 , 1.962353435 , 1.96235103 , 1.962348631 , 1.962346236 , 1.962343846 , 1.962341461 , 1.962339081 ]; 
var popHistogram=[];
var population=[];
var sample=[];
var sampleHistogram=[];
var bssample=[];
var bsmeans=[];
var bsmeansHistogram=[];
var bsvars=[];
var lastX;
var popStats;
var sampStats;
function dumb(){}
function onmousedown(){
	lastX=mouseX;
}
function onmousemove(){ 
	var i;
	if (mouseDown){
		if (lastX<mouseX){
			for (i=lastX;i<=mouseX;i++)
				if ((i>=0)&&(i<width))
					popHistogram[i]=height-mouseY;
		}			
		else
			for (i=mouseX;i<=lastX;i++)
				if ((i>=0)&&(i<width))
					popHistogram[i]=height-mouseY;
		clear();
		paintHistogram(popHistogram);
		lastX=mouseX;
	}
}
function createHistogram(p,h){
	var n=p.length;
	var i,m;
	
	for (i=0;i<width;i++)
		h[i]=0;
	for (i=0;i<n;i++)
		h[floor(p[i])]++;
	m=0;
	for (i=0;i<width;i++)
		if (h[i]>m) m=h[i];
	for (i=0;i<width;i++)
		h[i]=0.9*(height*(h[i]/m));
}
function paintHistogram(H){
	//assumes that H.length=width
	var x;

	for (x=0;x<width;x++)
		line(x,height,x,height-H[x]);
}
function setupArrays(){
	var i;
	for (i=0;i<width;i++){
		popHistogram[i]=0;
	}
}
function getSampleWithReplacement(p,s,n){
	var i;
	for (i=0;i<n;i++)
		s.push(p.random());
}
function getSampleWithoutReplacement(p,s,n){
	var a=[];
	var i;
	a.push(floor(random()*p.length));
	while (a.length<n){
		i=floor(random()*p.length);
		while (a.includes(i))
			i=floor(random()*p.length);
		a.push(i);	
	}	
	for (i=0;i<n;i++)
		s.push(p[a[i]]);
}
function generateSample(){
	var n=eval(samplesizeinput.value);
	sample=[];
	getSampleWithoutReplacement(population, sample, n);
	sample.sort((a, b) => a - b);
	
	sampStats=sumStat(sample);
	SAMPLESIZE.innerHTML=n;
	SAMPLEMINIMUM.innerHTML=sampStats.min.toFixed(4);
	SAMPLEQ1.innerHTML=sampStats.q1.toFixed(4);
	SAMPLEQ2.innerHTML=sampStats.q2.toFixed(4);
	SAMPLEQ3.innerHTML=sampStats.q3.toFixed(4);
	SAMPLEMAXIMUM.innerHTML=sampStats.max.toFixed(4);
	SAMPLEMEAN.innerHTML=sampStats.mean.toFixed(4);
	SAMPLEVARIANCE.innerHTML=sampStats.variance.toFixed(4);

if (n<=1000)	
	tInterval={l: sampStats.mean-invT[n]*sqrt(sampStats.variance/n), r: sampStats.mean+invT[n]*sqrt(sampStats.variance/n)};
else
	tInterval={l: sampStats.mean-invZ*sqrt(sampStats.variance/n), r: sampStats.mean+invZ*sqrt(sampStats.variance/n)};
zInterval={l: sampStats.mean-invZ*sqrt(sampStats.variance/n), r: sampStats.mean+invZ*sqrt(sampStats.variance/n)};
out.innerHTML='t interval: '+tInterval.l.toFixed(4)+' to '+tInterval.r.toFixed(4);
out.innerHTML+='<br>z interval: '+zInterval.l.toFixed(4)+' to '+zInterval.r.toFixed(4);

sampleHistogram=[];
bsmeansHistogram=[];
bsmeans=[];
bsvars=[];
createHistogram(sample,sampleHistogram);
showEverything();
}
function generatePopulation(){
population=[];
	var i,j;
	while (population.length<1000000)
		for (i=0;i<popHistogram.length;i++)
			for (j=0;j<popHistogram[i];j++)
				population.push((i+random())/1);
	population.sort((a, b) => a - b);	
	popStats=sumStat(population,true);
	POPULATIONSIZE.innerHTML=population.length;
	POPULATIONMINIMUM.innerHTML=popStats.min.toFixed(4);
	POPULATIONQ1.innerHTML=popStats.q1.toFixed(4);
	POPULATIONQ2.innerHTML=popStats.q2.toFixed(4);
	POPULATIONQ3.innerHTML=popStats.q3.toFixed(4);
	POPULATIONMAXIMUM.innerHTML=popStats.max.toFixed(4);
	POPULATIONMEAN.innerHTML=popStats.mean.toFixed(4);
	POPULATIONVARIANCE.innerHTML=popStats.variance.toFixed(4);
onmousemove=dumb;
designinstructions.style.display='none';
designbuttons.style.display='none';
samplestuff.style.display='block';
showEverything();
}
function dothesamplething(){
	generateSample();
	bootstrap();
}
function quantile(H,q){
	var m=floor(H.length*q);
	return((H[m]+H[m+1])/2)
}
function mean(H){
	var N=H.length;
	var r=0;
	var i;
	for (i=0;i<N;i++)
		r+=H[i];
	return(r/N);
}
function arrayMax(H){
	var r=H[0];
	var N=H.length;
	for (i=0;i<N;i++)
		if (H[i]>r) r=H[i];
	return (r);
}
function arrayMin(H){
	var r=H[0];
	var N=H.length;
	for (i=0;i<N;i++)
		if (H[i]<r) r=H[i];
	return (r);
}
function variance(H,m,pop){
	var n=H.length;
	var r=0;
	var dx;
	for (i=0;i<n;i++){
		dx=H[i]-m;
		r+=dx*dx;
	}
	if (!pop) n--;
	return(r/n);
}
function sumStat(H,pop){
	var Q1=quantile(H,0.25);
	var Q2=quantile(H,0.5);
	var Q3=quantile(H,0.75);
	var m=mean(H);
	var maximum=arrayMax(H);
	var minimum=arrayMin(H);
	var v=variance(H,m,pop);
	return({min: minimum, q1: Q1, q2: Q2, q3: Q3, max: maximum, mean: m, variance: v});
}
function setup(){
	setupArrays();
	size(400,200);
}
function draw(){
}
function zerovalues(){
	var i;
	for (i=0;i<width;i++)
		popHistogram[i]=0;
		
	clear();
}
function makeuniform(){
	for (i=0;i<=width;i++)
		popHistogram[i]=floor(height/2);
	paintHistogram(popHistogram);	
}
function tryit(){
	popHistogram=[];
	createHistogram(population,popHistogram);
	paintHistogram(popHistogram);
}

var tInterval, zInterval, bsInterval;

function bootstrap(){
	var i;
	var k=eval(resamplenumberinput.value);
	var n=eval(samplesizeinput.value);
	var s=[];
	var h=[];
	var sumstats
	bsmeans=[];
	bsvars=[];
	for (i=0;i<k;i++){
		s=[];
		getSampleWithReplacement(sample, s, n);
		sumstats=sumStat(s);
		bsmeans.push(sumstats.mean);
		bsvars.push(sumstats.variance);
	}
	bsmeans.sort((a, b) => a - b);
	bsvars.sort((a, b) => a - b);

bsInterval={l: quantile(bsmeans,0.025), r: quantile(bsmeans,0.975)};
	out.innerHTML+='<br>bs interval: '+bsInterval.l.toFixed(4)+' to '+bsInterval.r.toFixed(4);
	

bsmeansHistogram=[];
createHistogram(bsmeans,bsmeansHistogram);

showEverything();
}
function showEverything(){
	clear();
	color('black');
	line(popStats.mean,0,popStats.mean,height);
	color(0,0,0,0.5);
	paintHistogram(popHistogram);
	if (sample.length!=0){
		color(0,255,0,0.5);
		paintHistogram(sampleHistogram);
		save();
		linewidth(5);
		color('green');
		line(zInterval.l,5,zInterval.r,5);
		color('blue');
		line(tInterval.l,15,tInterval.r,15);
		restore();
	}
	if (bsmeans.length!=0) {
		color(255,0,0,0.5);
		paintHistogram(bsmeansHistogram);
		save();
		linewidth(5);
		color('red');
		line(bsInterval.l,25,bsInterval.r,25);
		restore();
	}
}
</script>
</head>
<body>
<div id='content'>
<div class='title'> Comparing boot strap, T, and Z intervals for means </div>
<div class='instructions' id='designinstructions'>
Draw a histogram in the space below. The minimum value in the histogram is 0. The maximum value is 400. Once you have drawn a histogram, press the "Generate Population" button to generate a population of about 1,000,000 
individuals whose distribution will match your histogram. you will then have the opportunity to sample from this population to compare 95% confidence intervals using a Z distribution, a T distribution, and bootstrap resampling.
</div>
	<div id='spork'></div>
<div id='designbuttons'>
	<button onclick='zerovalues();'>Zero Histogram</button>
	<button onclick='generatePopulation()'>Generate Population</button><br>
</div>

<div id='samplestuff'>
<div class='instructions'>
The population histogram is shown in gray. When a sample has been selected, the sample histogram is shown in green. When resampling has been performed, the histogram of resample means is shown in red.
At the top of the graph, the Z-interval for mean is in green, the T-interval in blue, and the bootstrap interval in red. The actual population mean is marked with a black line.
</div>
	Sample Size: <input type='text' value='100' id='samplesizeinput'></input><br>
	Number of resamples: <input type='text' value='1000' id='resamplenumberinput'></input><br>
	<button onclick='generateSample()'>Generate Sample</button>
	<button onclick='bootstrap()'>Generate Resamples</button>

<div id='hiddenstuff'>
<table border=1>
<tr><td></td><th>Size</th><th>Minimum</th><th>Q1</th><th>Median</th><th>Q3</th><th>Maximum</th><th>Mean</th><th>Variance</th></tr>
<tr>
	<th>Population</th>
	<td><div class='stat' id='POPULATIONSIZE'></div></td>
	<td><div class='stat' id='POPULATIONMINIMUM'></div></td>
	<td><div class='stat' id='POPULATIONQ1'></div></td>
	<td><div class='stat' id='POPULATIONQ2'></div></td>
	<td><div class='stat' id='POPULATIONQ3'></div></td>
	<td><div class='stat' id='POPULATIONMAXIMUM'></div></td>
	<td><div class='stat' id='POPULATIONMEAN'></div></td>
	<td><div class='stat' id='POPULATIONVARIANCE'></div></td>
</tr>
<tr>
	<th>Sample</th>
	<td><div class='stat' id='SAMPLESIZE'></div></td>
	<td><div class='stat' id='SAMPLEMINIMUM'></div></td>
	<td><div class='stat' id='SAMPLEQ1'></div></td>
	<td><div class='stat' id='SAMPLEQ2'></div></td>
	<td><div class='stat' id='SAMPLEQ3'></div></td>
	<td><div class='stat' id='SAMPLEMAXIMUM'></div></td>
	<td><div class='stat' id='SAMPLEMEAN'></div></td>
	<td><div class='stat' id='SAMPLEVARIANCE'></div></td>
</tr></table>
<div id='out'></div>
</div>
</div>

</div>
</body>
</html>