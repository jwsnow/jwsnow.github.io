<!doctype html>
<html>
<head>
<style>
#settings{
	position: fixed;
	left: 50px;
	right:50px;
	top:50px;
	bottom:50px;
	background: white;
	border: 5px solid black;
	padding: 20px;
	display: none;
}
button.closer{
	position: absolute;
	top:5px;
	right:5px;
	background: transparent;
	border: 1px solid transparent;
	border-radius: 1px;
	outline: none;
	cursor: pointer;
	font-size:20px;	
}
button.gear{
	height:40px;
	width:40px;
	float: right;
	background: transparent;
	border: 1px solid transparent;
	border-radius: 1px;
	outline: none;
	cursor: pointer;
	font-size:20px;
}
body{
	margin: 0px;
}
div.intervalOptions{
	display: none;
}
div.pad{
	height: 50px;
	background: lightgray;
}
div.tabbar{
	position:fixed;
	top:0px;
	left:0px;
	right:0px;
	background: gray;
	border-bottom: 1px solid black;
	//padding:0px;
	height: 40px;
	line-height:40px;
	padding-left: 20px;
	z-index: 20;
}
div.pageMenu{
	background: lightgray;
	border-bottom: 1px solid black;
	//padding-top: 50px;
	padding-top: 10px;
	padding-left: 40px;
	padding-bottom: 10px;
}
div.subPage{
	padding-left:20px;
}
div.content{
		//padding-top: 50px;
}	
textarea.datalist{
	resize: none;
	wrap: off;
	  line-height: 25px;
	  background-image: linear-gradient(transparent, transparent 24px, #000000 0px);
	  background-size: 100% 25px;
  }
textarea.datalabel{
	resize: none;
	font-weight: bold;
	scroll: none;
	overflow: hidden;
	width: 12ch;
}
div.pageDiv{
	display: none;
}
div.expandable{
	display: none;
}	
table.summaryTable td{
	width: 10ch;
}
button{
	color: black;
}
button.expander{
	cursor: pointer;
}
div.histoDiv{
	display: none;
}
table.summaryTable{
	margin-top: 10px;
	margin-bottom: 10px;
}
li button.expander{
	background: none;
	border: none;
	font-weight: bold;
	font-size: 1em;
}
button{
	margin-top: 2px;
	margin-bottom: 2px;
}
div.answerDiv{
	display: none;
}
</style>
<script>
var numLists=10;
var globalNumSamples=10000;
var list=[];
var listLabel=['List 0', 'List 1', 'List 2', 'List 3', 'List 4', 'List 5', 'List 6', 'List 7', 'List 8', 'List 9' ];
var listLabelTextArea, listTextArea;
var sumRow, sumList, sumN, sumMean, sumS, sumS2;
var sumMin, sumQ1, sumQ2, sumQ3, sumMax, sumSum, sumRange;
var listN=[], listM=[], listS=[], listS2=[], listMin=[], listQ1=[], listQ2=[], listQ3=[], listMax=[], listSum=[], listRange=[];

var theColors=[
'rgba(0,0,0)',
'rgba(255,0,0)',
'rgba(0,255,0)',
'rgba(0,0,255)',
'rgba(128,128,0)',
'rgba(255,0,255)',
'rgba(0,255,255)',
'rgba(255,128,0)',
'rgba(255,0,128)',
'rgba(128,255,0)',
'rgba(0,255,128)',
];

var allRadioNames=[];
var allLabelNames=[];
var allExpandables;
var printPrecision=6;
//Random stuff-------------------------------------------------------
var RNGMOD=Math.pow(2,32);
var RNGSEED=0;

function RNG(){
	RNGSEED=(RNGSEED*1664525 + 1013904223)%RNGMOD;
  	return(RNGSEED/RNGMOD);
}
//----------------------------------------------------------------------------
function cacheMath(){
	var aMathFunctions = Object.getOwnPropertyNames(Math);

	for (var i in aMathFunctions){
		window[aMathFunctions[i]] = Math[aMathFunctions[i]];
	}
	Number.prototype.TOFIXED=function(n){
		var z=Number('1e-'+(n+1));
		if (abs(this)<z)
			return(0);
		else {
			return(Number(Math.round(this*pow(10,n))/pow(10,n)));
			return(Number(Math.round(this+'e'+n)+'e-'+n));
		}	
	}	
//	random=RNG;
}	
function removeSpaces(){ 
	var i,j;
	
	for (i=0;i<numLists;i++)
		for (j=0;j<list[i].length;j++)
			if (list[i][j]==undefined){
				list[i].splice(j--,1);
			}	
}
function expand(t){ 

	var toToggle=[], toClose=[];
	processLists();
	removeSpaces();
	printLists();
	if (t.hasAttribute('data-open'))
		toToggle=t.getAttribute('data-open').split(',');
	if (t.hasAttribute('data-close')) 
		toClose=t.getAttribute('data-close').split(',');
	var i,n,j,k,s;
	
	if (toToggle.length>0){
		n=document.getElementById(toToggle[0]);
		if (n.style.display != 'block'){
			for (i=0;i<toToggle.length;i++)
				document.getElementById(toToggle[i]).style.display='block';
		}
		else{
			for (i=0;i<toToggle.length;i++)
				document.getElementById(toToggle[i]).style.display='none';		
		}
	}
	var graphDivs=['histoDiv','boxDiv','scatterDiv','quantileDiv','insideHistoDiv'];
	var checksToClear=['histocheckbox','boxcheckbox','scatterxradio','scatteryradio','quantileradio'];
	if (toClose.length>0){ 
		for (i=0;i<toClose.length;i++){
			document.getElementById(toClose[i]).style.display='none';
			if (graphDivs.includes(toClose[i])){
				for (j=0;j<checksToClear.length;j++){
					s=document.getElementsByClassName(checksToClear[j]);
					for (k=0;k<s.length;k++)
						s[k].checked=false;
				}
			}
		}	
	}
}

function setupExpanders(){
	var e=document.getElementsByClassName('expander');
	var i;
	for (i =0; i<e.length; i++){
		e[i].onclick=function(){expand(this);}
	}
}
function setupAll(){
	cacheMath();
	setupExpanders();
	allExpandables=document.getElementsByClassName('expandable');
	listTextArea=document.getElementsByClassName('datalist');
	listLabelTextArea=document.getElementsByClassName('datalabel');

	for (let i=0;i<numLists;i++){
		listTextArea[i].onkeyup=function(e){handleEnter(e);};
		listLabel[i]='List '+i;
	}	
	processLists();
}

function printRadioList(x){
		for (let i=0;i<numLists;i++)
			document.write("<label><input type='radio' name='"+x+"radio' class='"+x+"radio'><span class='"+x+"label'>"+listLabel[i]+"</span></label>&nbsp;");	
		allRadioNames.push(x+'radio');
		allLabelNames.push(x+'label');
}
function getChecked(x, mustbenonempty){
	var a=document.getElementsByClassName(x+'radio');
	var r=-1;
	if (mustbenonempty){
		for (i=0;i<a.length;i++)
			if (listN[i]<=0) a.checked=false;
	}
	for (i=0;i<a.length;i++)
		if (a[i].checked)
			r=i;
	return(r);		
}
function getChecked(x){
	var a=document.getElementsByClassName(x+'radio');
	var r=-1;

	for (i=0;i<a.length;i++)
		if (a[i].checked)
			r=i;
	return(r);		
}
function closeAll(){
	var i;
	for (i=0;i<allExpandables.length;i++)
		allExpandables[i].style.display='none';
}
function openDiv(t){
	t.style.display='block';
}
function purge(x){
	x.style.display='none';
}
function showListLabels(){
	var i,j,x;
	for (i=0;i<numLists;i++){
		if (!listLabel[i])
			listLabel[i]='List '+i;
			listLabelTextArea[i].value=listLabel[i];
		}
	for (j=0;j<allLabelNames.length;j++){
		x=document.getElementsByClassName(allLabelNames[j]);
		for (i=0;i<numLists;i++)
			x[i].innerHTML=listLabel[i];
	}
}
var numbersOnly=[];
globalSeparationCharacter=',';
function getLists(){ 
	var i,j,x,y,k,l;
	var m;
	for (i=0;i<numLists;i++){
		listLabel[i]=listLabelTextArea[i].value;
		if (globalSeparationCharacter==',')
			list[i]=listTextArea[i].value.replace(/,/g, '\n').split('\n'); 
		else
			list[i]=listTextArea[i].value.replace(/;/g, '\n').split('\n'); 
	}
	for (i=0;i<numLists;i++){
		numbersOnly[i]=true;
		for (j=0;j<list[i].length;j++){ 
			try{
				x=list[i][j];
				if (x.charAt(0)=='='){ 
					x=x.slice(1); 
					y=x;
					m=Infinity;
					for (l=0;l<numLists;l++)
						if (x.search('L'+l)!=-1)
							m=min(m,list[l].length); 
					if (m<Infinity){
						for (k=0;k<m;k++){
							for (l=0;l<numLists;l++)
								if (x.search('L'+l)!=-1)
									x=x.replace(RegExp('L'+l, 'g'),list[l][k]);
							list[i][k]=eval(x);
							x=y;
						}
					}
					j=Infinity;
				}	
				else{
					try{y=(eval(x));} catch{y=x;}
					if (x=='')
						list[i][j]=eval(x);
//					else if (!isNaN(y))
					else if ((typeof y == 'number')){
						list[i][j]=y;
					}	
					else{
	//					list[i][j]=x;
						list[i][j]='';
						numbersOnly[i]=false;
					}
				}
			}
			catch{
				console.log('error processing: '+list[i][j]);
			}
		}	
	}
}

function printLists(){ 
	var i;
	for (i=0;i<numLists;i++){
		listLabelTextArea[i].value=listLabel[i];
		listTextArea[i].value=list[i].join('\n');
	}
}
function handleEnter(e){
	if (e.key=='Enter')
		processLists();
}
function processLists(e){ 
		getLists(); 
		printLists();
		showListLabels();
		summarize();
		showSummaryStats();
}
function trimNulls(a){
	while ((a.length>0) && ((a[a.length-1]==undefined)))
		a.pop();
}
function sumArray(a){
	var i;
	var r=0;
	for (i=0;i<a.length;i++)
		r+=a[i];
	return(r);
}
function percentileSorted(a,p){
	
	var i=p*a.length-1;
	var r;
	if (i==floor(i)){
		if (i==a.length-1)
			r=a[i];
		else
			r=(a[i]+a[i+1])/2;
	}
	else{
		r=a[ceil(i)];
	}
	return(r);
}
function percentile(a,p){
	var b=a.toSorted(function(a, b){return a - b});
	return(percentileSorted(b, p));
}
function squareArray(a){
	var b=[];
	var i;
	for (i=0;i<a.length;i++)
		b[i]=a[i]*a[i];
	return(b);	
}
function summarizeArray(a){
	var r={n:0, m:0, s:0, s2:0, min:0, q1:0, q2:0, q3:0, max:0, sum:0, range:0};
	var sortedArray
	var squaredArray
	var sumOfSquares;
	trimNulls(a);
	r.n=a.length;
	if (r.n == 0)
		return(r);
	else if (r.n==1){
		r.m=a[0]; r.min=a[0]; r.q1=a[0]; r.q2=a[0]; r.q3=a[0]; r.max=a[0]; r.sum=a[0];
	}
	else{
		sortedArray=a.toSorted(function(a, b){return a - b});
		r.sum=sumArray(a);
		r.m=r.sum/r.n;
		r.min=sortedArray[0];
		r.max=sortedArray[a.length-1];
		r.range=r.max-r.min;
		r.q1=percentileSorted(sortedArray, 0.25);
		r.q2=percentileSorted(sortedArray, 0.5);
		r.q3=percentileSorted(sortedArray, 0.75);
		squaredArray=squareArray(a);
		sumOfSquares=sumArray(squaredArray);
		r.s2=(r.n*sumOfSquares-r.sum*r.sum)/(r.n*(r.n-1));
		r.s=sqrt(r.s2);
	}
	return(r);
}
function summarize(){ 
	var i,x;
	var r;
	for (i=0;i<numLists;i++){
		r=summarizeArray(list[i]);
		for (x in r){
			if (r[x]==undefined)
				r[x]=NaN;
		}
		listN[i]	=r.n;
		listM[i] 	=r.m;
		listS[i] 	=r.s;
		listS2[i] 	=r.s2;
		listMin[i] 	=r.min;
		listQ1[i]	=r.q1;
		listQ2[i] 	=r.q2;
		listQ3[i] 	=r.q3;
		listMax[i] 	=r.max;
		listSum[i] 	=r.sum;
		listRange[i]=r.range;
	}
}
function showSummaryStats(){
	var i;
	
	for (i=0;i<numLists;i++){ 
		sumList[i].innerHTML=listLabel[i];
		sumN[i].innerHTML=listN[i];
		sumMean[i].innerHTML=listM[i].TOFIXED(printPrecision);
		sumS[i].innerHTML=listS[i].TOFIXED(printPrecision);
		sumS2[i].innerHTML=listS2[i].TOFIXED(printPrecision);
		sumMin[i].innerHTML=listMin[i].TOFIXED(printPrecision);
		sumQ1[i].innerHTML=listQ1[i].TOFIXED(printPrecision);
		sumQ2[i].innerHTML=listQ2[i].TOFIXED(printPrecision);
		sumQ3[i].innerHTML=listQ3[i].TOFIXED(printPrecision);
		sumMax[i].innerHTML=listMax[i].TOFIXED(printPrecision);
		sumSum[i].innerHTML=listSum[i].TOFIXED(printPrecision);
		sumRange[i].innerHTML=listRange[i].TOFIXED(printPrecision);
		
		if (listN[i]>0) sumRow[i].style.display='table-row';
		else sumRow[i].style.display='none';
	}
}
//new showSummaryStats modifies regularSummary div?
function showSummaryStats(){
	var i;
	var r='Your lists are all empty';
	var allEmpty=true;
	for (i=0;i<numLists;i++)
		if (listN[i]!=0) if (numbersOnly[i]==true) allEmpty=false;
	if (!allEmpty){
		r='<table class="summaryTable" border=1><tr><th>List</th><th>n</th><th>x&#772;</th><th>s</th><th>s<sup>2</sup></th><th>min</th><th>Q<sub>1</sub></th><th>Q<sub>2</sub></th><th>Q<sub>3</sub></th><th>max</th><th>sum</th><th>range</th></tr>';
		for (i=0;i<numLists;i++)
			if ((listN[i]>0) && (numbersOnly[i]==true)){
			r+='<tr>';
			r+='<td>'+listLabel[i]+'</td>';
			r+='<td>'+listN[i]+'</td>';
			r+='<td>'+listM[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listS[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listS2[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listMin[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listQ1[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listQ2[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listQ3[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listMax[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listSum[i].TOFIXED(printPrecision)+'</td>';
			r+='<td>'+listRange[i].TOFIXED(printPrecision)+'</td>';	
			r+='</tr>';
			}
		r+='</table>';
	}
	regularSummary.innerHTML=r;
}
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//stat library 
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++

var epsilon=.000000001;
//*DISTRIBUTIONS STUFF *********************************

// Discrete distributions *************************************************************
function factorial(n){
	if ((n==0) || (n==1))
		return(1);
	else
		return(n*factorial(n-1));
	}
function perm(n,k){
	return(factorial(n)/factorial(n-k));
	}
function combo(n,k){
	return(factorial(n)/(factorial(k)*factorial(n-k)));
	}
function binompdf(n,p,x){
//	return(Math.pow(p,x)*Math.pow(1-p,n-x)*factorial(n)/(factorial(n-x)*factorial(x)));
	var a, q, i, m, s, z1, z2;

	if (n<=1000){
		q=1-p;
		a=1;
		m=n;
		for (i=1;i<=x;i++){
			a=a*p*m/i;
			m=m-1;
			}
		for (i=1;i<=n-x;i++)
			a=a*q;
		}
	else{
		m=n*p;
		s=Math.sqrt(n*p*(1-p));
		z1=((x-0.5)-m)/s;
		z2=((x+0.5)-m)/s;
		a=normalcdf(z1, z2);
		}
	return(a);
	}
function binomcdf(n,p,x){ 
	var sum, k, m, s, z;

	if (n<=1000){
		sum=0;
		for (k=0;k<=x;k++)
			sum+=binompdf(n,p,k);
		}
	else{
		m=n*p;
		s=Math.sqrt(n*p*(1-p));
		z=(x+0.5-m)/s;
		sum=normalcdf(z);
		}
	return(sum);
	}
function logFac(x){
	var r=0;
	var i;
	for (i=1;i<=x;i++)
		r+=Math.log(i);
	return(r);
	}
function poissonpdf(m,x){
//	return(Math.pow(m,x)*Math.exp(-m)/factorial(x));
	return(Math.exp(x*Math.log(m)-m-logFac(x)));
	}
function poissoncdf(m,x){
	var sum, k;

	sum=0;
	for (k=0;k<=x;k++)
		sum+=poissonpdf(m,k);
	return(sum);
	}

//*************************************************************************************

// Normal Distribution *******************************************
function normalpdf(x){
	return(Math.exp(-0.5*x*x)/Math.sqrt(2*Math.PI));
	}
function normalcdf(x,y,mean,stdev){

	if (( mean!=undefined) && (stdev != undefined)){
		return(normalcdf((x-mean)/stdev, (y-mean)/stdev));
		}
	else{
		if (y==undefined){
			var X;
			if (x<-9) X=-9;
			else if (x>9) X=9;
			else X=x;
			var s=X;
			var t=0;
			var b=X;
			var q=X*X;
			var i=1;
			while(s!=t)
				s=(t=s)+(b*=q/(i+=2));
			return (.5+s*Math.exp(-.5*q-.91893853320467274178));
			}
		else{
			return(normalcdf(y)-normalcdf(x));
			}
		}
	}
var bisectFunction;
function bisect(left, leftvalue, right,rightvalue){
	var middle;
	middle = ((left+right)/2);
	middlevalue=bisectFunction(middle);
	if ((Math.abs(middlevalue) < epsilon) || ((right-left)<epsilon))
		return (middle);
	else{
		if (leftvalue*middlevalue <= 0)
			return(bisect(left,leftvalue, middle,middlevalue));
		else
			return(bisect(middle,middlevalue, right,rightvalue));
		}
	}
function invnorm(x, mean, stdev){
	var thefun;
	var r;
	thefun='normalcdf(x)-'+x;
	eval('bisectFunction=function(x){return('+thefun+')}');			
	r=(bisect(-9,0-x,9,1-x));
	if ((mean != undefined) && (stdev != undefined))
		r=mean+stdev*r;
	return(r);
	}
//****************************************************************

function fequal(f, g, l, h, n){
	var fDiffEpsilon=0.01;
	var fFunction = function(x){
		var value
		with (Math){
			value=eval(f);
			}
		return value;
		}
	var gFunction = function(x){
		var value
		with (Math){
			value=eval(g);
			}
		return value;
		}

	var dx, sum, x, diff;
	if ((n==undefined)||(n<=0))
		n=100;
	dx=(h-l)/n;

	sum=0;
	for (x=l;x<=h;x+=dx){
		diff=(fFunction(x)) - (gFunction(x));
		sum+=diff*diff;
		}
	if (sum<fDiffEpsilon)
		return(1);
	else
		return(0);
	}

// supporting functions ******************************************
function integrate(thefun, a, b){ 
	var dx,X,sum,n,k;

	var integralFunction =
		function(x){
			var value;
			with(Math){
				value = eval(thefun);
				}
			return(value);
			};

	n=10000;
	dx=(b-a)/n;
	sum=0;
	for (k=1;k<n;k++){
		X=a+k*dx;
		sum += 2*integralFunction(X);
		}
	sum += integralFunction(a)+integralFunction(b);
	return (sum*(b-a)/(2*n));
	}
var P = new Array(7);
P[0] = 1.000000000190015
P[1] = 76.18009172947146
P[2] = -86.50532032941677
P[3] = 24.01409824083091
P[4] =  -1.231739572450155
P[5] = 0.001208650973866179
P[6] = -0.000005395239384953
function gamma(z){
	var sum;
	var i;
	if (z==0)
		return(1);
	else if (z==0.5)
		return(1.7724538509055931);
	else if (z==1)
		return(1);
	else{
		sum=P[0];
		for (i=1;i<7;i++)
			sum+=P[i]/(z+i);
		return((Math.sqrt(2*Math.PI)*sum/z)*Math.pow(z+5.5,z+0.5)*Math.exp(-(z+5.5)));
		}
	}
function logGamma(z){
	if (z<2)
		return(Math.log(gamma(z)));
	else
		return(Math.log(z-1) + logGamma(z-1));
	}

function logBeta(x,y){
	return(logGamma(x)+logGamma(y)-logGamma(x+y));
	}
function beta(x,y){
	return(Math.exp(logBeta(x,y)));
//	return(gamma(x)*gamma(y)/gamma(x+y));
	}
function RIB(x,a,b){
	var c,sum,n,term,logterm,logx;

	c=Math.pow(x,a)*Math.pow(1-x,b)/(a*beta(a,b));
	sum=0;
	term=1;
	n=0;
	logx=Math.log(x);
	while (term>epsilon){
		sum+=term;
//		term=Math.pow(x,n+1)*beta(a+1,n+1)/beta(a+b,n+1);
		logterm=(n+1)*logx+logBeta(a+1,n+1)-logBeta(a+b,n+1);
		term=Math.exp(logterm);
		n++;
		}	
	return(c*(sum+term));
	}
function LIG(s,z){
	if (s>1){
		return((s-1)*LIG(s-1,z)-Math.pow(z,s-1)*Math.exp(-z));
		}
	else{
		var k;
		var sum;
		var term;
		var n;
		var bob;

		sum=0;
		term=1;
		k=0;
		while (term > epsilon){
			sum+=term;
			k++;
			term=term*z/(s+k);
			}
		return((sum+term)*Math.pow(z,s)/(s*Math.exp(z)));
		}
	}
//****************************************************************

// t Distribution ************************************************
function logtpdf(x,df){
	return(logGamma((df+1)/2)-0.5*Math.log(df*Math.PI)-logGamma(df/2)-((df+1)/2)*Math.log(1+x*x/df));
	}
function tpdf(x,df){
	return(Math.exp(logtpdf(x,df)));
	}
function tIntegral(n, t){
//Calculates int(1/((1+x^2)^n), x, 0, t) recursively
	if (n==1)
		return(Math.atan(t));
	else if (n==0.5)
		return(Math.log(Math.sqrt(1+t*t)+t));
	else
		return(tIntegral(n-1,t)*(2*n-3)/(2*(n-1)) + t/(2*(n-1)*Math.pow(1+t*t, n-1)));
	}
function tPDFco(df){
//calculates coefficient for t pdf fcn
	return(Math.exp(logGamma((df+1)/2)-0.5*Math.log(df*Math.PI)-logGamma(df/2)));
	}
function tcdf(t,a,b){ 
	var df, Q;
	if (b==undefined){
		df=a;
		if (floor(df)!=df) return tcdfintegral(t, a, b);
		else{
			Q=tPDFco(df)*Math.sqrt(df)*tIntegral((df+1)/2, Math.abs(t)/Math.sqrt(df));
			if (t>=0)
				return(0.5+Q);
			else
				return(0.5-Q);
			}
		}
	else
		return(tcdf(a,b)-tcdf(t,b));
	}
function oldtcdf(t,a,b){
	if (b==undefined){
		df=a;
		var x = (t+Math.sqrt(t*t+df))/(2*Math.sqrt(t*t+df));
		var df2 = df/2;
		return(RIB(x, df2,df2));
		}
	else
		return(tcdf(a,b)-tcdf(t,b));
	}
function tcdfintegral(t, a, b){
	var df,Q;
	if (b==undefined){
		df=a;
		Q = integrate('tpdf(x,'+df+')',0, abs(t));
		if (t>=0)
			return(0.5+Q);
		else
			return(0.5-Q);
	}
	else
		return(tcdf(a,b)-tcdf(t,b));
}
function invt(x,df){
	var thefun='tcdf(x,'+df+')-'+x;
	eval('bisectFunction=function(x){return('+thefun+')}');	
	return(bisect(-100,tcdf(-100,df)-x,100,tcdf(100,df)-x));
	}

//****************************************************************


// chi2 distribution *********************************************
function chi2pdf(x, df){
	if ((x==0) && (df==2))
		return(0.5);
	else if (df<=1){
		var bottom = Math.sqrt(2)*gamma(0.5);
		return(1/(bottom*Math.sqrt(x*Math.exp(x))));
		}
	else{
		return((Math.pow(x,df/2-1)*Math.exp(-x/2))/(Math.pow(2,df/2)*gamma(df/2))); //should we modify for really big df?
		}	
	}
function chi2pdf(x, df){
	if ((x==0) && (df==2))
		return(0.5);
	else if (df<=1){
		var bottom = Math.sqrt(2)*gamma(0.5);
		return(1/(bottom*Math.sqrt(x*Math.exp(x))));
		}
	else{
		var logchi=(df/2-1)*Math.log(x)+(-x/2)-(df/2)*Math.log(2)-logGamma(df/2);
		return(Math.exp(logchi));
		//return((Math.pow(x,df/2-1)*Math.exp(-x/2))/(Math.pow(2,df/2)*gamma(df/2))); //should we modify for really big df?
		}	
	}	
var chi2cutoffs=[0,26,15,11,9,8,7,7,6,6,5];	
function chi2cdf(x, df){
	var DF=floor(min(df, 10));
	if ((df>=1) && (x>=chi2cutoffs[DF]*df))
		return(1);
	else if (df<=1){
		return(LIG(df/2.0, x/2.0)/gamma(df/2));
		}
	else
		return(integrate('chi2pdf(x, '+df+')',0,x ));
	}
function invchi2(x,df){
	var thefun='chi2cdf(x,'+df+')-'+x;
	eval('bisectFunction=function(x){return('+thefun+')}');		
	return(bisect(0,chi2cdf(0,df)-x,100,chi2cdf(100,df)-x));
	}	
//****************************************************************

// F distribution ************************************************
function fcdf(x, d1, d2){
	var z;
	z= d1*x /(d1*x + d2);	
	return(RIB(z, d1/2, d2/2));
	}
//****************************************************************

//++++++++++++++++++++++++++++++++++++++++++++++++++++++++
//END stat library 
//++++++++++++++++++++++++++++++++++++++++++++++++++++++++



</script>
<body>
<div class='tabbar'>
<button class='expander' data-open='dataListDiv' data-close='generatedDiv,summaryDiv,chartDiv,distributionDiv,intervalsDiv,testsDiv,insideHistoDiv,boxplotCanvasDiv,scatterPlotDiv,quantilePlotDiv,ranVarInnerDiv'>Data</button>
<button class='expander' data-open='summaryDiv'  data-close='chartDiv,dataListDiv,distributionDiv,intervalsDiv,testsDiv'>Summary</button>
<button class='expander' data-open='chartDiv'  data-close='summaryDiv,dataListDiv,distributionDiv,intervalsDiv,testsDiv'>Plots</button>
<button class='expander' data-open='distributionDiv'  data-close='dataListDiv,generatedDiv,summaryDiv,chartDiv,intervalsDiv,testsDiv'>Calculators</button>
<button class='expander' data-open='intervalsDiv'  data-close='dataListDiv,generatedDiv,summaryDiv,chartDiv,distributionDiv,testsDiv'>Intervals</button>
<button class='expander' data-open='testsDiv'  data-close='dataListDiv,generatedDiv,summaryDiv,chartDiv,distributionDiv,intervalsDiv'>Tests</button>
<button class='gear' onclick='showSettings();'>&#9881;</button>
</div>
<div class='content'><div class='pad'></div>


<!---- Data Lists ---------------------------------------------->
<div id='dataListDiv' class='pageDiv expandable'>
<div class='pageMenu'>
<button class='expander' data-open='generatedDiv' data-close='cannedDiv,normalGenDiv,uniformGenDiv,binomialGenDiv,sampleGenDiv,genIntegerDiv'>Generate Data</button>
<button class='expander' data-open='cannedDiv' data-close='generatedDiv,normalGenDiv,uniformGenDiv,binomialGenDiv,sampleGenDiv,genIntegerDiv'>Canned Data</button>
</div>

<!--generated data ---------------------------------------------->
<div id='generatedDiv' class='pageDiv expandable'>
<div class='pageMenu' id='generateMenu'>
	<button class='expander' data-open='uniformGenDiv,genIntegerDiv' data-close='normalGenDiv,binomialGenDiv,sampleGenDiv,resampleGenDiv'>Uniform</button>
	<button class='expander' data-open='normalGenDiv,genIntegerDiv' data-close='uniformGenDiv,binomialGenDiv,sampleGenDiv,resampleGenDiv'>Normal</button>
	<button class='expander' data-open='binomialGenDiv' data-close='normalGenDiv,uniformGenDiv,sampleGenDiv,resampleGenDiv,genIntegerDiv'>Binomial</button>
	<button class='expander' data-open='sampleGenDiv' data-close='normalGenDiv,uniformGenDiv,binomialGenDiv,resampleGenDiv,genIntegerDiv'>Sample</button>
	<button class='expander' data-open='resampleGenDiv' data-close='normalGenDiv,uniformGenDiv,binomialGenDiv,sampleGenDiv,genIntegerDiv'>Sample Means</button>
</div>
<div class='subPage'>
	
<div id='genIntegerDiv'>
		Integer? <label><input type="radio" name='geninteger' id="genintegeryes">yes</label>&nbsp; <label><input type="radio" name='geninteger' checked=true>no</label>
</div>
		
<ul>
<!---------------------------------------------------------------------------------------------------------------------------->
	<div id='uniformGenDiv' class='expandable generator'>
	Output List:<br>
	<script>printRadioList('ugenoutput');
	var a=document.getElementsByClassName('ugenoutput'+'radio');
	a[0].checked=true;
	</script>
	
		<table>
		<tr><td>Minimum:</td><td> <input type="text" id="uniformminimum" value='0'></td></tr>
		<tr><td>Maximum:</td><td> <input type="text" id="uniformmaximum" value='100'></td></tr>
		<tr><td>Size:</td><td> <input type="text" id="uniformn" value='100'></td></tr>
		</table>
		<button onclick="generateUniformDataSet();">Generate Data Set</button>
	</div>
	<script>
	function generateUniformDataSet(){
		var i,l;
		l=getChecked('ugenoutput');//getOutputList();

		var a=eval(uniformminimum.value);
		var b=eval(uniformmaximum.value);
		var n=eval(uniformn.value);
		list[l]=[];
		for (i=0;i<n;i++)
			list[l][i]=(a+(random()*(b-a))).TOFIXED(printPrecision);
		if (genintegeryes.checked)
			for (i=0;i<n;i++)
				list[l][i]=round(list[l][i]);
		printLists();
		processLists();
//		closeAll();
		openDiv(dataListDiv);	
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
	<div id='normalGenDiv' class='expandable generator'>
	Output List:<br><script>printRadioList('ngenoutput');
	var a=document.getElementsByClassName('ngenoutput'+'radio');
	a[0].checked=true;</script>
		<table>
		<tr><td>Mean:</td><td> <input type="text" id="normalmean" value='0'></td></tr>
		<tr><td>Standard Deviation:</td><td> <input type="text" id="normalsd" value='1'></td></tr>
		<tr><td>Size:</td><td> <input type="text" id="normaln" value='100'></td></tr>
		</table>
		<button onclick="generateNormalDataSet();">Generate Data Set</button>
	</div>
	<script>
	function boxMuller(){
		var u1=random();
		var u2=random();
		var z=sqrt(-2*log(u1))*cos(2*PI*u2);
		return(z);
	}
	function generateNormalDataSet(){
		var i,l;

		l=getChecked('ngenoutput');//getOutputList();		
		var m=eval(normalmean.value);
		var s=eval(normalsd.value);
		var n=eval(normaln.value);
		list[l]=[];
		for (i=0;i<n;i++)
			//list[l][i]=(m+s*boxMuller()).TOFIXED(printPrecision);
			list[l][i]=(m+s*invnorm(random())).TOFIXED(printPrecision);
		if (genintegeryes.checked)
			for (i=0;i<n;i++)
				list[l][i]=round(list[l][i]);

		printLists();
		processLists();
//		closeAll();
		openDiv(dataListDiv);
	}
	</script>
<!---------------------------------------------------------------------------------------------------------------------------------->	
	<div id='binomialGenDiv' class='expandable generator'>
	Output List:<br><script>printRadioList('bgenoutput');
	var a=document.getElementsByClassName('bgenoutput'+'radio');
	a[0].checked=true;</script>
		<table>
		<tr><td>Probability of Success:</td><td> <input type="text" id="binomGenP" value='0.25'></td></tr>
		<tr><td>Sample Size:</td><td> <input type="text" id="binomGenN" value='31'></td></tr>
		</table>
		<button onclick="generateBinomialDataSet();">Generate Data Set</button>
	</div>
	<script>
	function generateBinomialDataSet(){
		var outlist=getChecked('bgenoutput');//getOutputList();
		var n= eval(binomGenN.value);
		var p= eval(binomGenP.value);
		var i;
		
		list[outlist]=[];
		for (i=0;i<p*n;i++){
			list[outlist].push(1);
		}
		for (;i<n;i++){
			list[outlist].push(0);
		}
		printLists();
		processLists();
//		closeAll();
		openDiv(dataListDiv);	
	}
	</script>
<!----------------------------------------------------------------------------------------------------------------------------------->	
	<div id='sampleGenDiv' class='expandable generator'>
	Input List:<br><script>printRadioList('sgeninput');	
	var a=document.getElementsByClassName('sgeninput'+'radio');
	a[0].checked=true;</script><br>
	Output List:<br><script>printRadioList('sgenoutput');
	var a=document.getElementsByClassName('sgenoutput'+'radio');
	a[1].checked=true;</script>
		<table>
		<tr><td>Sample Size:</td><td> <input type="text" id="samplesize" value='31'></td></tr>
		</table>
		<button onclick="generateSample();">Generate Data Set</button>
	</div>
	<script>
	function generateSample(){
		var inlist=0;
		var outlist=1;
		var i,j;
		var c;
				
		outlist=getChecked('sgenoutput');
		inlist=getChecked('sgeninput');		

		if (inlist==outlist)
			alert("Lists must be different.");
		else if (listN[inlist]==0)
			alert('The population list is empty.');
		else{
			list[outlist]=[];
			var n=eval(samplesize.value);
			for (i=0;i<n;i++){
				list[outlist].push(list[inlist][floor(random()*listN[inlist])]);
			}
			printLists();
			processLists();
//			closeAll();
			openDiv(dataListDiv);
		}
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
	<div id='resampleGenDiv' class='expandable generator'>
	Input List:<br><script>printRadioList('rgeninput');	
	var a=document.getElementsByClassName('rgeninput'+'radio');
	a[0].checked=true;</script><br>
	Output List:<br><script>printRadioList('rgenoutput');
	var a=document.getElementsByClassName('rgenoutput'+'radio');
	a[1].checked=true;</script><br>
	Statistic:<br>
		<label><input type='radio' name='resampletype' id='resamplemean' checked=true>Mean</input></label>
		<label><input type='radio' name='resampletype' id='resamplemedian'>Median</input></label>
		<label><input type='radio' name='resampletype' id='resamplevariance'>Variance</input></label>
		<table>
		<tr><td>Sample Size:</td><td> <input type="text" id="samplemeansize" value='31'></td></tr>
		<tr><td>Number of Samples:</td><td> <input type="text" id="samplemeannumsamples" value='100'></td></tr>
		</table>
		<button onclick="generateSampleMeans();">Generate Data Set</button>
	</div>
</div>
	<script>
	function generateSampleMeans(){
		var inlist=0;
		var outlist=1;
		var i,j;
		var c,r;
		var sample=[];
		
		outlist=getChecked('rgenoutput');
		inlist=getChecked('rgeninput');	

		if (inlist==outlist)
			alert("Lists must be different.");
		else if (listN[inlist]==0)
			alert('The population list is empty.');
		else{
			list[outlist]=[];
			var n=eval(samplemeansize.value);
			var N=eval(samplemeannumsamples.value);
			for (i=0;i<N;i++){
				sample=[];
				for (j=0;j<n;j++)
					sample.push(
						list[inlist][floor(random()*listN[inlist])]
					);
					r=summarizeArray(sample);
				if (resamplemean.checked) c=r.m;
				else if (resamplemedian.checked) c=r.q2;
				else if (resamplevariance.checked) c=r.s2;
				else c=0;
				list[outlist].push(c.TOFIXED(printPrecision));
			}
			printLists();
			processLists();
//			closeAll();
			openDiv(dataListDiv);
		}
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
</ul>
</div><!--generatedDiv-->
<!--generated data ---------------------------------------------->

<!----------------------------------------------------------------------------------------------------------------------------------->
<!-- canned dat-->
<div id='cannedDiv' class='pageDiv expandable'>
<div class='subPage'>
		Output List:<br><script>printRadioList('canoutput');
	var a=document.getElementsByClassName('canoutput'+'radio');
	a[0].checked=true;</script><br>
<ul>
<li>
ANSUR 2012 - Anthrompmetric Survey of U.S. Army Personel - The data below represent random samples of 50 females and 50 males from the ANSUR 2012 data. The data is aligned so that corresponding entries from each list are from the same individual.
<ul>
<li>Female: 
<button onclick='insertData(Fheight,FHeightLabel)'>Height</button>
<button onclick='insertData(Fspan,FSpanLabel)'>Span</button>
<button onclick='insertData(Fwaist,FWaistLabel)'>Waist Height</button>
<button onclick='insertData(Ffoot,FFootLabel)'>Foot Length</button>
<button onclick='insertData(Fweight,FWeightLabel)'>Weight</button>
<button onclick='insertData(Fage,FAgeLabel)'>Age</button>
</li>
<li>Male: 
<button onclick='insertData(Mheight, MHeightLabel)'>Height</button>
<button onclick='insertData(Mspan, MSpanLabel)'>Span</button>
<button onclick='insertData(Mwaist, MWaistLabel)'>Waist Height</button>
<button onclick='insertData(Mfoot, MFootLabel)'>Foot Length</button>
<button onclick='insertData(Mweight, MWeightLabel)'>Weight</button>
<button onclick='insertData(Mage, MAgeLabel)'>Age</button>
</li>
</ul>
</li>
</ul>
</div>
<script>
function insertData(a, b){

		var i,l;
		l=getChecked('canoutput');//
		var n=a.length;
		list[l]=[];
		for (i=0;i<n;i++)
			list[l][i]=a[i];
		listLabel[l]=b;
		printLists();
		processLists();
//		closeAll();
		openDiv(dataListDiv);	

}

var FFootLabel='F Foot'; var Ffoot=[ 251,257,235,257,258,246,247,245,230,244,227,245,272,240,224,249,250,234,248,252,244,250,267,220,240,257,260,232,256,252,266,256,225,243,243,274,228,245,234,260,233,262,240,249,217,237,253,268,247,225];
var FSpanLabel='F Span'; var Fspan=[ 1688,1669,1641,1746,1697,1619,1617,1683,1538,1605,1495,1633,1785,1578,1548,1738,1700,1560,1618,1660,1636,1698,1752,1529,1570,1719,1752,1643,1704,1639,1843,1738,1627,1613,1677,1720,1700,1631,1647,1693,1552,1662,1659,1734,1628,1521,1667,1840,1674,1511];
var FHeightLabel='F Height'; var Fheight=[1670,1570,1592,1712,1682,1608,1603,1704,1599,1642,1500,1628,1702,1633,1588,1646,1684,1543,1623,1633,1683,1658,1729,1545,1575,1685,1708,1590,1686,1628,1732,1615,1552,1590,1619,1679,1688,1618,1688,1629,1597,1694,1584,1714,1573,1600,1603,1718,1597,1549];
var FWaistLabel='F Waist Height'; var Fwaist=[997,970,962,1060,1042,957,974,1051,924,1000,899,979,1036,997,977,1035,954,903,955,968,986,1004,1083,900,938,996,1043,971,1007,962,1093,953,972,964,972,1018,1016,968,1005,998,939,1012,962,1061,933,978,947,1077,932,883];
var FWeightLabel='F Weight'; var Fweight=[762,672,609,582,619,785,561,687,654,733,644,703,1019,618,582,685,819,623,590,756,870,852,749,543,598,776,663,539,611,743,678,822,431,516,660,591,686,678,735,732,548,792,712,697,589,549,663,698,631,676];
var FAgeLabel='F Age'; var Fage=[32,18,19,25,20,27,24,44,33,38,40,23,27,20,20,36,30,27,25,18,36,26,24,40,19,33,27,23,20,21,38,52,23,23,22,19,21,21,34,39,21,25,58,39,24,20,33,20,39,45];


var MFootLabel='M Foot'; var Mfoot=[276,264,274,271,255,271,259,275,257,259,263,263,244,270,280,273,251,272,269,278,281,282,258,267,283,274,270,264,262,263,268,255,250,249,264,279,263,261,267,273,263,254,268,253,278,274,283,260,260,257];
var MSpanLabel='M Span'; var Mspan=[1800,1743,1877,1873,1699,1792,1694,1786,1729,1740,1748,1814,1677,1809,1916,1822,1783,1886,1739,1735,1861,1922,1834,1781,1979,1786,1829,1733,1789,1829,1775,1648,1708,1614,1766,1773,1790,1774,1834,1849,1737,1691,1790,1784,1855,1840,1878,1844,1743,1757];
var MHeightLabel='M Height'; var Mheight=[1791,1679,1838,1772,1706,1748,1694,1689,1680,1721,1728,1746,1606,1774,1811,1738,1679,1779,1691,1673,1758,1783,1771,1753,1907,1756,1742,1644,1740,1735,1748,1640,1655,1689,1740,1733,1743,1751,1795,1820,1734,1622,1745,1739,1785,1784,1785,1710,1671,1651];
var MWaistLabel='M Waist Height'; var Mwaist=[1061,1021,1115,1055,1006,1029,1007,1004,1006,1048,1035,1057,952,1050,1123,1041,1022,988,1024,1005,1087,1113,1075,1039,1154,1023,1010,998,1060,1063,1011,960,999,997,1018,1050,1015,1040,1086,1070,1036,978,978,1065,1087,1079,1087,1045,1019,1004];
var MWeightLabel='M Weight'; var Mweight=[838,682,851,1001,717,869,747,685,713,951,815,696,568,905,847,927,688,1329,813,988,953,674,703,798,1140,869,920,862,735,701,1044,667,677,600,862,723,734,975,701,1138,749,717,1016,775,742,878,962,779,772,609];
var MAgeLabel='M Age'; var Mage=[42,20,36,35,21,47,24,30,25,23,32,26,30,49,29,51,22,49,31,24,27,26,21,22,26,30,21,29,20,27,33,29,36,26,26,18,48,32,32,36,24,23,22,30,22,41,27,46,33,28]; 

</script>
</div>
<!-- canned data--->
<!---------------------------------------------------------------------------------------------------------------------------------->
<div id='dataTableDiv'>
	<table>
	
			<script>
			document.write('<tr>');
//			for (let i=0;i<numLists;i++)
//				document.write('<th>'+i+'</th>')
//			document.write('</tr><tr>');
			for (let i=0;i<numLists;i++)
				document.write('<td><textarea class="datalabel" rows=1 cols=10 wrap="off"></textarea></td>');
			document.write('</tr><tr>');
			for (let i=0;i<numLists;i++)
				document.write('<td ><textarea class="datalist"  id="datalist'+i+'" rows=1000 cols=10 wrap="off"></textarea></td>');
			document.write('</tr>');
			</script>
	</table>
</div>	
</div><!--dataListDiv-->
<!---- Data Lists ---------------------------------------------->


<!---- Summary Statistics ------------------------------------>
<div id='summaryDiv' class='pageDiv expandable'>
<div class='pageMenu'>
<button class='expander' data-open='regularSummary' data-close='ranVarStats'>Column Summary</button>
<button class='expander' data-open='ranVarStats' data-close='regularSummary'>Random Variable</button>
</div>

<div class='subPage'>
<div id='regularSummary' class='expandable'></div>

<div class='expandable' id='ranVarStats'>
Value List: <br>
<script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='radio'  name='ranvarValueradio'  class='ranvarValueradio' onclick='ranVarSummary();'><span class='ranvarValuelabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('ranvarValue'+'label');	
</script>
<br>
Probability List: <br><script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='radio'  name='ranvarProbabilityradio'  class='ranvarProbabilityradio' onclick='ranVarSummary();'><span class='ranvarProbabilitylabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('ranvarProbability'+'label');	
</script>
<br>
<div id='ranVarInnerDiv'></div>
<canvas id='ranVarCanvas' width=400 height=200></canvas>
</div>

</div>
</div> <!--- summaryDiv--->
<script>
function ranVarSummary(){
ranVarInnerDiv.style.display='none';
ranVarCanvas.style.display='none';
	var l1=-1, l2=-1;
	var D=40;
	var i,j;
	var values=document.getElementsByClassName('ranvarValueradio');
	var probabilities=document.getElementsByClassName('ranvarProbabilityradio');
	for (i=0;i<numLists;i++){
		if (listN[i]<=0) values[i].checked=false;
		if (listN[i]<=0) probabilities[i].checked=false;
		}


	for (i=0;i<numLists;i++){
		if (values[i].checked) l1=i;
		if (probabilities[i].checked) l2=i;
	}
	if ((l1!=-1) && (l2!=-1)){
		if (l1==l2)
			alert('Please select different lists.')
		else if (listN[l1]!=listN[l2]){
			alert('Your lists are different lengths.')
			probabilities[l2].checked=false;
		}	
		else if ((listMin[l2]<0) || (listMax[l2]>1)){
			alert('Your probability list contains values out of range');
			probabilities[l2].checked=false;
		}	
		else if (listSum[l2]!=1){
			alert('Your probabilities do not add to 1.');
			probabilities[l2].checked=false;
		}	
		else{
			var r='';
			var e=0;
			var s2=0;
			var j;
			var n=listN[l1];
			for (j=0;j<n;j++)
				e+=list[l1][j]*list[l2][j];
			for (j=0;j<n;j++)
				s2+=(list[l1][j]-e)*(list[l1][j]-e)*list[l2][j];
			r+='<ul>'+'<li>&mu;='+e.TOFIXED(printPrecision)+'</li><li>&sigma;<sup>2</sup>='+s2.TOFIXED(printPrecision)+'</li><li>s='+sqrt(s2).TOFIXED(printPrecision)+'</li></ul>';
			ranVarInnerDiv.innerHTML=r;
			ranVarInnerDiv.style.display='block';
			
			
			var can=ranVarCanvas;
			var ctx=can.getContext('2d');
			var w=can.width;
			var h=can.height;	
			ctx.fillStyle='white';
			ctx.fillRect(0,0,w,h);	
			ctx.fillStyle='black';
			var dx=w/(n+2);
			for (j=0;j<n;j++){
				ctx.save();
				ctx.translate(j*dx+dx/2, h-40);
				ctx.rotate(PI/2);
				ctx.fillText(list[l1][j].TOFIXED(2),0,0);
				ctx.restore();
			}

			ctx.lineWidth=0.95*dx;
			ctx.beginPath();
			for (j=0;j<n;j++){
				ctx.moveTo(j*dx+dx/2, h-50);
				ctx.lineTo(j*dx+dx/2, h-(h-60)*list[l2][j]/listMax[l2]-50);
			}
			ctx.stroke();
			
			ranVarCanvas.style.display='block';
		}
	}
}	

</script>
<!---- Summary Statistics ------------------------------------>


<!--charts------------------------------------------------------>
<div id='chartDiv' class='pageDiv expandable'>
<div class='pageMenu'>
<button class='expander' data-open='histoDiv' data-close='histoDiv2,boxDiv,scatterDiv,quantileDiv,insideHistoDiv,insideHistoDiv2'>Histograms</button>
<button class='expander' data-open='histoDiv2' data-close='histoDiv,boxDiv,scatterDiv,quantileDiv,insideHistoDiv,insideHistoDiv2'>Bar Chart</button>
<button class='expander' data-open='boxDiv' data-close='histoDiv2,histoDiv,scatterDiv,quantileDiv,boxplotCanvasDiv'>Box Plots</button>
<button class='expander' data-open='scatterDiv' data-close='histoDiv2,histoDiv,boxDiv,quantileDiv,scatterPlotDiv'>Scatter Plots</button>
<button class='expander' data-open='quantileDiv'  data-close='histoDiv2,histoDiv,boxDiv,scatterDiv,quantilePlotDiv'>Quantile Plots</button>
</div>

<div class='subPage'>
<!------------------------------------------------------------------------------------------------------------------------------->
	<div id='histoDiv' class='expandable'>
	<table>
	<!--tr><td>Minimum value: </td><td><textarea id='histoMin' rows=1 cols=10 onkeydown='purge(insideHistoDiv);'>0</textarea></td></tr>
	<tr><td>Maximum value: </td><td><textarea id='histoMax' rows=1 cols=10 onkeydown='purge(insideHistoDiv);'>100</textarea></td></tr-->
	<tr><td>Number of Bins: </td><td><textarea id='histoBins' rows=1 cols=10 onkeydown='purge(insideHistoDiv);'>10</textarea></td></tr>
	</table>
	<button onclick="drawHistograms();">Redraw</button><br>
	Lists: <br><script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  class='histocheckbox' onclick='drawHistograms();'><span class='histolabel'  style='color:"+theColors[i]+";'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('histo'+'label');	
	</script>
	<div id="insideHistoDiv"><canvas id="histoCanvas" width=400 height=200></canvas>
	<div id='freqTableDiv'></div>
	</div>
	</div>
<script>

function drawHistograms(){ 
	var i,bin,j;
	var n,dx,d;
	var c,H;
	var Min, MAX;
	processLists();
	n=eval(histoBins.value);
//	d=(eval(histoMax.value)-eval(histoMin.value))/n;
//	Min=eval(histoMin.value);
	var can=histoCanvas;
	var ctx=can.getContext('2d');
	var w=can.width;
	var h=can.height;	
	ctx.fillStyle='white';
	ctx.fillRect(0,0,w,h);	
	var boxes=document.getElementsByClassName('histocheckbox');	
freqTableDiv.innerHTML='';	
insideHistoDiv.style.display='none';
var numChecks=0;
var lastX;
for (i=0;i<numLists;i++)
	if ((boxes[i].checked) && listN[i]>0)
		numChecks++;
	else
		boxes[i].checked=false;
if (numChecks>0){	
Min=Infinity;
Max=-Infinity;
for (i=0;i<numLists;i++){
	if (boxes[i].checked){
		if (listMin[i]<Min) Min=listMin[i];
		if (listMax[i]>Max) Max=listMax[i];
	}
}
d=(Max-Min);
Min=Min-0.05*d;
Max=Max+0.05*d;
d=(Max-Min)/n;
			ctx.font='12px Helvetica';
			ctx.fillStyle='black';
			dx=w/(n+2);
			lastX=-20;
			for (j=0;j<=n;j++)
			if (j*dx-lastX>12){
				ctx.save();
				ctx.translate(j*dx, h-40);
				ctx.rotate(PI/2);
				ctx.fillText((Min+j*d).TOFIXED(2),0,0);
				lastX=j*dx;
				ctx.restore();
			}
	var listsDrawn=0;
	var freqTables='';
	freqTableDiv.innerHTML='HELLO';
	for (i=0;i<numLists;i++)
	if ((listN[i]>1) && (boxes[i].checked)){
		//histoDiv.style.display='block';
		freqTables+='<table border=1><tr><th colspan=4>'+listLabel[i]+'</th></tr>';
		freqTables+='<tr><th>Interval</th><th>Frequency</th><th>Relative Frequency</th><th>Cumulative Frequency</th></tr>';
		ctx.strokeStyle=theColors[i];
			c=[];
			for (bin=0;bin<=n;bin++)
				c[bin]=0;
			for (j=0;j<listN[i];j++)
				c[ floor((list[i][j]-Min)/d)  ]++;
			H=1;
			var cum=[];
			cum[0]=c[0];
			for (j=1;j<n;j++)
				cum[j]=cum[j-1]+c[j];
			for (j=0;j<n;j++)
				if (c[j]>H)
					H=c[j];
			for (j=0;j<n;j++){
				freqTables+='<tr><td>'+(Min+j*d).TOFIXED(2)+'&le; x &lt; '+(Min+(j+1)*d).TOFIXED(2)+'</td><td>'+c[j]+'</td><td>'+(c[j]/listN[i]).TOFIXED(4)+'</td><td>'+(cum[j]/listN[i]).TOFIXED(4)+'</td></tr>'
			}
			ctx.lineWidth=0.95*dx/numChecks;
			ctx.beginPath();
			for (j=0;j<=n;j++){
				ctx.moveTo(j*dx+dx/2+listsDrawn*dx/numChecks, h-50);
				ctx.lineTo(j*dx+dx/2+listsDrawn*dx/numChecks, h-(h-60)*c[j]/H-50);
			}
			listsDrawn++;
			ctx.stroke();
			freqTables+='</table>';
	}
	else boxes[i].checked=false;
	freqTableDiv.innerHTML=freqTables;
	insideHistoDiv.style.display='block';	
}	
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------------------------------->
	<div id='histoDiv2' class='expandable'>
	<button onclick="drawHistograms2();">Redraw</button><br>
	Lists: <br><script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='radio'  name='histo2radio'  class='histo2radio' onclick='drawHistograms2();'><span class='histo2label'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('histo2'+'label');	
	</script>
	<div id="insideHistoDiv2"><canvas id="histoCanvas2" width=400 height=200></canvas>
	<div id='freqTableDiv2'></div>
	</div>
	</div>
<script>

function drawHistograms2(){ 
	processLists();
	var can=histoCanvas2;
	var ctx=can.getContext('2d');
	var w=can.width;
	var h=can.height;	
	ctx.fillStyle='white';
	ctx.fillRect(0,0,w,h);	
	freqTableDiv2.innerHTML='';	
	insideHistoDiv2.style.display='none';
	var i;
	var inlist=0;
	var radiolist=document.getElementsByClassName('histo2radio');
	for (i=0;i<numLists;i++)
		if (radiolist[i].checked) inlist=i;
	if (listN[inlist]==0){
		radiolist[inlist].checked=false;
		quantilePlotDiv.style.display='none';
	}
	else{
		var a=list[inlist].toSorted(function(a, b){return a - b}); 
		var names=[];
		var counts=[];
		var t,s;
		for (i=0;i<a.length;i++){
			t=a[i];
			s=names.indexOf(t);
			if (s==-1){
				names.push(t);
				counts.push(1);
			}
			else{
				counts[s]++;
			}
		} 
		var n=counts.length;
		var freqTables='<table border=1><tr><th colspan=3>'+listLabel[inlist]+'</th></tr>';
		freqTables+='<tr><th>Value</th><th>Frequency</th><th>Relative Frequency</th></tr>';
		for (j=0;j<n;j++)
			freqTables+='<tr><td>'+names[j]+'</td><td>'+counts[j]+'</td><td>'+(counts[j]/listN[inlist]).TOFIXED(4)+'</td></tr>';
		freqTables+='</table>';
		freqTableDiv2.innerHTML=freqTables;
		insideHistoDiv2.style.display='block';	
		var dx=w/n;
		ctx.font='12px Helvetica';
		ctx.fillStyle='black';
		ctx.strokeStyle='black';
		for (j=0;j<n;j++){
				ctx.save();
				ctx.translate(j*dx+dx/2-6, h-40);
				ctx.rotate(PI/2);
				ctx.fillText(names[j],0,0);
				ctx.restore();			
		}
		var Max=0;
		for (j=0;j<n;j++)
			if (counts[j]>Max) Max=counts[j];
		ctx.lineWidth=0.95*dx;
		ctx.beginPath();
		for (j=0;j<n;j++){
			ctx.moveTo(j*dx+dx/2, h-50);
			ctx.lineTo(j*dx+dx/2, h-(h-60)*counts[j]/Max-50);			
		}
		ctx.stroke();
	}

/*
			ctx.lineWidth=0.95*dx/numChecks;
			ctx.beginPath();
			for (j=0;j<=n;j++){
				ctx.moveTo(j*dx+dx/2+listsDrawn*dx/numChecks, h-50);
				ctx.lineTo(j*dx+dx/2+listsDrawn*dx/numChecks, h-(h-60)*c[j]/H-50);
			}
			listsDrawn++;
			ctx.stroke();
			freqTables+='</table>';
	}
	else boxes[i].checked=false;
	freqTableDiv.innerHTML=freqTables;
	insideHistoDiv.style.display='block';	
}
*/
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------------------------------->
<!------------------------------------------------------------------------------------------------------------------------------->

	<div id='boxDiv' class='expandable'>
	Lists: <br><script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  class='boxcheckbox' onclick='drawBoxPlots();'><span class='boxlabel' style='color:"+theColors[i]+";'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('box'+'label');
	</script>
	<br>
	<div id='boxplotCanvasDiv' class='expandable'>
	<canvas id='boxplot' width=400 height=400></canvas>
	</div>
	</div>
<script>
function drawBoxPlots(){
	var i,j,m,M,x1,x2,x3,x4,x5;
	var y;
	var d;
	var can=boxplot;
	var ctx=can.getContext('2d');
	var w=can.width;
	var h=can.height;
	var plotted=false;
	
	ctx.strokeStyle='black';
	ctx.fillStyle='white';
	ctx.lineWidth=1;
	ctx.fillRect(0,0,w,h);

var boxcheckboxes=document.getElementsByClassName('boxcheckbox');
for (i=0;i<numLists;i++)
	if (listN[i]<=0) boxcheckboxes[i].checked=false;
		
	i=0;
	while ((i<numLists) && ((listN[i]==0) || (!boxcheckboxes[i].checked))) i++;
	if (i<numLists){
		m=listMin[i]; 
		M=listMax[i];
		for (j=i+1;j<numLists;j++) if (boxcheckboxes[j].checked){
			if (listMin[j]<m) m=listMin[j];
			if (listMax[j]>M) M=listMax[j];
		}
		d=h/(numLists+3);
		y=d+30;
		ctx.font='12px Helvetica';
		var bw=5
		for (i=0;i<numLists;i++)
			if ((boxcheckboxes[i].checked) && (listN[i]>0)){
			plotted=true;
				ctx.fillStyle='black';
				ctx.strokeStyle=theColors[i];
				ctx.beginPath();
				x1=(listMin[i]-m)*(w-2*d)/(M-m)+1.5*d;
				x2=(listQ1[i]-m)*(w-2*d)/(M-m)+1.5*d;
				x3=(listQ2[i]-m)*(w-2*d)/(M-m)+1.5*d;
				x4=(listQ3[i]-m)*(w-2*d)/(M-m)+1.5*d;
				x5=(listMax[i]-m)*(w-2*d)/(M-m)+1.5*d;
				ctx.moveTo(x1,y-(d/2-bw));
				ctx.lineTo(x1,y+(d/2-bw));
				ctx.moveTo(x3,y-(d/2-bw))
				ctx.lineTo(x3,y+(d/2-bw));
				ctx.moveTo(x5,y-(d/2-bw))
				ctx.lineTo(x5,y+(d/2-bw));
				ctx.rect(x2,y-(d/2-bw), x4-x2,d-2*bw);
				ctx.moveTo(x1,y);
				ctx.lineTo(x5,y);
				ctx.stroke();
				ctx.fillStyle=theColors[i];
				ctx.fillText(listLabel[i],2,y);
				y+=d+2;
			}
	}
	if (plotted){
			ctx.font='12px Helvetica';
			ctx.fillStyle='black';
			var daxis=(M-m)/10;
			var dx=(w-2*d)/10;
			for (j=0;j<11;j++){
				ctx.save();
				ctx.translate(1.5*d+j*dx, 5);
				ctx.rotate(PI/2);
				ctx.fillText((m+j*daxis).TOFIXED(2),0,0);
				ctx.restore();
			}	
	boxplotCanvasDiv.style.display='block';	
	}
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------->

	<div id='scatterDiv' class='expandable'>
X List: <br>
<script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='radio'  name='scatterxradio'  class='scatterxradio' onclick='drawScatterPlot();'><span class='scatterxlabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('scatterx'+'label');	
</script>
<br>
Y List: <br><script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='radio'  name='scatteryradio'  class='scatteryradio' onclick='drawScatterPlot();'><span class='scatterylabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('scattery'+'label');	
</script>
<br>
<div id='scatterPlotDiv' class='expandable'>
<canvas id='scatterplotcanvas' width=400 height=400></canvas>	
</div>
</div>

<script>
function drawScatterPlot(){
	var l1=-1, l2=-1;
	var D=40;
	var i,j;
var scatterxradios=document.getElementsByClassName('scatterxradio');
var scatteryradios=document.getElementsByClassName('scatteryradio');
for (i=0;i<numLists;i++){
	if (listN[i]<=0) scatterxradios[i].checked=false;
	if (listN[i]<=0) scatteryradios[i].checked=false;
	}


	for (i=0;i<numLists;i++){
		if (scatterxradios[i].checked) l1=i;
		if (scatteryradios[i].checked) l2=i;
	}
	if ((l1!=-1) && (l2!=-1)&&(listN[l1]*listN[l2]!==0) && (listN[l1]==listN[l2]))
	{
		var xlist=l1;
		var ylist=l2;
		var can=scatterplotcanvas;
		var ctx=can.getContext('2d');
		var w=can.width;
		var h=can.height;
			ctx.fillStyle='white';
			ctx.fillRect(0,0,w,h);	
		var xmin=listMin[xlist];
		var xmax=listMax[xlist];
		var ymin=listMin[ylist];
		var ymax=listMax[ylist];
		var n = listN[xlist];
		var W=w-2*D;
		var H=h-2*D;
		var wx=xmax-xmin;
		var wy=ymax-ymin;

		ctx.strokeStyle='gray';
		ctx.fillStyle='white';
		ctx.lineWidth=1;
		ctx.fillRect(0,0,w,h);
		ctx.beginPath();
		ctx.rect(0,0,w,h);
		ctx.rect(D,D,W,H);
		ctx.stroke();
		ctx.strokeStyle='black';
		for (i=0;i<n;i++){
			ctx.beginPath();
			ctx.arc(D+W*(list[xlist][i]-xmin)/wx, h-(D+H*(list[ylist][i]-ymin)/wy), 1,0,2*Math.PI);
			ctx.stroke();
		}
		ctx.font='12px Helvetica';
		ctx.fillStyle='black';
		var dx=(xmax-xmin)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6+W*(j*dx)/wx, h-D+6); 
			ctx.rotate(PI/2);
			ctx.fillText((xmin+j*dx).TOFIXED(2),0,0);
			ctx.restore();
		}		
		var dy=(ymax-ymin)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6,h-(D-6+H*(j*dy)/wy)); 
			ctx.textAlign='end';
			ctx.fillText((xmin+j*dy).TOFIXED(2),0,0);
			ctx.restore();
		}		
scatterPlotDiv.style.display='block';
	}	
	else{
		//alert('There is a problem with the lists you have selected.');
		scatterPlotDiv.style.display='none';
		}
	
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------->

	<div id='quantileDiv' class='expandable'>
	Data List: <br><script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='radio'  name='quantileradio'  class='quantileradio' onclick='drawQuantilePlot();'><span class='quantilelabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('quantile'+'label');	
</script><br>
<div id='quantilePlotDiv' class='expandable'>
<canvas id='quantileplotcanvas' width=400 height=400></canvas>
</div>
	</div>
<script>
function drawQuantilePlot(){
	var i;
	var inlist=0;
	var radiolist=document.getElementsByClassName('quantileradio');
	for (i=0;i<numLists;i++)
		if (radiolist[i].checked) inlist=i;
	if (listN[inlist]==0){
		radiolist[inlist].checked=false;
		quantilePlotDiv.style.display='none';
	}
	else{
		var a=list[inlist].toSorted(function(a, b){return a - b});
		var b=[];
		for (i=0;i<a.length;i++){
			b[i]=invnorm((2*i+1)/(2*a.length));
		}
		var minData=listMin[inlist];
		var maxData=listMax[inlist];
		var minZ=b[0];
		var maxZ=b[b.length-1];
		
		var can=quantileplotcanvas;
		var ctx=can.getContext('2d');
		var w=can.width;
		var h=can.height;
		var D=40;
		ctx.strokeStyle='gray';
		ctx.fillStyle='white';
		ctx.lineWidth=1;
		ctx.fillRect(0,0,w,h);
		ctx.beginPath();
		ctx.rect(D,D,w-2*D,h-2*D);
		ctx.stroke();
		ctx.strokeStyle='black';
		var wx=w-2*D;
		var wy=h-2*D;
		for (i=0;i<a.length;i++){
			a[i]=  D+wx*(a[i]-minData)/(maxData-minData);
			b[i]= D+wy*(b[i]-minZ)/(maxZ-minZ);
		}
		for (i=0;i<a.length;i++){
			ctx.beginPath();
			ctx.arc(a[i], h-b[i], 1,0,2*Math.PI);
			ctx.stroke();
		}
		var j
		ctx.font='12px Helvetica';
		ctx.fillStyle='black';
		var dx=(maxData-minData)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6+wx*(j*dx)/(maxData-minData), h-D+6); 
			ctx.rotate(PI/2);
			ctx.fillText((minData+j*dx).TOFIXED(2),0,0);
			ctx.restore();
		}
		
		var dy=(maxZ-minZ)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6,h-(D-6+wy*(j*dy)/(maxZ-minZ))); 
			ctx.textAlign='end';
			ctx.fillText((minZ+j*dy).TOFIXED(2),0,0);
			ctx.restore();
		}	
		
		
		quantilePlotDiv.style.display='block';
	}
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------->

</div>
</div> <!--chartDiv-->	
<!--charts------------------------------------------------------>

<!--distribution calculators--------------------------------------->
<div id='distributionDiv' class='pageDiv'>
<div class='pageMenu expandable'>
<button class='expander' data-open='binomialCalcDiv' data-close='poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Binomial</button>
<button class='expander' data-open='poissonCalcDiv' data-close='binomialCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Poisson</button>
<button class='expander' data-open='normalCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Normal</button>
<button class='expander' data-open='invnormalCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Inverse Normal</button>
<button class='expander' data-open='tCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>t</button>
<button class='expander' data-open='invtCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Inverse t</button>
<button class='expander' data-open='chi2CalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,invchi2CalcDiv'>&chi;<sup>2</sup></button>
<button class='expander' data-open='invchi2CalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv'>Inverse &chi;<sup>2</sup></button>
</div>
<div class='subPage'>
<ul>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='binomialCalcDiv' data-close='poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Binomial</button></li>
	<div id='binomialCalcDiv' class='expandable'>
	<table>
	<tr><td>Number of Trials: 		</td> <td><b>n=</b> </td><td><input type='text' id='binomialn' value="100" onkeydown='purge(binomialAnswerDiv);'></td></tr>
	<tr><td>Probability of Success:  	</td> <td><b>p=</b></td><td><input type='text' id='binomialp' value="0.5" onkeydown='purge(binomialAnswerDiv);'></td></tr>
	<tr><td><b>P(x </b>
	<input name='bequal' id='binomialequal' type='radio' checked=true onclick='purge(binomialAnswerDiv);'><label for='binomialequal'>=</label>
	<input name='bequal' id='binomiallt' type='radio' onclick='purge(binomialAnswerDiv);'><label for='binomiallt'>&lt;</label>
	<input name='bequal' id='binomialleq' type='radio' onclick='purge(binomialAnswerDiv);'><label for='binomialleq'>&leq;</label>
	<input name='bequal' id='binomialgt' type='radio' onclick='purge(binomialAnswerDiv);'><label for='binomialgt'>&gt;</label>
	<input name='bequal' id='binomialgeq' type='radio' onclick='purge(binomialAnswerDiv);'><label for='binomialgeq'>&geq;</label>
	</td><td></td><td><input type='text' id='binomialx' value="50" onkeydown='purge(binomialAnswerDiv);'> <b>)</b></td></tr>
	</table>
	<button onclick="calculateBinomialDistribution();">Calculate</button><br>
	<div id='binomialAnswerDiv' class='answerDiv'>
	<span id="binomialanswer"></span><br>
	<canvas id='binomialcanvas' width="400" height="100"></canvas>
	</div>
	</div>
	<script>
	//binomial distribution ---------------------------------------------------------------------
	function calculateBinomialDistribution(){
	try{
		var n=eval(binomialn.value);
		var p=eval(binomialp.value);
		var x=eval(binomialx.value);
		
		var a,b;
		if (!(n>0))
			alert('The number of trials should be greater than 0.');
		else if (!((0<p) && (p<1)))
			alert('The probability of success should be between 0 and 1.');
		else if (!((0<=x) && (x<=n)))
			alert('The target value should be between 0 and n.');
		else{
			if (binomialequal.checked){
				binomialanswer.innerHTML='Probability='+binompdf(n,p,x).TOFIXED(printPrecision);
				a=x;
				b=x;
				}
			else if (binomiallt.checked){
				binomialanswer.innerHTML='Probability='+binomcdf(n,p,x-1).TOFIXED(printPrecision);
				a=0;
				b=x-1;
				}
			else if (binomialleq.checked){
				binomialanswer.innerHTML='Probability='+binomcdf(n,p,x).TOFIXED(printPrecision);
				a=0;
				b=x;
				}
			else if (binomialgt.checked){
				binomialanswer.innerHTML='Probability='+(1-binomcdf(n,p,x)).TOFIXED(printPrecision);
				a=x+1;
				b=n;
				}
			else if (binomialgeq.checked){
				binomialanswer.innerHTML='Probability='+(1-binomcdf(n,p,x-1)).TOFIXED(printPrecision);
				a=x;
				b=n;
				}

			var ctx=binomialcanvas.getContext('2d');
			var w=binomialcanvas.width;
			var h=binomialcanvas.height;
			var i;
			var m=0;
			for (i=0;i<=n;i++)
				if (binompdf(n,p,m)<binompdf(n,p,i))
					m=i;
			m=binompdf(n,p,m);
			ctx.strokeStyle='gray';
			ctx.fillStyle='white';
			ctx.lineWidth=w/n;
			ctx.fillRect(0,0,w,h);
			ctx.beginPath();
			for (i=0;i<=n;i++){
				ctx.moveTo(i*w/n,h);
				ctx.lineTo(i*w/n,h-Math.ceil(binompdf(n,p,i)*200/(2*m)));
			}
			ctx.stroke();

			ctx.strokeStyle='black';
			ctx.beginPath();
			for (i=a;i<=b;i++){
				ctx.moveTo(i*w/n,h);
				ctx.lineTo(i*w/n,h-Math.ceil(binompdf(n,p,i)*200/(2*m)));
			}
			ctx.stroke();
			binomialAnswerDiv.style.display='block';
		}
		
	}
	catch(err){
		alert('Input Error.');
	}
	}
	//end binomial distribution------------------------------------------------------------

	</script>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='poissonCalcDiv' data-close='binomialCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Poisson</button></li>
	<div id='poissonCalcDiv' class='expandable'>
	<table>
	<tr><td>Mean: 		</td> <td><b>&mu;=</b> </td><td><input type='text' id='poissonm' value="55" onkeydown='purge(poissonAnswerDiv);'></td></tr>
	<tr><td><b>P(x </b>
	<input name='pequal' id='poissonequal' type='radio' checked=true onclick='purge(poissonAnswerDiv);'><label for='poissonequal'>=</label>
	<input name='pequal' id='poissonlt' type='radio' onclick='purge(poissonAnswerDiv);'><label for='poissonlt'>&lt;</label>
	<input name='pequal' id='poissonleq' type='radio' onclick='purge(poissonAnswerDiv);'><label for='poissonleq'>&leq;</label>
	<input name='pequal' id='poissongt' type='radio' onclick='purge(poissonAnswerDiv);'><label for='poissongt'>&gt;</label>
	<input name='pequal' id='poissongeq' type='radio' onclick='purge(poissonAnswerDiv);'><label for='poissongeq'>&geq;</label>
	</td><td></td><td><input type='text' id='poissonx' value="50" onkeydown='purge(poissonAnswerDiv);'> <b>)</b></td></tr>
	</table>
	<button onclick="calculatePoissonDistribution();">Calculate</button><br>
	<div id='poissonAnswerDiv' class='answerDiv'>
	<span id="poissonanswer"></span><br>
	<canvas id='poissoncanvas' width="400" height="100"></canvas>
	</div>
	</div>
	<script>
	//poisson distribtuion ------------------------------------------------------------------
	function calculatePoissonDistribution(){
	try{
		var m=eval(poissonm.value);
		var x=eval(poissonx.value);
		var n=2*m;
		var a,b;
		if (!(m>0))
			alert('The mean should be greater than 0.');
		else if (!(x>=0))
			alert('The target value of x should be greater than or equal to 0.');
		else{
			if (poissonequal.checked){
				poissonanswer.innerHTML='Probability='+poissonpdf(m,x).TOFIXED(printPrecision);
				a=x;
				b=x;
				}
			else if (poissonlt.checked){
				poissonanswer.innerHTML='Probability='+poissoncdf(m,x-1).TOFIXED(printPrecision);
				a=0;
				b=x-1;
				}
			else if (poissonleq.checked){
				poissonanswer.innerHTML='Probability='+poissoncdf(m,x).TOFIXED(printPrecision);
				a=0;
				b=x;
				}
			else if (poissongt.checked){
				poissonanswer.innerHTML='Probability='+(1-poissoncdf(m,x)).TOFIXED(printPrecision);
				a=x+1;
				b=n;
				}
			else if (poissongeq.checked){
				poissonanswer.innerHTML='Probability='+(1-poissoncdf(m,x-1)).TOFIXED(printPrecision);
				a=x;
				b=n;
				}

			var ctx=poissoncanvas.getContext('2d');
			var w=poissoncanvas.width;
			var h=poissoncanvas.height;
			ctx.fillStyle='white';
			ctx.fillRect(0,0,w,h);	
			var i;
			var M=0;
			for (i=0;i<=n;i++)
				if (poissonpdf(m,M)<poissonpdf(m,i))
					M=i;
			M=poissonpdf(m,M);
			ctx.strokeStyle='gray';
			ctx.fillStyle='white';
			ctx.lineWidth=w/n;
			ctx.fillRect(0,0,w,h);
			ctx.beginPath();
			for (i=0;i<=n;i++){
				ctx.moveTo(i*w/n,h);
				ctx.lineTo(i*w/n,h-Math.ceil(poissonpdf(m,i)*200/(2*M)));
			}
			ctx.stroke();

			ctx.strokeStyle='black';
			ctx.beginPath();
			for (i=a;i<=b;i++){
				ctx.moveTo(i*w/n,h);
				ctx.lineTo(i*w/n,h-Math.ceil(poissonpdf(m,i)*200/(2*M)));
			}
			ctx.stroke();
			poissonAnswerDiv.style.display='block';
		}
		
	}
	catch(err){
		alert('Input Error.');
	}
	}
	//end poisson distribution ----------------------------------------------------------

	</script>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='normalCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Normal</button></li>
	<div id='normalCalcDiv' class='expandable'>
	<table>
	<tr><td>Mean: 			</td> <td><b>&mu;=</b> </td><td><input type='text' id='normalm' value="0" onkeydown='purge(normalAnswerDiv);'></td></tr>
	<tr><td>Standard Deviation:  	</td> <td><b>&sigma;=</b></td><td><input type='text' id='normals' value="1" onkeydown='purge(normalAnswerDiv);'></td></tr>
	</table>
	<table>
	<tr><td>Area on:
	<input type='radio' name='ntype' id='nleft'  onclick='showinline(nrightspan);purge(nleftspan);purge(normalAnswerDiv);'><label for='nleft'>Left</label>
	<input type='radio' name='ntype' id='nmiddle' onclick='showinline(nrightspan);showinline(nleftspan);purge(normalAnswerDiv);' checked=true ><label for='nmiddle'>Middle</label>
	<input type='radio' name='ntype' id='nright' onclick='purge(nrightspan);showinline(nleftspan);purge(normalAnswerDiv);'><label for='nright'>Right</label>	
	</td></tr>
	<tr><td>
	<b>P(</b> <span id='nleftspan'><input type='text' id='normala' value="-1" onkeydown='purge(normalAnswerDiv);'>&lt;</span> <b>x</b> 
	<span id='nrightspan'>&lt; <input type='text' id='normalb' value="1" onkeydown='purge(normalAnswerDiv);'>  </span> <b>)</b></td>
	</tr>
	</table>
	<button onclick="calculateNormalDistribution();">Calculate</button><br>
	<div id='normalAnswerDiv' class='answerDiv'>
	<span id="normalanswer"></span><br>
	<canvas id='normalcanvas' width="400" height="200"></canvas>
	</div>
	</div>
	<script>

	function drawBellSummary(cvs, mean, sd, leftz, rightz, highlight, leftcolor, middlecolor, rightcolor, hcolor){
		var ctx=cvs.getContext('2d');
		var w=cvs.width;
		var h=cvs.height;
		ctx.fillStyle='white';
		ctx.fillRect(0,0,w,h);	
		ctx.fillStyle='black';
		var leftStop=10;
		var graphWidth=w-2*leftStop
		var bottomStop=40;
		var H=h-bottomStop;		

			if (middlecolor!= null)
				ctx.strokeStyle=middlecolor;
			else
				ctx.strokeStyle='gray';
		ctx.beginPath();
		for (i=0;i<=graphWidth;i++){
			ctx.moveTo(i+leftStop,h-bottomStop);
			z=(i-graphWidth/2)/(graphWidth/6);
			ctx.lineTo(i+leftStop,h-bottomStop-2*H*normalpdf(z));//h-Math.ceil(H*normalpdf(z)));
		}
		ctx.stroke();


		var cutoff;
		if (leftz!=null){
			cutoff=(leftz-mean)/sd;
			if (leftcolor!= null)
				ctx.strokeStyle=leftcolor;
			else
				ctx.strokeStyle='red';
			ctx.beginPath();
			for (i=0;i<=graphWidth;i++){
				z=(i-graphWidth/2)/(graphWidth/6);
				if (z<=cutoff){
					ctx.moveTo(i+leftStop,h-bottomStop);
					ctx.lineTo(i+leftStop,h-bottomStop-2*H*normalpdf(z));//h-Math.ceil(H*normalpdf(z)));
				}	
			}
			ctx.stroke();
		}
		
		if (rightz!=null){
			cutoff=(rightz-mean)/sd;
			if (rightcolor!= null)
				ctx.strokeStyle=rightcolor;
			else
				ctx.strokeStyle='red';
			ctx.beginPath();
			for (i=0;i<=graphWidth;i++){
				z=(i-graphWidth/2)/(graphWidth/6);
				if (z>=cutoff){
					ctx.moveTo(i+leftStop,h-bottomStop);
					ctx.lineTo(i+leftStop,h-bottomStop-2*H*normalpdf(z));//h-Math.ceil(H*normalpdf(z)));
				}	
			}
			ctx.stroke();
		}		
		
		if (highlight!=null){
			if (hcolor!= null)
				ctx.strokeStyle=hcolor;
			else
				ctx.strokeStyle='blue';	
			z=(highlight-mean)/sd;
			i=z*(graphWidth/6)+graphWidth/2;
			ctx.beginPath();
			ctx.moveTo(i+leftStop, h-bottomStop);
			ctx.lineTo(i+leftStop,h-bottomStop-2*H*normalpdf(z));
			ctx.stroke();
		}
		//labels
		ctx.fillStyle='black';
		var theLabel;
		for (j=-3;j<=3;j++){
			theLabel=mean+j*sd;
			ctx.save();
			ctx.translate(graphWidth/2+j*graphWidth/6+leftStop-4, h-bottomStop+2);
			ctx.rotate(PI/2);
			ctx.fillText((theLabel).TOFIXED(2),0,0);
			ctx.restore();
			
		}		
	}

	function calculateNormalDistribution(){
	try{
		var m=eval(normalm.value);
		var s=eval(normals.value);
		var a=eval(normala.value);
		var b=eval(normalb.value);

		if (!(s>0))
			alert('The standard deviation should be greater than 0.');
		else{
			var z1=(a-m)/s;
			var z2=(b-m)/s;
			if(nmiddle.checked)
				normalanswer.innerHTML='Probability='+normalcdf(z1,z2).TOFIXED(printPrecision);
			else if (nleft.checked){
				normalanswer.innerHTML='Probability='+(normalcdf(z2)).TOFIXED(printPrecision);
				a=m-9*s;
			}	
			else {
				normalanswer.innerHTML='Probability='+(1-normalcdf(z1)).TOFIXED(printPrecision);
				b=m+9*s
			}
			
//			normalanswer.innerHTML='Probability='+normalcdf(z1,z2).TOFIXED(printPrecision);
drawBellSummary(normalcanvas, m, s, a, b, null, 'lightgray', 'black', 'lightgray', 'gray')
			normalAnswerDiv.style.display='block';
		}
		
	}
	catch(err){
		alert('Input Error.');
	}	
		}
	</script>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='invnormalCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Inverse Normal</button></li>
	<div id='invnormalCalcDiv' class='expandable'>
	<table>
	<tr><td>Mean: 			</td> <td><b>&mu;=</b> </td><td><input type='text' id='invnormalm' value="0" onkeydown='purge(invnormAnswerDiv);'></td></tr>
	<tr><td>Standard Deviation:  	</td> <td><b>&sigma;=</b></td><td><input type='text' id='invnormals' value="1" onkeydown='purge(invnormAnswerDiv);'></td></tr>
	<tr><td><b></td><td>Area: </td><td><input type='text' id='invnormarea' value=".05" onkeydown='purge(invnormAnswerDiv);'></td></tr>
	</table>
	<table>
	<tr><td>
	<input type='radio' name='invnormtype' id='invnormleft' checked=true onclick='purge(invnormAnswerDiv);'><label for='invnormleft'>Left Tail</label>
	<input type='radio' name='invnormtype' id='invnormmiddle' onclick='purge(invnormAnswerDiv);'><label for='invnormmiddle'>Middle</label>
	<input type='radio' name='invnormtype' id='invnormright' onclick='purge(invnormAnswerDiv);'><label for='invnormright'>Right Tail</label>
	</td></tr>
	</tr></table>
	<button onclick="calculateInverseNormalDistribution();">Calculate</button><br>
	<div id='invnormAnswerDiv' class='answerDiv'>
	<span id="invnormanswer"></span><br><canvas id='invnormalcanvas' width="400" height="200"></canvas>
	</div>
	</div>
	<script>

	function calculateInverseNormalDistribution(){
	try{
		var m=eval(invnormalm.value);
		var s=eval(invnormals.value);
		var a=eval(invnormarea.value);
		var i,z1,z2;

		if (!(s>0))
			alert('The standard deviation should be greater than 0;');
		else if (!((0<a) && (a<1)))
			alert('The area should be between 0 and 1.');
		else{
			if (invnormright.checked)
				a=1-a;
			else if (invnormmiddle.checked)
				a=(1-a)/2;
			var z=invnorm(a);
			var left=m-s*abs(z);
			var right=m+s*abs(z);
			if  (invnormmiddle.checked)
				invnormanswer.innerHTML='P('+(m-s*abs(z)).TOFIXED(printPrecision)+' &lt; x &lt; '+(m+s*abs(z)).TOFIXED(printPrecision)+')&nbsp;=&nbsp;'+invnormarea.value;
			else if (invnormleft.checked){
				invnormanswer.innerHTML='P( x &lt;&nbsp;'+(m+s*z).TOFIXED(printPrecision)+')&nbsp;=&nbsp;'+invnormarea.value;
				left=m-9*s;
				right=m+s*z;
			}
			else{
				invnormanswer.innerHTML='P('+(m+s*z).TOFIXED(printPrecision)+' &lt; x)&nbsp;=&nbsp;'+invnormarea.value;
				left=m+s*z;
				right=m+9*s;
			}	
drawBellSummary(invnormalcanvas, m, s, left, right, null, 'lightgray', 'black', 'lightgray', 'gray')				
		
				invnormAnswerDiv.style.display='block';
			}
		}

	catch(err){
		alert('Input Error.');
	}	
		}
	</script>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='tCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,invtCalcDiv,chi2CalcDiv,invchi2CalcDiv'>t</button></li>
	<div id='tCalcDiv' class='expandable'>
	<table>
	<tr><td>Mean: 			</td> <td><b>&mu;=</b> </td><td><input type='text' id='tm' value="0" onkeydown='purge(tAnswerDiv);'></td></tr>
	<tr><td>Standard Deviation:  	</td> <td><b>&sigma;=</b></td><td><input type='text' id='ts' value="1" onkeydown='purge(tAnswerDiv);'></td></tr>
	<tr><td>Degrees of Freedom:  	</td> <td><b>df=</b></td><td><input type='text' id='tdf' value="10" onkeydown='purge(tAnswerDiv);'></td></tr>
	</table>
	<table>
	<tr><td>Area on:
	<input type='radio' name='ttype' id='tleft'  onclick='showinline(trightspan);purge(tleftspan);purge(tAnswerDiv);'><label for='tleft'>Left</label>
	<input type='radio' name='ttype' id='tmiddle' onclick='showinline(trightspan);showinline(tleftspan);purge(tAnswerDiv);' checked=true ><label for='tmiddle'>Middle</label>
	<input type='radio' name='ttype' id='tright' onclick='purge(trightspan);showinline(tleftspan);purge(tAnswerDiv);'><label for='tright'>Right</label>	
	</td></tr>
	<tr><td><b>P(</b> <span id='tleftspan'> <input type='text' id='ta' value="-1" onkeydown='purge(tAnswerDiv);'> &lt;</span>
		<b>x</b> 
		<span id='trightspan'> &lt; <input type='text' id='tb' value="1" onkeydown='purge(tAnswerDiv);'></span> <b>)</b></td>
	</tr>
	</table>
	<button onclick="calculateTDistribution();">Calculate</button><br>
	<div id='tAnswerDiv' class='answerDiv'>
	<span id="tanswer"></span><br>
	<canvas id='tcanvas' width="400" height="200"></canvas>
	</div>
	</div>
<script>
	function showinline(a){
		a.style.display='inline-block';
	}
	function hideinline(a){
		a.style.display='none';	
	}
	function calculateTDistribution(){
	try{
		var m=eval(tm.value);
		var s=eval(ts.value);
		var a=eval(ta.value);
		var df=eval(tdf.value);
		var b=eval(tb.value);

		if (!(s>0))
			alert('The standard deviation should be greater than 0.');
		else{
			var z1=(a-m)/s;
			var z2=(b-m)/s;
			
			if(tmiddle.checked)
				tanswer.innerHTML='Probability='+tcdf(z1,z2,df).TOFIXED(printPrecision);
			else if (tleft.checked){
				tanswer.innerHTML='Probability='+(tcdf(z2,df)).TOFIXED(printPrecision);
				a=m-9*s;
			}	
			else {
				tanswer.innerHTML='Probability='+(1-tcdf(z1,df)).TOFIXED(printPrecision);
				b=m+9*s;
			}
			tAnswerDiv.style.display='block';
			}
drawBellSummary(tcanvas, m, s, a, b, null, 'lightgray', 'black', 'lightgray', 'gray')			
			tAnswerDiv.style.display='block';
//=========================

	}
	
	catch(err){
		alert('Input Error.');
	}	
		}
</script>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='invtCalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,chi2CalcDiv,invchi2CalcDiv'>Inverse t</button></li>
	<div id='invtCalcDiv' class='expandable'>
	<table>
	<tr><td>Mean: 			</td> <td><b>&mu;=</b> </td><td><input type='text' id='invtm' value="0" onkeydown='purge(invtAnswerDiv);'></td></tr>
	<tr><td>Standard Deviation:  	</td> <td><b>&sigma;=</b></td><td><input type='text' id='invts' value="1" onkeydown='purge(invtAnswerDiv);'></td></tr>
	<tr><td>Degrees of Freedom:  	</td> <td><b>df=</b></td><td><input type='text' id='invtdf' value="10" onkeydown='purge(invtAnswerDiv);'></td></tr>
	<tr><td><b></td><td>Area: </td><td><input type='text' id='invtarea' value=".05" onkeydown='purge(invtAnswerDiv);'></td></tr>
	</table>
	<table>
	<tr><td>
	<input type='radio' name='invttype' id='invtleft' checked=true  onclick='purge(invtAnswerDiv);'><label for='invtleft'>Left Tail</label>
	<input type='radio' name='invttype' id='invtmiddle' onclick='purge(invtAnswerDiv);'><label for='invtmiddle'>Middle</label>
	<input type='radio' name='invttype' id='invtright' onclick='purge(invtAnswerDiv);'><label for='invtright'>Right Tail</label>
	</td></tr>
	</tr></table>
	<button onclick="calculateInverseTDistribution();">Calculate</button><br>
	<div id='invtAnswerDiv' class='answerDiv'>
	<span id="invtanswer"></span><br><canvas id='invtcanvas' width="400" height="200"></canvas>
	</div>
	</div>

	<script>

	function calculateInverseTDistribution(){
	try{
		var m=eval(invtm.value);
		var s=eval(invts.value);
		var df=eval(invtdf.value);
		var a=eval(invtarea.value);
		var i,z1,z2;

		if (!(s>0))
			alert('The standard deviation should be greater than 0;');
		else if (!((0<a) && (a<1)))
			alert('The area should be between 0 and 1.');
		else{
			if (invtright.checked)
				a=1-a;
			else if (invtmiddle.checked)
				a=(1-a)/2;
			var z=invt(a,df); 
			
			var left=m-s*abs(z);
			var right=m+s*abs(z);
			if  (invtmiddle.checked)
				invtanswer.innerHTML='P('+(m-s*abs(z)).TOFIXED(printPrecision)+' &lt; x &lt; '+(m+s*abs(z)).TOFIXED(printPrecision)+')&nbsp;=&nbsp;'+invtarea.value;
			else if (invtleft.checked){
				invtanswer.innerHTML='P( x &lt;&nbsp;'+(m+s*z).TOFIXED(printPrecision)+')&nbsp;=&nbsp;'+invtarea.value;
				left=m-9*s;
				right=m+s*z;
			}
			else{
				invtanswer.innerHTML='P('+(m+s*z).TOFIXED(printPrecision)+' &lt; x)&nbsp;=&nbsp;'+invtarea.value;
				left=m+s*z;
				right=m+9*s;
			}

drawBellSummary(invtcanvas, m, s, left, right, null, 'lightgray', 'black', 'lightgray', 'gray')			
				invtAnswerDiv.style.display='block';
			}
		}

	catch(err){
		alert('Input Error.');
	}	
		}
	</script>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='chi2CalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,invchi2CalcDiv'>&chi;<sup>2</sup></button></li>
	<div id='chi2CalcDiv' class='expandable'>
	<table>
	<tr><td>Degrees of Freedom:  	</td> <td><b>df=</b></td><td><input type='text' id='chi2df' value="10" onkeydown='purge(chi2AnswerDiv);'></td></tr>
	<tr><td><b>P(</b> <input type='text' id='chi2a' value="0" onkeydown='purge(chi2AnswerDiv);'> </td><td>&lt; x &lt; </td><td><input type='text' id='chi2b' value="10" onkeydown='purge(chi2AnswerDiv);'><b>)</b></td>
	</tr>
	</table>
	<button onclick="calculateChi2Distribution();">Calculate</button><br>
	<div id='chi2AnswerDiv' class='answerDiv'>
	<span id="chi2answer"></span><br>
	<canvas id='chi2canvas' width="400" height="200"></canvas>
	</div>
	</div>
<script>

	function calculateChi2Distribution(){
	try{
		var a=eval(chi2a.value);
		var df=eval(chi2df.value);
		var b=eval(chi2b.value);
			{
			chi2answer.innerHTML='Probability='+(chi2cdf(b,df)-chi2cdf(a,df)).TOFIXED(printPrecision);
			chi2AnswerDiv.style.display='block';
			}
drawChiSummary(chi2canvas,a, b, df);			
			chi2AnswerDiv.style.display='block';
//=========================

	}
	
	catch(err){
		alert('Input Error.');
	}	
		}
function drawChiSummary(cvs,a, b, df){ console.log(a,b,df);
			var ctx=cvs.getContext('2d');
			var w=cvs.width;
			var h=cvs.height;
			var i,z;
			var M;
			var leftStop=10;
			var graphWidth=w-2*leftStop;
			var bottomStop=40;
			var H=0.9*(h-bottomStop);
			
			if (df>2) M=chi2pdf(df-2, df);
			else M=0.5;
			ctx.strokeStyle='gray';
			ctx.fillStyle='white';
			ctx.lineWidth=1;
			ctx.fillRect(0,0,w,h);
			ctx.beginPath();
			for (i=0;i<=graphWidth;i++){ 
				ctx.moveTo(i+leftStop,h-bottomStop);
				z=(i)*(3*df)/graphWidth; 
				ctx.lineTo(i+leftStop,h-Math.ceil(H*chi2pdf(z,df)/M)-bottomStop);
			}
			ctx.stroke();

			ctx.strokeStyle='black';
			ctx.beginPath();
			for (i=0;i<=w;i++){
				ctx.moveTo(i+leftStop,h-bottomStop);
				z=(i)*(3*df)/graphWidth;
				if ((a<=z) && (z<=b))
					ctx.lineTo(i+leftStop,h-Math.ceil(H*chi2pdf(z,df)/M)-bottomStop);
			}
			ctx.stroke();
		//labels
		ctx.fillStyle='black';
		var theLabel;
		var dx=graphWidth/10;
		for (j=0;j<=10;j++){
			theLabel=(j*dx)*(3*df)/graphWidth;
			ctx.save();
			ctx.translate(j*dx+leftStop-4, h-bottomStop+2);
			ctx.rotate(PI/2);
			ctx.fillText((theLabel).TOFIXED(2),0,0);
			ctx.restore();
			
		}			
			
}
</script>

<!--------------------------------------------------------------------------------------------------------------------------------------------->
<!--li><button class='expander' data-open='invchi2CalcDiv' data-close='binomialCalcDiv,poissonCalcDiv,normalCalcDiv,invnormalCalcDiv,tCalcDiv,invtCalcDiv,chi2CalcDiv'>Inverse &chi;<sup>2</sup></button></li-->
	<div id='invchi2CalcDiv' class='expandable'>
	<table>
	<tr><td>Degrees of Freedom:  	</td> <td><b>df=</b></td><td><input type='text' id='invchi2df' value="10" onkeydown='purge(invchi2AnswerDiv);'></td></tr>
	<tr><td>
	<input type='radio' name='invchitype' id='invchi2left' checked=true onclick='purge(invchi2AnswerDiv);'><label for='invchi2left'>Left Tail</label>
	<input type='radio' name='invchitype' id='invchi2middle' onclick='purge(invchi2AnswerDiv);'><label for='invchi2middle'>Middle</label>
	<input type='radio' name='invchitype' id='invchi2right' onclick='purge(invchi2AnswerDiv);'><label for='invchi2right'>Right Tail</label>
	</td></tr>
	<tr><td><b></td><td>Area: </td><td><input type='text' id='invchi2area' value=".05" onkeydown='purge(invchi2AnswerDiv);'></td></tr>
	</tr></table>
	<button onclick="calculateInverseChi2Distribution();">Calculate</button><br>
	<div id='invchi2AnswerDiv' class='answerDiv'>
	<span id="invchi2answer"></span><br><canvas id='invchi2canvas' width="400" height="200"></canvas>
	</div>
	</div>

	<script>

	function calculateInverseChi2Distribution(){
	try{
		var df=eval(invchi2df.value);
		var a=eval(invchi2area.value);
		var i,z1,z2;
		var left, right;

		if (!((0<a) && (a<1)))
			alert('The area should be between 0 and 1.');
		else{
			if (invchi2right.checked){
				a=1-a;
				left=invchi2(a, df);
				right=Infinity;
			}	
			else if (invchi2middle.checked){
				a=(1-a)/2;
				left=invchi2(a, df);
				right=invchi2(1-a, df);
			}	
			else{
				left=0;
				right=invchi2(a, df);
			}
			if  (invchi2middle.checked)
				invchi2answer.innerHTML='P('+(left).TOFIXED(printPrecision)+' &lt; x &lt; '+(right).TOFIXED(printPrecision)+')&nbsp;=&nbsp;'+invchi2area.value;
			else if (invchi2left.checked)
				invchi2answer.innerHTML='P( x &lt;&nbsp;'+(right).TOFIXED(printPrecision)+')&nbsp;=&nbsp;'+invchi2area.value;
			else
				invchi2answer.innerHTML='P('+(left).TOFIXED(printPrecision)+' &lt; x)&nbsp;=&nbsp;'+invchi2area.value;
			
//			invchi2answer.innerHTML=''+(left).TOFIXED(printPrecision)+' to '+(right).TOFIXED(printPrecision);

			invchi2AnswerDiv.style.display='block';
		}	
//=========================
		}

	catch(err){
		alert('Input Error.');
	}	
		}
	</script>
<!--------------------------------------------------------------------------------------------------------------------------------------------->
</ul>
</div>
</div> <!--distribution div--> 
<!--distribution calculators--------------------------------------->


<!--intervals-------------------------------------------------------->
<div id='intervalsDiv' class='pageDiv expandable'>

<div class='pageMenu'>
<button class='expander' data-open='ParametricIntervalsDiv' data-close='BootstrapIntervalsDiv'>Parametric Intervals</button>
<span class='special'>
<button class='expander' data-open='BootstrapIntervalsDiv' data-close='ParametricIntervalsDiv'>Bootstrap Intervals</button>
</span>
</div>

<div class='subPage'>

<div id='ParametricIntervalsDiv' class='expandable'>
<h4>Parametric Intervals</h3>
<ul>

<!------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='propIntervalDiv' data-close='matchedIntervalDiv,meanIntervalDiv,twopropIntervalDiv,twomeanIntervalDiv'>Z-Interval for One Proportion</button></li>

	<div id='propIntervalDiv' class='expandable'>
	<table>
	<tr><td>Successes:</td> <td>x=</td><td><input type='text' id='pintervalx' value="10" onkeydown='purge(pintervalanswerDIV);' onchange='copyThisTo(this,propx);'></td></tr>
	<tr><td>Sample Size:</td><td>n=</td><td><input type='text' id='pintervaln' value="100" onkeydown='purge(pintervalanswerDIV);' onchange='copyThisTo(this,propn);'></td></tr>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='pintervalcl' value="0.95" onclick='purge(pintervalanswerDIV);'></td></tr>
	</table>
<div class='intervalOptions'>	
	<label><input type='radio' name='propinttype' id='propintlt' onclick='purge(pintervalanswerDIV);'>Left Tail</label> 
	<label><input type='radio' name='propinttype' id='propintne' checked=true onclick='purge(pintervalanswerDIV);'>Two Tailed</label>
	<label><input type='radio' name='propinttype' id='propintgt'  onclick='purge(pintervalanswerDIV);'>Right Tail</label><br>
</div>	
	<button onclick='CalculatePInterval();'>Calculate</button>
	<div id='pintervalanswerDIV' class='answerDiv'> 
	<div id='pintervalanswer' ></div>
	<!--canvas id='pintervalcanvas' width="400" height="200"></canvas-->
	</div>
		</div>
	<script>
	function CalculatePInterval(){
	try{
		var x=eval(pintervalx.value);
		var n=eval(pintervaln.value);
		var cl=eval(pintervalcl.value);
		var a=1-cl;
		var z, p,e;
		if (!(n>0))
			alert('The sample size should be greater than 0.');
		else if(!(x>0))
			alert('The number of successes should be greater than 0.');
		else if (!(x<n))
			alert('The number of successes should be less than the sample size.');
		else if (!((0<cl) && (cl<1)))
			alert('The confidence level should be between 0 and 1.');
		else {
			p=x/n;
			if (propintlt.checked){
				z=abs(invnorm(a));
				e=z*sqrt(p*(1-p)/n);
				pintervalanswer.innerHTML='<ul><li>'+(p-e).TOFIXED(printPrecision)+' &lt; p &lt; 1</li><li>Point Estimate: '+(x/n).TOFIXED(printPrecision)+'</li></ul>';			
			}
			else if (propintgt.checked){
				z=abs(invnorm(a));
				e=z*sqrt(p*(1-p)/n);
				pintervalanswer.innerHTML='<ul><li>'+'0 &lt; p &lt; '+(p+e).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(x/n).TOFIXED(printPrecision)+'</li></ul>';						
			}
			else{
				z=abs(invnorm(a/2));
				e=z*sqrt(p*(1-p)/n);
				pintervalanswer.innerHTML='<ul><li>'+(p-e).TOFIXED(printPrecision)+' &lt; p &lt; '+(p+e).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(x/n).TOFIXED(printPrecision)+'</li><li>E: '+e.TOFIXED(printPrecision)
				+'</li><li>z: '+z.TOFIXED(printPrecision)+'</li><li>SE: '+(sqrt(p*(1-p)/n)).TOFIXED(printPrecision)+'</li></ul>';
				//drawBellSummary(pintervalcanvas, p, sqrt(p*(1-p)/n), p-e, p+e, null, 'lightgray', 'black', 'lightgray', null);
			}
			pintervalanswerDIV.style.display='block';
		}
	}
	catch(err){
		alert('Input Error.');
	}	
	}
	</script>		
<!------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='meanIntervalDiv' data-close='matchedIntervalDiv,propIntervalDiv,twopropIntervalDiv,twomeanIntervalDiv'>T-Interval for one Mean</button></li>

	<div id='meanIntervalDiv' class='expandable'>
	<table>
	<tr><td>Sample Mean:</td><td>x&#772;=</td><td><input type='text' id='tintervalssm' value="100" onkeydown='purge(tintervalssanswer);' onchange='copyThisTo(this, ttestssm);'></td></tr>
	<tr><td>Standard Deviation:</td> <td>s=</td><td><input type='text' id='tintervalsss' value="10" onkeydown='purge(tintervalssanswer);'  onchange='copyThisTo(this, ttestsss);'></td></tr>
	<tr><td>Sample Size:</td><td>n=</td><td><input type='text' id='tintervalssn' value="100" onkeydown='purge(tintervalssanswer);'  onchange='copyThisTo(this, ttestssn);'></td></tr>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='mintervalcl' value="0.95" onclick='purge(tintervalssanswer);'></td></tr>
	</table>
<div class='intervalOptions'>	
	<label><input type='radio' name='tinttype' id='tintlt' onclick='purge(tintervalssanswer);'>Left Tail</label> 
	<label><input type='radio' name='tinttype' id='tintne' checked=true onclick='purge(tintervalssanswer);'>Two Tailed</label>
	<label><input type='radio' name='tinttype' id='tintgt'  onclick='purge(tintervalssanswer);'>Right Tail</label><br>
</div>	
	<button class='expander' data-open='populateTIntervalStatsDiv' data-close='tintervalssanswer'>Select Data List</button><br>
	<div id='populateTIntervalStatsDiv' class='expandable'> 
		Data List: <br><script>printRadioList('interval');
	var a=document.getElementsByClassName('interval'+'radio');
	a[0].checked=true;</script><br>
		<button onclick='populateTIntervalStats();' >Populate Summary Stats</button><br>
	</div>
	<button onclick='CalculateTIntervalFromSummaryStatistics();' >Calculate</button>
	<div id='tintervalssanswer' class='answerDiv'></div>
	</div>
	<script>
	function copyThisTo(a,b){
		b.value=a.value;
	}
	function CalculateTIntervalFromSummaryStatistics(){
	try{
		var m=eval(tintervalssm.value); 
		var s=eval(tintervalsss.value);
		var n=eval(tintervalssn.value);
		var cl=eval(mintervalcl.value);
		var a=1-cl;
		var t, e;
		if (isNaN(m*s*n*cl)) alert('Input Error.');
		else if (!(n>0))
			alert('The sample size should be greater than 0.');
		else if (!(s>0))
			alert('The standard deviation should be greater than 0.');
		else if (!((0<cl) && (cl<1)))
			alert('The confidence level should be between 0 and 1.');
		else{
			if (tintlt.checked){
				t=abs(invt(a, n-1));
				e=t*s/sqrt(n);
				tintervalssanswer.innerHTML='<ul><li>'+(m-e).TOFIXED(printPrecision)+' &lt; &mu;'+'</li><li>Point Estimate: '+(m).TOFIXED(printPrecision)+'</li></ul>';			
			}
			else if(tintgt.checked){
				t=abs(invt(a, n-1));
				e=t*s/sqrt(n);
				tintervalssanswer.innerHTML='<ul><li>'+'&mu; &lt; '+(m+e).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(m).TOFIXED(printPrecision)+'</li></ul>';						
			}
			else{
				t=abs(invt(a/2, n-1));
				e=t*s/sqrt(n);
				tintervalssanswer.innerHTML='<ul><li>'+(m-e).TOFIXED(printPrecision)+' &lt; &mu; &lt; '+(m+e).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(m).TOFIXED(printPrecision)+'</li><li>E: '+e.TOFIXED(printPrecision)
				+'</li><li>df: '+(n-1)+'</li><li>t: '+t.TOFIXED(printPrecision)+'</li><li>SE: '+(s/sqrt(n)).TOFIXED(printPrecision)+'</li></ul>';
			}
			tintervalssanswer.style.display='block';
		}
	}
	catch(err){
		alert('Input Error.');
	}	
	}

	function populateTIntervalStats(){
		var inlist=0;
		var i;
		inlist=getChecked('interval');
		if (listN[inlist]>0){
			tintervalssm.value=listM[inlist].TOFIXED(printPrecision);
			tintervalsss.value=listS[inlist].TOFIXED(printPrecision);
			tintervalssn.value=listN[inlist].TOFIXED(printPrecision);
			ttestssm.value=listM[inlist].TOFIXED(printPrecision);
			ttestsss.value=listS[inlist].TOFIXED(printPrecision);
			ttestssn.value=listN[inlist].TOFIXED(printPrecision);			
			populateTIntervalStatsDiv.style.display='none';
		}
		else alert('That list is empty.');
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='twopropIntervalDiv' data-close='matchedIntervalDiv,meanIntervalDiv,propIntervalDiv,twomeanIntervalDiv'>Z- Interval for Two Proportions</button></li>

	<div id='twopropIntervalDiv' class='expandable'>
	<table border=1>
	<tr><th>Sample 1</th><th>Sample 2</th></tr>
	<tr><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>1</sub>=</td><td><input type='text' id='twopropintx1' value="45" onkeydown='purge(twopropintanswer);' onchange='copyThisTo(this, twopropx1);'></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>1</sub>=</td><td><input type='text' id='twopropintn1' value="100" onkeydown='purge(twopropintanswer);' onchange='copyThisTo(this, twopropn1);'></td></tr>
	</table>
	</td><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>2</sub>=</td><td><input type='text' id='twopropintx2' value="50" onkeydown='purge(twopropintanswer);' onchange='copyThisTo(this, twopropx2);'></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>2</sub>=</td><td><input type='text' id='twopropintn2' value="100" onkeydown='purge(twopropintanswer);' onchange='copyThisTo(this, twopropn2);'></td></tr>
	</table>
	</td><tr>
	</table>
	<table>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='twopropintervalcl' value="0.95" onclick='purge(twopropintanswer);'></td></tr>	
	</table>
<div class='intervalOptions'>
	<label><input type='radio' name='twopropinttype' id='twopropintlt' onclick='purge(twopropintanswer);'>Left Tail</label> 
	<label><input type='radio' name='twopropinttype' id='twopropintne' checked=true onclick='purge(twopropintanswer);'>Two Tailed</label>
	<label><input type='radio' name='twopropinttype' id='twopropintgt'  onclick='purge(twopropintanswer);'>Right Tail</label><br>
</div>
	<button onclick='CalculateTwoPropInterval();'>Calculate</button>
	<div id='twopropintanswer' class='answerDiv expandable' ></div>
	</div>
	<script>
	function CalculateTwoPropInterval(){
	try{
		var i,n1,p,p1hat,x1,n2,p2hat,x2,q;
		var z,z1,z2,cl,a,e,sd;
		
		n1=eval(twopropintn1.value);
		x1=round(eval(twopropintx1.value));
		n2=eval(twopropintn2.value);
		x2=round(eval(twopropintx2.value));
		cl=eval(twopropintervalcl.value);
		a=1-cl;
		
		if (!(n1>0) || !(n2>0)) alert('The sample size should be positive.');
		else if (!(x1>0) || !(x2>0)) alert('The number of successes should be positive.');
		else
		{ 
			p1hat=x1/n1;
			p2hat=x2/n2;
			p=(x1+x2)/(n1+n2);
			q=1-p;
			sd=sqrt(p1hat*(1-p1hat)/n1+p2hat*(1-p2hat)/n2);		

			if (twopropintlt.checked){ 
				z=-invnorm(a); 
				e=z*sd;
				twopropintanswer.innerHTML='<ul><li>'+((p1hat-p2hat)-e).TOFIXED(printPrecision) + '&lt; p<sub>1</sub>-p<sub>2</sub>&leq; 1'+'</li></ul>';
				}

			else if (twopropintgt.checked){
				z=-invnorm(a); 
				e=z*sd;
				twopropintanswer.innerHTML='<ul><li>'+'-1 &lt; p<sub>1</sub>-p<sub>2</sub>&leq;'+((p1hat-p2hat)+e).TOFIXED(printPrecision)+'</li></ul>';
				}
			else{
				z=-invnorm(a/2); 
				e=z*sd;
				twopropintanswer.innerHTML='<ul><li>'+((p1hat-p2hat)-e).TOFIXED(printPrecision) + '&lt; p<sub>1</sub>-p<sub>2</sub>&leq;'+((p1hat-p2hat)+e).TOFIXED(printPrecision)+'</li>'+
				'<li>Point Estimate: '+(p1hat-p2hat).TOFIXED(printPrecision)+'</li>'+
				'<li> E: '+(e).TOFIXED(printPrecision)+'</li>'+
				'<li> z: '+(z).TOFIXED(printPrecision)+'</li>'+'</ul>';
				}				
//			twopropintanswer.innerHTML='P='+p.TOFIXED(printPrecision)+'<br>z='+z.TOFIXED(printPrecision);
			twopropintanswer.style.display='block';
		}
	}
	catch(err){
		alert('Input Error.');
	}		
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='twomeanIntervalDiv' data-close='matchedIntervalDiv,meanIntervalDiv,propIntervalDiv,twopropIntervalDiv'>T-Interval for Two Independent Means</button></li>

	<div id='twomeanIntervalDiv' class='expandable'>

<table border=1>
<tr><th>Sample 1</th><th>Sample 2</th></tr>
<tr><td>
<table>
<tr><td>Sample Mean:</td><td><font style='text-decoration: overline;'>X</font><sub>1</sub>=</td>	<td><input type='text' id='t2intssm1' value="100" onkeydown='purge(t2intssanswer);' onchange='copyThisTo(this,t2testssm1);'></td></tr>
<tr><td>Standard Deviation:</td> <td>s<sub>1</sub>=</td>									<td><input type='text' id='t2intsss1' value="10" onkeydown='purge(t2intssanswer);' onchange='copyThisTo(this,t2testsss1);'></td></tr>
<tr><td>Sample Size:</td><td>n<sub>1</sub>=</td>										<td><input type='text' id='t2intssn1' value="100" onkeydown='purge(t2intssanswer);' onchange='copyThisTo(this,t2testssn1);'></td></tr>
</table>
	<button class='expander' data-open='meanInterval2LeftDataListDiv' data-close='t2intssanswer'>Select Data List</button><br>
	<div id='meanInterval2LeftDataListDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('meanint2left');
	var a=document.getElementsByClassName('meanint2left'+'radio');
	a[0].checked=true;</script><br>
	<button onclick='populateMeanInt2Stats(1);' >Populate Summary Stats</button><br>
	</div>		

</td><td>
<table>
<tr><td>Sample Mean:</td><td><font style='text-decoration: overline;'>X</font><sub>2</sub>=</td>	<td><input type='text' id='t2intssm2' value="100" onkeydown='purge(t2intssanswer);' onchange='copyThisTo(this,t2testssm2);'></td></tr>
<tr><td>Standard Deviation:</td> <td>s<sub>2</sub>=</td>									<td><input type='text' id='t2intsss2' value="10" onkeydown='purge(t2intssanswer);' onchange='copyThisTo(this,t2testsss2);'></td></tr>
<tr><td>Sample Size:</td><td>n<sub>2</sub>=</td>										<td><input type='text' id='t2intssn2' value="100" onkeydown='purge(t2intssanswer);' onchange='copyThisTo(this,t2testssn2);'></td></tr>
</table>
	<button class='expander' data-open='meanInterval2RightDataListDiv' data-close='t2intssanswer'>Select Data List</button><br>
	<div id='meanInterval2RightDataListDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('meanint2right');
	var a=document.getElementsByClassName('meanint2right'+'radio');
	a[1].checked=true;</script><br>
	<button onclick='populateMeanInt2Stats(2);' >Populate Summary Stats</button><br>
	</div>
</td><tr>
</table>
	<table>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='t2intervalcl' value="0.95" onclick='purge(t2intssanswer);'></td></tr>	
	</table>
<div class='intervalOptions'>
<label><input type='radio' name='t2intsstype' id='t2intsslt' onclick='purge(t2intssanswer);'>Left Tail</label>
<label><input type='radio' name='t2intsstype' id='t2intssne' checked=true onclick='purge(t2intssanswer);'>Two Tails</label>
<label><input type='radio' name='t2intsstype' id='t2intssgt' onclick='purge(t2intssanswer);'>Right Tail</label>
<br>
</div>

<button onclick='CalculateT2IntervalFromSummaryStatistics();'>Calculate</button>
<div id='t2intssanswer' class='answerDiv'></div>

	</div>

<script>

function CalculateT2IntervalFromSummaryStatistics(){
try{
	var m1=eval(t2intssm1.value);
	var s1=eval(t2intsss1.value);
	var n1=eval(t2intssn1.value);
	var m2=eval(t2intssm2.value);
	var s2=eval(t2intsss2.value);
	var n2=eval(t2intssn2.value);
	var cl=eval(t2intervalcl.value);
	var alpha=1-cl;
	
	if (isNaN(m1*s1*n1*m2*s2*n2)) alert('Input Error.');
	else if (!(n1>0) || !(n2>0)) alert('The sample size should be positive');
	else if (!(s1>0) || !(s2>0)) alert('The standard deviation should be positive');
	else{
		var m=m1-m2;
		var hm=0;
		var a=s1*s1/n1;
		var b=s2*s2/n2;
		var n=(((a+b)*(a+b)/((a*a/(n1-1))+(b*b/(n2-1))))+1);
		var df=n-1;
		var s=sqrt(((s1*s1/n1)+(s2*s2/n2)));

		var z,e;
		if (t2intsslt.checked){
			z=abs(invt(alpha, df));
			e=z*s;
			t2intssanswer.innerHTML='<ul><li>'+(m-e).TOFIXED(printPrecision)+'&lt; &mu;<sub>1</sub>-&mu;<sub>2</sub>'+'</li></ul>';
		}
		else if (t2intssgt.checked){
			z=abs(invt(alpha, df));
			e=z*s;
			t2intssanswer.innerHTML='<ul><li>'+'&mu;<sub>1</sub>-&mu;<sub>2</sub>&lt;'+(m+e).TOFIXED(printPrecision)+'</li></ul>';		
		}
		else{
			z=abs(invt(alpha/2, df));
			e=z*s;
			t2intssanswer.innerHTML='<ul><li>'+(m-e).TOFIXED(printPrecision)+'&lt; &mu;<sub>1</sub>-&mu;<sub>2</sub>&lt;'+(m+e).TOFIXED(printPrecision)+'</li>'+
				'<li>Point Estimate: '+(m).TOFIXED(printPrecision)+'</li>'+
				'<li> E: '+(e).TOFIXED(printPrecision)+'</li>'+
				'<li> t: '+(z).TOFIXED(printPrecision)+'</li>'+
				'<li> df: '+(df).TOFIXED(printPrecision)+'</li>'+'</ul>';
		}
		t2intssanswer.style.display='block';
	}
	
}
catch(err){
	alert('Input Error.');
}	
}
	function populateMeanInt2Stats(d){
		var inlist=0;
		var i;
		if (d==1){
		inlist=getChecked('meanint2left');
			if (listN[inlist]==0) alert ('That list is empty.');
			else{
				t2intssm1.value=listM[inlist].TOFIXED(printPrecision);
				t2intsss1.value=listS[inlist].TOFIXED(printPrecision);
				t2intssn1.value=listN[inlist].TOFIXED(printPrecision);
				t2testssm1.value=listM[inlist].TOFIXED(printPrecision);
				t2testsss1.value=listS[inlist].TOFIXED(printPrecision);
				t2testssn1.value=listN[inlist].TOFIXED(printPrecision);
				meanInterval2LeftDataListDiv.style.display='none';
			}		
		}
		else{
			inlist=getChecked('meanint2right');
			if (listN[inlist]==0) alert ('That list is empty.');
			else{
				t2intssm2.value=listM[inlist];
				t2intsss2.value=listS[inlist];
				t2intssn2.value=listN[inlist];
				t2testssm2.value=listM[inlist];
				t2testsss2.value=listS[inlist];
				t2testssn2.value=listN[inlist];
				meanInterval2RightDataListDiv.style.display='none';
			}
		}
	}
</script>

<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='matchedIntervalDiv' data-close='propIntervalDiv,meanIntervalDiv,twopropIntervalDiv,twomeanIntervalDiv'>T-Interval for Matched Pairs</button></li>

	<div id='matchedIntervalDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('mpintradio1');
	var a=document.getElementsByClassName('mpintradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(mpintanswer);}
	</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('mpintradio2');
	var a=document.getElementsByClassName('mpintradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(mpintanswer);}
	</script></td></tr>
	</table>

	<table>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='mpintcl' value="0.95" onclick='purge(mpintanswer);'></td></tr>	
	</table>
<div class='intervalOptions'>
<label><input type='radio' name='mpinttype' id='mpintlt' onclick='purge(mpintanswer);'>Left Tail</label>
<label><input type='radio' name='mpinttype' id='mpintne' checked=true onclick='purge(mpintanswer);'>Two Tails</label>
<label><input type='radio' name='mpinttype' id='mpintgt' onclick='purge(mpintanswer);'>Right Tail</label>
<br>
</div>
<button onclick='CalculateMPInterval();'>Calculate</button>
<div id='mpintanswer' class='answerDiv'></div>
	</div>
	
<script>
function CalculateMPInterval(){
try{
	var i=getChecked('mpintradio1');
	var j=getChecked('mpintradio2');;
	var k;
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else if (listN[i]!=listN[j]) alert('Your lists need to be the same length.');
	else{	
		var a=[];
		for (k=0;k<listN[i];k++)
			a[k]=list[i][k]-list[j][k];
		var r=summarizeArray(a);

		var m=r.m;
		var cl=eval(mpintcl.value)
		var alpha=1-cl;
		var s=r.s; 
		var n=r.n;
		var df=n-1;
		var z,e;
		
		if (mpintlt.checked){
			z=abs(invt(alpha,df));
			e=z*s/sqrt(n);
			mpintanswer.innerHTML='<ul><li>'+(m-e).TOFIXED(printPrecision) + '&lt; &mu;<sub>d</sub> '+'</li></ul>';
		}
		else if (mpintgt.checked){
			z=abs(invt(alpha,df));
			e=z*s/sqrt(n);
			mpintanswer.innerHTML='<ul><li>'+'&mu;<sub>d</sub> &lt;'+(m+e).TOFIXED(printPrecision)+'</li></ul>';		
		}
		else{
			z=abs(invt(alpha/2,df));
			e=z*s/sqrt(n);
			mpintanswer.innerHTML='<ul><li>'+(m-e).TOFIXED(printPrecision) +'&lt; &mu;<sub>d</sub> &lt;'+(m+e).TOFIXED(printPrecision)+'</li>'+
				'<li>Point Estimate: '+(m).TOFIXED(printPrecision)+'</li>'+
				'<li> E: '+(e).TOFIXED(printPrecision)+'</li>'+
				'<li> t: '+(z).TOFIXED(printPrecision)+'</li>'+
				'<li> df: '+(df).TOFIXED(printPrecision)+'</li>'+'</ul>';		
		}
		mpintanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>
</ul></div>

<div id='BootstrapIntervalsDiv' class='expandable'>
<h4>Bootstrap Intervals</h3>
<ul>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='bootAbout' data-close='bootIntervalDiv,bootMPIntervalDiv,boot2MeanIntervalDiv,boot2PropIntervalDiv,bootPropIntervalDiv'>About</button></li>
<div id='bootAbout' class='expandable'>
<p>
For this approach to confidence intervals, the sample is assumed to be representative of the population. We draw 10,000 samples -- called bootstrap samples -- from the original sample with replacement. 
This simulates sampling from a sufficiently large population which has the same characteristics as the given sample. For each bootstrap sample, we calculate a mean, proportion, or difference. 
The bounds of the confidence interval are then found using percentiles of these 10,000 values. For each interval, we draw a histogram of the 10,000 values. In the histograms:
<ul>
<li>Red lines indicate the bounds of the confidence interval.</li>
<li>Green either indicates original data values or the statistic from the original sample.</li>
<li>For differences, a blue line indicates the location of 0.</li>
</ul>
</p>
</div>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='bootIntervalDiv' data-close='bootAbout,bootMPIntervalDiv,boot2MeanIntervalDiv,boot2PropIntervalDiv,bootPropIntervalDiv'>Intervals from One Sample</button></li>

	<div id='bootIntervalDiv' class='expandable'>
	Confidence Level: <input type='text' id='bintervalcl' value="0.95" onclick='purge(bootintervalssanswer);'><br>
	Data List: <br><script>printRadioList('bootinterval');
	var a=document.getElementsByClassName('bootinterval'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(bootintervalssanswer);}</script><br>
	<button onclick='calculateBootInterval();' >Calculate</button>
	<div id='bootintervalssanswer' class='answerDiv'>
	<div id='bootintervalactualssanswer' ></div>
	Histogram of sample means:<br>
	<canvas id="bootMeanIntervalCanvas" width=400 height=200></canvas><br>
	<!--canvas id="bootVarianceIntervalCanvas" width=400 height=400></canvas-->
	</div>
	</div>
	<script>
	function drawBootSummary(cvs, values, originals, highlights, colors,bounds){ 
		var ctx=cvs.getContext('2d');
		var w=cvs.width;
		var h=cvs.height;
		ctx.fillStyle='white';
		ctx.fillRect(0,0,w,h);	
		ctx.fillStyle='black';
		
//		var r=summarizeArray(values);
		var i,j,n;
		var Min=Infinity;
		var Max=-Infinity;
		for (i=0;i<values.length;i++){
			if (values[i]<Min) Min=values[i];
			if (values[i]>Max) Max=values[i];
		}
		for (i=0;i<originals.length;i++){
			if (originals[i]<Min) Min=originals[i];
			if (originals[i]>Max) Max=originals[i];
		}
		var binwidth=(Max-Min)/(w-20);
		var drawLowerBound=false, drawUpperBound=false, lowerBound, upperBound;
		if (bounds){
			if (bounds[0]){
				drawLowerBound=true;
				lowerBound=(bounds[0]-Min)/binwidth;
			}
			else lowerBound=0;
			if (bounds[1]){
				drawUpperBound=true;
				upperBound=(bounds[1]-Min)/binwidth;
			}
			else upperBound=w-20;
		}		
		//values histogram
		var c=[];
		for (i=0;i<=w-20;i++)
			c[i]=0;
		for (i=0;i<values.length;i++)
			c[floor((values[i]-Min)/binwidth)]++;
		var H=0;
		for (i=0;i<=w-20;i++)
			if (c[i]>H) H=c[i];
		if (drawLowerBound)
			ctx.strokeStyle='red';	
		else		
			ctx.strokeStyle='gray';	
		ctx.beginPath();
		for (i=0;i<=lowerBound;i++){
			ctx.moveTo(10+i,h-50 );
			ctx.lineTo(10+i, h-((h-60)*c[i]/H)-50);
		}		
		ctx.stroke();
		ctx.strokeStyle='gray';	
		ctx.beginPath();
		for (;i<upperBound;i++){
			ctx.moveTo(10+i,h-50 );
			ctx.lineTo(10+i, h-((h-60)*c[i]/H)-50);
		}		
		ctx.stroke();
		if (drawUpperBound)
			ctx.strokeStyle='red';	
		else		
			ctx.strokeStyle='gray';	
		ctx.beginPath();
		for (;i<=w-20;i++){
			ctx.moveTo(10+i,h-50 );
			ctx.lineTo(10+i, h-((h-60)*c[i]/H)-50);
		}		
		ctx.stroke();
		//originals histogram
		c=[];
		for (i=0;i<=w-20;i++)
			c[i]=0;
		for (i=0;i<values.length;i++)
			c[floor((originals[i]-Min)/binwidth)]++;
		var H=0;
		for (i=0;i<=w-20;i++)
			if (c[i]>H) H=c[i];
		ctx.strokeStyle='rgba(0, 255, 0, 0.5)';	
		ctx.beginPath();
		for (i=0;i<=w-20;i++){
			ctx.moveTo(10+i,h-50 );
			ctx.lineTo(10+i, h-((h-60)*c[i]/H)-50);
		}
		ctx.stroke();
		
		//labels
		var labelwidth=(Max-Min)/10;
		var dx=(w-20)/(10);
		for (j=0;j<=10;j++){
			ctx.save();
			ctx.translate(j*dx+10-4, h-40+2);
			ctx.rotate(PI/2);
			ctx.fillText((Min+j*labelwidth).TOFIXED(2),0,0);
			ctx.restore();
		}		
		if (highlights){
			for (i=0;i<highlights.length;i++){
				if ((colors) && (colors[i]))
					ctx.strokeStyle=colors[i];
				else
					ctx.strokeStyle='black';
				n=highlights[i];
				ctx.beginPath();
				ctx.moveTo((n-Min)/binwidth+10,0 );
				ctx.lineTo((n-Min)/binwidth+10, h-50);
				ctx.stroke();
			}
		}
	}	
	function calculateBootInterval(){
	try{
		var inlist=0;
		var i,j,r;
		var numSamples=globalNumSamples;
		var sortedArray;
		var lowerLimit, uperLimit, margin;
		var cl=eval(bintervalcl.value);
		var left=(1-cl)/2;
		var right=1-left;
		//for (i=0;i<intervalradios.length;i++)
		//	if (intervalradios[i].checked) inlist=i;
		inlist=getChecked('bootinterval');
		if (listN[inlist]>0){
			var n=listN[inlist];
			var sampleMeans=[];
			var sampleMedians=[];
			var sampleVariances=[];
			var sampleSDs=[];
			var sample=[];
			for (i=0;i<numSamples;i++){
				sample=[];
				for (j=0;j<n;j++)
					sample.push(list[inlist][floor(random()*n)]);
				r=summarizeArray(sample);
				sampleMeans.push(r.m);
				sampleMedians.push(r.q2);
				sampleVariances.push(r.s2);
				sampleSDs.push(r.s);
			}
			var lowerLimitMean, upperLimitMean;
			var lowerLimitVar, upperLimitVar;
			r=summarizeArray(list[inlist]);
			bootintervalactualssanswer.innerHTML='';
			sortedArray=sampleMeans.toSorted(function(a, b){return a - b});
			lowerLimitMean=percentileSorted(sortedArray, left);
			upperLimitMean=percentileSorted(sortedArray, right);
			margin=(upperLimitMean-lowerLimitMean)/2;
			bootintervalactualssanswer.innerHTML+='<ul><li>'+(lowerLimitMean).TOFIXED(printPrecision)+' &lt; &mu; &lt; '+(upperLimitMean).TOFIXED(printPrecision)+'<br>Point Estimate: '+(r.m).TOFIXED(printPrecision)+'</li></ul>';
	
			sortedArray=sampleMedians.toSorted(function(a, b){return a - b});
			lowerLimit=percentileSorted(sortedArray, left);
			upperLimit=percentileSorted(sortedArray, right);
			margin=(upperLimit-lowerLimit)/2;
			bootintervalactualssanswer.innerHTML+='<ul><li>'+(lowerLimit).TOFIXED(printPrecision)+' &lt; median &lt; '+(upperLimit).TOFIXED(printPrecision)+'<br>Point Estimate: '+(r.q2).TOFIXED(printPrecision)+'</li></ul>';

			sortedArray=sampleVariances.toSorted(function(a, b){return a - b});
			lowerLimitVar=percentileSorted(sortedArray, left);
			upperLimitVar=percentileSorted(sortedArray, right);
			margin=(upperLimitVar-lowerLimitVar)/2;
			bootintervalactualssanswer.innerHTML+='<ul><li>'+(lowerLimitVar).TOFIXED(printPrecision)+' &lt; &sigma;<sup>2</sup> &lt; '+(upperLimitVar).TOFIXED(printPrecision)+'<br>Point Estimate: '+(r.s2).TOFIXED(printPrecision)+'</li></ul>';

			sortedArray=sampleSDs.toSorted(function(a, b){return a - b});
			lowerLimit=percentileSorted(sortedArray, left);
			upperLimit=percentileSorted(sortedArray, right);
			margin=(upperLimit-lowerLimit)/2;
			bootintervalactualssanswer.innerHTML+='<ul><li>'+(lowerLimit).TOFIXED(printPrecision)+' &lt; &sigma; &lt; '+(upperLimit).TOFIXED(printPrecision)+'<br>Point Estimate: '+(r.s).TOFIXED(printPrecision)+'</li></ul>';

			//r=summarizeArray(sampleMeans);
			drawBootSummary(bootMeanIntervalCanvas, sampleMeans, list[inlist], [lowerLimitMean, upperLimitMean], ['red', 'red' ]);
			//drawBootSummary(bootVarianceIntervalCanvas, sampleVariances,[lowerLimitVar,upperLimitVar],['red', 'red']);
			bootintervalssanswer.style.display='block';
		}
		else alert('That list is empty.');
		}

	catch(err){
		alert('Input Error.');
	}	
	}	
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='bootPropIntervalDiv' data-close='bootAbout,bootMPIntervalDiv,boot2MeanIntervalDiv,boot2PropIntervalDiv,bootIntervalDiv'>One Proportion</button></li>

	<div id='bootPropIntervalDiv' class='expandable'>
	<table>
	<tr><td>Successes:</td> <td>x=</td><td><input type='text' id='bpintervalx' value="10" onkeydown='purge(bpintervalanswer);'></td></tr>
	<tr><td>Sample Size:</td><td>n=</td><td><input type='text' id='bpintervaln' value="100" onkeydown='purge(bpintervalanswer);'></td></tr>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='bpintervalcl' value="0.95" onclick='purge(bpintervalanswer);'></td></tr>
	</table>
	<button onclick='calculateBootPropInterval();' >Calculate</button>
	<div id='bpintervalanswer' class='answerDiv'>
	<div id='bpintervalactualssanswer' ></div>
	<canvas id="bootPropIntervalCanvas" width=400 height=200></canvas><br>
	</div>
	</div>
<script>
function calculateBootPropInterval(){
	try{
		var x=eval(bpintervalx.value);
		var n=eval(bpintervaln.value);
		var cl=eval(bpintervalcl.value);
		var left=(1-cl)/2;
		var right=1-left;
		var i,j;
		if (!(n>0))
			alert('The sample size should be greater than 0.');
		else if(!(x>0))
			alert('The number of successes should be greater than 0.');
		else if (!(x<n))
			alert('The number of successes should be less than the sample size.');
		else if (!((0<cl) && (cl<1)))
			alert('The confidence level should be between 0 and 1.');
		else {
			var numSamples=globalNumSamples;
			var pop=[];
			var samp=[];
			var r;
			var phats=[];
			var sortedArray=[];
			var lowerLimit, upperLimit, margin;
			for (i=0;i<x;i++)
				pop.push(1);
			for (i=x;i<n;i++)
				pop.push(0);
			for (j=0;j<numSamples;j++){
				samp=[];
				for (i=0;i<n;i++)
					samp.push(pop[floor(random()*n)]);
				r=summarizeArray(samp);
				phats.push(r.m);
			}
			sortedArray=phats.toSorted(function(a, b){return a - b});
			lowerLimit=percentileSorted(sortedArray, left);
			upperLimit=percentileSorted(sortedArray, right);
			margin=(upperLimit-lowerLimit)/2;
			drawBootSummary(bootPropIntervalCanvas, phats,pop, [lowerLimit, upperLimit], ['red', 'red' ]);
			bpintervalactualssanswer.innerHTML='<ul><li>'+(lowerLimit).TOFIXED(printPrecision)+' &lt; p &lt; '+(upperLimit).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(x/n).TOFIXED(printPrecision)+'</li></ul>';			
			bpintervalanswer.style.display='block';
		}
	}	
	catch{
		alert('Input Error.');
	}
}
</script>
<!------------------------------------------------------------------------------------------------------------------------>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='boot2PropIntervalDiv' data-close='bootAbout,bootMPIntervalDiv,boot2MeanIntervalDiv,bootPropIntervalDiv,bootIntervalDiv'>Two Proportions</button></li>

	<div id='boot2PropIntervalDiv' class='expandable'>
	<table border=1>
	<tr><th>Sample 1</th><th>Sample 2</th></tr>
	<tr><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>1</sub>=</td><td><input type='text' id='btwopropintx1' value="45" onkeydown='purge(btwopropintanswer);' ></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>1</sub>=</td><td><input type='text' id='btwopropintn1' value="100" onkeydown='purge(btwopropintanswer);' ></td></tr>
	</table>
	</td><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>2</sub>=</td><td><input type='text' id='btwopropintx2' value="50" onkeydown='purge(btwopropintanswer);' ></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>2</sub>=</td><td><input type='text' id='btwopropintn2' value="100" onkeydown='purge(btwopropintanswer);' ></td></tr>
	</table>
	</td><tr>
	</table>
	<table>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='btwopropintervalcl' value="0.95" onclick='purge(btwopropintanswer);'></td></tr>	
	</table>
	<button onclick='calculateBoot2PropInterval();' >Calculate</button>
	<div id='btwopropintanswer' class='answerDiv'>
	<div id='b2propintervalactualssanswer' ></div>
	<canvas id="boot2PropIntervalCanvas" width=400 height=200></canvas><br>
	</div>
	</div>
<script>
function calculateBoot2PropInterval(){
	try{
		var i,n1,p,p1hat,x1,n2,p2hat,x2,q;
		var z,z1,z2,cl,a,e,sd;
		
		n1=eval(btwopropintn1.value);
		x1=round(eval(btwopropintx1.value));
		n2=eval(btwopropintn2.value);
		x2=round(eval(btwopropintx2.value));
		cl=eval(btwopropintervalcl.value);
		var left=(1-cl)/2;
		var right=1-left;
		
		if (!(n1>0) || !(n2>0)) alert('The sample size should be positive.');
		else if (!(x1>0) || !(x2>0)) alert('The number of successes should be positive.');
		else{
			var numSamples=globalNumSamples;
			var pop1=[],pop2=[];
			var samp1=[],samp2=[];
			var r1,r2;
			var phats=[];
			var sortedArray=[];
			var lowerLimit, upperLimit, margin;
			for (i=0;i<x1;i++)
				pop1.push(1);
			for (i=x1;i<n1;i++)
				pop1.push(0);
			for (i=0;i<x2;i++)
				pop2.push(1);
			for (i=x2;i<n2;i++)
				pop2.push(0);
			for (j=0;j<numSamples;j++){
				samp1=[];
				samp2=[];
				for (i=0;i<n1;i++)
					samp1.push(pop1[floor(random()*n1)]);
				r1=summarizeArray(samp1);
				for (i=0;i<n2;i++)
					samp2.push(pop2[floor(random()*n2)]);
				r2=summarizeArray(samp2);
				phats.push(r1.m-r2.m);
			}
			sortedArray=phats.toSorted(function(a, b){return a - b});
			lowerLimit=percentileSorted(sortedArray, left);
			upperLimit=percentileSorted(sortedArray, right);
			margin=(upperLimit-lowerLimit)/2;
			r1=summarizeArray(pop1);
			r2=summarizeArray(pop2);
			var dummy=[r1.m-r2.m];
			drawBootSummary(boot2PropIntervalCanvas, phats,dummy, [lowerLimit, upperLimit,0], ['red', 'red' ,'blue']);
			b2propintervalactualssanswer.innerHTML='<ul><li>'+(lowerLimit).TOFIXED(printPrecision)+' &lt; p<sub>1</sub>-p<sub>2</sub> &lt; '+(upperLimit).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(r1.m-r2.m).TOFIXED(printPrecision)+'</li></ul>';	
			btwopropintanswer.style.display='block';
		}
	}
	catch{
		alert('Input Error.');
	}
		
}
</script>
<!------------------------------------------------------------------------------------------------------------------------>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='boot2MeanIntervalDiv' data-close='bootAbout,bootMPIntervalDiv,boot2PropIntervalDiv,bootPropIntervalDiv,bootIntervalDiv'>Two Independent Means</button></li>

	<div id='boot2MeanIntervalDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('b2mintradio1');
	var a=document.getElementsByClassName('b2mintradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(b2mintanswer);}
	</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('b2mintradio2');
	var a=document.getElementsByClassName('b2mintradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(b2mintanswer);}
	</script></td></tr>
	</table>

	<table>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='b2mintcl' value="0.95" onclick='purge(b2mintanswer);'></td></tr>	
	</table>
	<button onclick='calculateBoot2MeanInterval();' >Calculate</button>
	<div id='b2mintanswer' class='answerDiv'>
	<div id='b2mintactualssanswer' ></div>
	<canvas id="boot2MeanIntervalCanvas" width=400 height=200></canvas><br>
	</div>
	</div>
<script>
function calculateBoot2MeanInterval(){
try{
	var l1=getChecked('b2mintradio1');
	var l2=getChecked('b2mintradio2');;
	var cl=eval(b2mintcl.value);	
	var left=(1-cl)/2;
	var right=1-left;
	var k,i,j;
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else{	
			var numSamples=globalNumSamples;
			var samp1=[],samp2=[];
			var r1,r2;
			var phats=[];
			var sortedArray=[];
			var lowerLimit, upperLimit, margin;
			var n1=listN[l1];
			var n2=listN[l2];
			for (j=0;j<numSamples;j++){
				samp1=[];
				samp2=[];
				for (i=0;i<n1;i++)
					samp1.push(list[l1][floor(random()*n1)]);
				r1=summarizeArray(samp1);
				for (i=0;i<n2;i++)
					samp2.push(list[l2][floor(random()*n2)]);
				r2=summarizeArray(samp2);
				phats.push(r1.m-r2.m);
			}
			sortedArray=phats.toSorted(function(a, b){return a - b});
			lowerLimit=percentileSorted(sortedArray, left);
			upperLimit=percentileSorted(sortedArray, right);
			margin=(upperLimit-lowerLimit)/2;
			r1=summarizeArray(list[l1]);
			r2=summarizeArray(list[l2]);			
			var dummy=[r1.m-r2.m];
			drawBootSummary(boot2MeanIntervalCanvas, phats,dummy, [lowerLimit, upperLimit,0], ['red', 'red' ,'blue']);
			b2mintactualssanswer.innerHTML='<ul><li>'+(lowerLimit).TOFIXED(printPrecision)+' &lt; &mu;<sub>1</sub>-&mu;<sub>2</sub> &lt; '+(upperLimit).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(r1.m-r2.m).TOFIXED(printPrecision)+'</li></ul>';	
			b2mintanswer.style.display='block';
//alert('ok');
		}
}	
catch{
	alert('Input Error.');
}
}
</script>
<!------------------------------------------------------------------------------------------------------------------------>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='bootMPIntervalDiv' data-close='bootAbout,boot2MeanIntervalDiv,boot2PropIntervalDiv,bootPropIntervalDiv,bootIntervalDiv'>Matched Pairs</button></li>

	<div id='bootMPIntervalDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('bmpintradio1');
	var a=document.getElementsByClassName('bmpintradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(bmpintanswer);}
	</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('bmpintradio2');
	var a=document.getElementsByClassName('bmpintradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(bmpintanswer);}
	</script></td></tr>
	</table>

	<table>
	<tr><td>Confidence Level:</td><td>CL=</td><td><input type='text' id='bmpintcl' value="0.95" onclick='purge(bmpintanswer);'></td></tr>	
	</table>
	<button onclick='calculateBootMPInterval();' >Calculate</button>
	<div id='bmpintanswer' class='answerDiv'>
	<div id='bmpintervalactualssanswer' ></div>
	<canvas id="bootMPIntervalCanvas" width=400 height=200></canvas><br>
	</div>
	</div>
<script>
function calculateBootMPInterval(){
try{
	var l1=getChecked('bmpintradio1');
	var l2=getChecked('bmpintradio2');;
	var k,i,j;
	var cl=eval(bmpintcl.value);
	var left=(1-cl)/2;
	var right=1-left;
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else if (listN[l1]!=listN[l2]) alert('Your lists need to be the same length.');
	else{	
			var numSamples=globalNumSamples;
			var pop=[];
			var samp=[];
			var r;
			var phats=[];
			var sortedArray=[];
			var lowerLimit, upperLimit, margin;
			var n=listN[l1];
			for (i=0;i<n;i++)
				pop.push(list[l1][i]-list[l2][i]);
			for (j=0;j<numSamples;j++){
				samp=[];
				for (i=0;i<n;i++)
					samp.push(pop[floor(random()*n)]);
				r=summarizeArray(samp);
				phats.push(r.m);
			}
			sortedArray=phats.toSorted(function(a, b){return a - b});
			lowerLimit=percentileSorted(sortedArray, left);
			upperLimit=percentileSorted(sortedArray, right);
			margin=(upperLimit-lowerLimit)/2;
			r=summarizeArray(pop);			
			var dummy=[r.m];
			drawBootSummary(bootMPIntervalCanvas, phats,dummy, [lowerLimit, upperLimit,0], ['red', 'red' ,'blue']);
			bmpintervalactualssanswer.innerHTML='<ul><li>'+(lowerLimit).TOFIXED(printPrecision)+' &lt; &mu;<sub>1</sub>-&mu;<sub>2</sub> &lt; '+(upperLimit).TOFIXED(printPrecision)+'</li><li>Point Estimate: '+(r.m).TOFIXED(printPrecision)+'</li></ul>';		
			bmpintanswer.style.display='block';
	
//	alert('ok');
	}
}	
catch{
	alert('Input Error.');
}
}
</script>
<!------------------------------------------------------------------------------------------------------------------------>
</ul>	
</div>
</div> <!-- subpage-->
</div> <!-- intervalsdiv -->
<!--intervals-------------------------------------------------------->


<!--tests------------------------------------------------------------->
<div id='testsDiv' class='pageDiv expandable'>
<div class='pageMenu'>
<button class='expander' data-open='ParametricDiv' data-close='NonparametricDiv,ResampleDiv'>Parametric Tests</button>
<span class='special'>
<button class='expander' data-open='NonparametricDiv' data-close='ParametricDiv,ResampleDiv'>Nonparametric Tests</button>
<button class='expander' data-open='ResampleDiv' data-close='ParametricDiv,NonparametricDiv'>Resampling Tests</button>
</span>
</div>
<!--subpage for tests-->
<div class='subPage'>
<!--subpage for tests-->
<div id='ParametricDiv' class='expandable'>
<h4>Parametric Tests</h3>
<ul>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='onepropDiv' data-close='NonparametricDiv,twopropDiv,onemeanDiv,twomeanDiv,matchedDiv,anovaDiv,gofDiv,contingencyDiv'>Z-Test for One Proportion</button></li>

	<div id='onepropDiv' class='expandable'>
	<table>
	<tr><td>Successes:</td> <td>x=</td><td><input type='text' id='propx' value="50" onkeydown='purge(propAnswerDiv);' onchange='copyThisTo(this, pintervalx);'></td></tr>
	<tr><td>Sample Size:</td><td>n=</td><td><input type='text' id='propn' value="100" onkeydown='purge(propAnswerDiv);'  onchange='copyThisTo(this, pintervaln);'></td></tr>
	</table>
	<table>
	<!--tr><td>H<sub>0</sub>:</td>	<td></td><td>&nbsp;&leq;&nbsp;</td><td>&nbsp;=&nbsp;</td><td>&nbsp;&geq;&nbsp;</td></tr-->
	<tr><td>H<sub>1:</sub></td>	<td>p</td>
	<td><label><input type='radio' name='proptype' id='propgt' checked=true onclick='purge(propAnswerDiv);'> &gt; &nbsp; </label></td>
	<td><label><input type='radio' name='proptype' id='propne' onclick='purge(propAnswerDiv);'> &ne; &nbsp; </label></td>
	<td><label><input type='radio' name='proptype' id='proplt' onclick='purge(propAnswerDiv);'> &lt; &nbsp; </label></td>
	<td><input type='text' id='propcp' value='0.5' onkeydown='purge(propAnswerDiv);'></td>
	</tr>
	<!--tr><td>H<sub>1:</sub></td><td></td>	<td>&nbsp;&gt;&nbsp;</td><td>&nbsp;&ne;&nbsp;</td><td>&nbsp;&lt;&nbsp;</td></tr-->
	</table>
	<button onclick='CalculateOneProp();'>Calculate</button><br>
	<div id='propAnswerDiv' class='answerDiv expandable'>
	<div id='propanswer'></div>
	<canvas id='propcanvas' width="400" height="200"></canvas>
	</div>
	</div>
	<script>
	function CalculateOneProp(){
	try{
		var n=eval(propn.value);
		var x=round(eval(propx.value));
		if (!(n>0)) alert ('The sample size should be a positive integer.');
	//	else if (!(x>0)) alert('The number of successes should be a positive integer.');
		else{
			var phat=x/n;

			var m=phat;
			var hm=eval(propcp.value);
			if (!((hm>0)&&(hm<1))) alert('The claimed proportion should be between 0 and 1.');
			else{
				var p=hm;
				var s=sqrt(p*(1-p));

				var z,z1,z2;
				z=(m-hm)/(s/sqrt(n));
				if (proplt.checked){
					p=normalcdf(z);
					z1=z
					z2=9;
					}
				else if (propgt.checked){
					p=1-normalcdf(z);
					z1=-9;
					z2=z;
					}
				else{
					p=2*normalcdf(-abs(z));
					z1=-abs(z);
					z2=abs(z);
					}
				propanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>z='+z.TOFIXED(printPrecision)+'</li></ul>';
drawBellSummary(propcanvas, hm, s/sqrt(n), hm+z1*s/sqrt(n), hm+z2*s/sqrt(n), m, 'red', 'lightgray', 'red', 'blue')

				propAnswerDiv.style.display='block';
			}
		}
	}
	catch(err){
		alert('Input Error.');
	}		
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>

<li><button class='expander' data-open='onemeanDiv' data-close='NonparametricDiv,meanTestDataListDiv,onepropDiv,twopropDiv,twomeanDiv,matchedDiv,anovaDiv,gofDiv,contingencyDiv'>T-Test for One Mean</button></li>

	<div id='onemeanDiv' class='expandable'>
	<table>
	<tr><td>Sample Mean:</td><td>x&#772;=</td><td><input type='text' id='ttestssm' value="100" onkeydown='purge(ttestssAnswerDiv);' onchange='copyThisTo(this,tintervalssm);'></td></tr>
	<tr><td>Standard Deviation:</td> <td>s=</td><td><input type='text' id='ttestsss' value="10" onkeydown='purge(ttestssAnswerDiv);' onchange='copyThisTo(this,tintervalsss);'></td></tr>
	<tr><td>Sample Size:</td><td>n=</td><td><input type='text' id='ttestssn' value="100" onkeydown='purge(ttestssAnswerDiv);' onchange='copyThisTo(this,tintervalssn);'></td></tr>
	</table>
	<table>
	<!--tr><td>H<sub>0</sub>:</td>	<td></td><td>&nbsp;&leq;&nbsp;</td><td>&nbsp;=&nbsp;</td><td>&nbsp;&geq;&nbsp;</td></tr-->
	<tr><td>H<sub>1:</sub></td><td>&mu;</td>
	<td><label><input type='radio' name='ttestsstype' id='ttestssgt' checked=true onclick='purge(ttestssAnswerDiv);'> &gt; &nbsp;</label></td>
	<td><label><input type='radio' name='ttestsstype' id='ttestssne' onclick='purge(ttestssAnswerDiv);'> &ne; &nbsp;</label></td>
	<td><label><input type='radio' name='ttestsstype' id='ttestsslt' onclick='purge(ttestssAnswerDiv);'> &lt; &nbsp;</label></td>
	<td><input type='text' id='ttestssclaimedm' value='100' onkeydown='purge(ttestssAnswerDiv);'></td>
	</tr>
	<!--tr><td>H<sub>1:</sub></td><td></td>	<td>&nbsp;&gt;&nbsp;</td><td>&nbsp;&ne;&nbsp;</td><td>&nbsp;&lt;&nbsp;</td></tr-->
	</table>
	<button class='expander' data-open='meanTestDataListDiv' data-close='ttestssAnswerDiv'>Select Data List</button><br>
	<div id='meanTestDataListDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('meantest');
	var a=document.getElementsByClassName('meantest'+'radio');
	a[0].checked=true;</script><br>
	<button onclick='populateMeanTestStats();' >Populate Summary Stats</button><br>
	</div>		
	<button onclick='CalculateTTestFromSummaryStatistics();'>Calculate</button>
	<div id='ttestssAnswerDiv' class='answerDiv expandable'>
	<div id='ttestssanswer'></div>
	<canvas id='ttestsscanvas' width="400" height="200"></canvas>
	</div>
	</div>
	<script>
	function CalculateTTestFromSummaryStatistics(){
	try{
		var m=eval(ttestssm.value);
		var hm=eval(ttestssclaimedm.value);
		var s=eval(ttestsss.value);
		var n=eval(ttestssn.value);
		var z,p,z1,z2;
		
		if (isNaN(m*hm*s*n)) alert('Input Error.');
		else if (!(n>0)) alert('The sample size should be a positive number.');
		else if (!(s>0)) alert('The standard deviation should be a positive number.');
		else{
			z=(m-hm)/(s/sqrt(n));
			if (ttestsslt.checked){
				p=tcdf(z,n-1);
				z1=z;
				z2=9;
				}
			else if (ttestssgt.checked){
				p=1-tcdf(z,n-1);
				z1=-9;
				z2=z;
				}
			else{
				p=2*tcdf(-abs(z),n-1);
				z1=-abs(z);
				z2=abs(z);
				}
			ttestssanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>t='+z.TOFIXED(printPrecision)+'</li><li>df='+(n-1).TOFIXED(printPrecision)+'</li></ul>';
drawBellSummary(ttestsscanvas, hm, s/sqrt(n), hm+z1*s/sqrt(n), hm+z2*s/sqrt(n), m, 'red', 'lightgray', 'red', 'blue')
			ttestssAnswerDiv.style.display='block';
		}
	}
	catch(err){
		alert('Input Error.');
	}	
	}

	function populateMeanTestStats(){
		var inlist=0;
		var i;
		inlist=getChecked('meantest');
		if (listN[inlist]==0) alert ('That list is empty.');
		else{
			ttestssm.value=listM[inlist].TOFIXED(printPrecision);
			ttestsss.value=listS[inlist].TOFIXED(printPrecision);
			ttestssn.value=listN[inlist].TOFIXED(printPrecision);
			tintervalssm.value=listM[inlist].TOFIXED(printPrecision);
			tintervalsss.value=listS[inlist].TOFIXED(printPrecision);
			tintervalssn.value=listN[inlist].TOFIXED(printPrecision);
			meanTestDataListDiv.style.display='none';
		}
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>

<li><button class='expander' data-open='twopropDiv' data-close='NonparametricDiv,onepropDiv,onemeanDiv,twomeanDiv,matchedDiv,anovaDiv,gofDiv,contingencyDiv,correlationDiv'>Z-Test for Two Proportions</button></li>

	<div id='twopropDiv' class='expandable'>
	<table border=1>
	<tr><th>Sample 1</th><th>Sample 2</th></tr>
	<tr><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>1</sub>=</td><td><input type='text' id='twopropx1' value="45" onkeydown='purge(twopropanswerDIV);' onchange='copyThisTo(this, twopropintx1);'></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>1</sub>=</td><td><input type='text' id='twopropn1' value="100" onkeydown='purge(twopropanswerDIV);' onchange='copyThisTo(this, twopropintn1);'></td></tr>
	</table>
	</td><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>2</sub>=</td><td><input type='text' id='twopropx2' value="50" onkeydown='purge(twopropanswerDIV);' onchange='copyThisTo(this, twopropintx2);'></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>2</sub>=</td><td><input type='text' id='twopropn2' value="100" onkeydown='purge(twopropanswerDIV);' onchange='copyThisTo(this, twopropintn2);'></td></tr>
	</table>
	</td><tr>
	</table>

	<table>
	<!--tr><td>H<sub>0</sub>:</td>	<td></td><td>&nbsp;&leq;&nbsp;</td><td>&nbsp;=&nbsp;</td><td>&nbsp;&geq;&nbsp;</td></tr-->
	<tr><td>H<sub>1:</sub></td>	<td>p<sub>1</sub></td>
	<td><label><input type='radio' name='twoproptype' id='twopropgt' checked=true onclick='purge(twopropanswerDIV);'> &gt; &nbsp; </label></td>
	<td><label><input type='radio' name='twoproptype' id='twopropne' onclick='purge(twopropanswerDIV);'> &ne; &nbsp; </label></td>
	<td><label><input type='radio' name='twoproptype' id='twoproplt' onclick='purge(twopropanswerDIV);'> &lt; &nbsp; </label></td>
	<td>p<sub>2</sub></td>
	</tr>
	<!--tr><td>H<sub>1:</sub></td><td></td>	<td>&nbsp;&gt;&nbsp;</td><td>&nbsp;&ne;&nbsp;</td><td>&nbsp;&lt;&nbsp;</td></tr-->
	</table>
	<button onclick='CalculateTwoProp();'>Calculate</button>
	<div id='twopropanswerDIV' class='answerDiv expandable' >
	<div id='twopropanswer' ></div>
	<canvas id='twopropcanvas' width="400" height="200"></canvas>
	</div>
	</div>
	<script>
	function CalculateTwoProp(){
	try{
		var i,n1,p,p1hat,x1,n2,p2hat,x2;

		n1=eval(twopropn1.value);
		x1=round(eval(twopropx1.value));
		n2=eval(twopropn2.value);
		x2=round(eval(twopropx2.value));
		if (!(n1>0) || !(n2>0)) alert('The sample size should be positive.');
		else if (!(x1>0) || !(x2>0)) alert('The number of successes should be positive.');
		else{
			p1hat=x1/n1;
			p2hat=x2/n2;
			p=(x1+x2)/(n1+n2);

			var m=p1hat-p2hat;
			var hm=0;
			var s=sqrt(p*(1-p));
			var n=n1*n2/(n1+n2);

			var z,z1,z2;
			z=(m-hm)/(s/sqrt(n));
			if (twoproplt.checked){
				p=normalcdf(z);
				z1=z;
				z2=9;
				}
			else if (twopropgt.checked){
				p=1-normalcdf(z);
				z1=-9;
				z2=z;
				}
			else{
				p=2*normalcdf(-abs(z));
				z1=-abs(z);
				z2=abs(z);
				}
			twopropanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>z='+z.TOFIXED(printPrecision)+'</li></ul>';
drawBellSummary(twopropcanvas, hm, s/sqrt(n), hm+z1*s/sqrt(n), hm+z2*s/sqrt(n), m, 'red', 'lightgray', 'red', 'blue')
			
			twopropanswerDIV.style.display='block';
		}
	}
	catch(err){
		alert('Input Error.');
	}		
	}
	</script>
<!------------------------------------------------------------------------------------------------------------------------------------>

<li><button class='expander' data-open='twomeanDiv' data-close='NonparametricDiv,onepropDiv,twopropDiv,onemeanDiv,matchedDiv,anovaDiv,gofDiv,contingencyDiv,correlationDiv'>T-Test for Two Independent Means</button></li>

	<div id='twomeanDiv' class='expandable'>

<table border=1>
<tr><th>Sample 1</th><th>Sample 2</th></tr>
<tr><td>
<table>
<tr><td>Sample Mean:</td><td><font style='text-decoration: overline;'>X</font><sub>1</sub>=</td>	<td><input type='text' id='t2testssm1' value="100" onkeydown='purge(t2testssanswer);' onchange='copyThisTo(this, t2intssm1);'></td></tr>
<tr><td>Standard Deviation:</td> <td>s<sub>1</sub>=</td>									<td><input type='text' id='t2testsss1' value="10" onkeydown='purge(t2testssanswer);' onchange='copyThisTo(this, t2intsss1);'></td></tr>
<tr><td>Sample Size:</td><td>n<sub>1</sub>=</td>										<td><input type='text' id='t2testssn1' value="100" onkeydown='purge(t2testssanswer);' onchange='copyThisTo(this, t2intssn1);'></td></tr>
</table>
	<button class='expander' data-open='meanTest2LeftDataListDiv' data-close='t2testssanswer'>Select Data List</button><br>
	<div id='meanTest2LeftDataListDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('meantest2left');
	var a=document.getElementsByClassName('meantest2left'+'radio');
	a[0].checked=true;</script><br>
	<button onclick='populateMeanTest2Stats(1);' >Populate Summary Stats</button><br>
	</div>		

</td><td>
<table>
<tr><td>Sample Mean:</td><td><font style='text-decoration: overline;'>X</font><sub>2</sub>=</td>	<td><input type='text' id='t2testssm2' value="100" onkeydown='purge(t2testssanswer);' onchange='copyThisTo(this, t2intssm2);'></td></tr>
<tr><td>Standard Deviation:</td> <td>s<sub>2</sub>=</td>									<td><input type='text' id='t2testsss2' value="10" onkeydown='purge(t2testssanswer);' onchange='copyThisTo(this, t2intsss2);'></td></tr>
<tr><td>Sample Size:</td><td>n<sub>2</sub>=</td>										<td><input type='text' id='t2testssn2' value="100" onkeydown='purge(t2testssanswer);' onchange='copyThisTo(this, t2intssn2);'></td></tr>
</table>
	<button class='expander' data-open='meanTest2RightDataListDiv' data-close='t2testssanswer'>Select Data List</button><br>
	<div id='meanTest2RightDataListDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('meantest2right');
	var a=document.getElementsByClassName('meantest2right'+'radio');
	a[1].checked=true;</script><br>
	<button onclick='populateMeanTest2Stats(2);' >Populate Summary Stats</button><br>
	</div>
</td><tr>
</table>

<table>
<!--tr><td>H<sub>0</sub>:</td>	<td></td><td>&nbsp;&leq;&nbsp;</td><td>&nbsp;=&nbsp;</td><td>&nbsp;&geq;&nbsp;</td></tr-->
<tr><td>H<sub>1:</sub></td>	<td>&mu;<sub>1</sub></td>
<td><label><input type='radio' name='t2testsstype' id='t2testssgt' checked=true onclick='purge(t2testssanswer);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='t2testsstype' id='t2testssne' onclick='purge(t2testssanswer);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='t2testsstype' id='t2testsslt' onclick='purge(t2testssanswer);'> &lt; &nbsp; </label></td>
<td>&mu;<sub>2</sub></td>
</tr>
<!--tr><td>H<sub>1:</sub></td><td></td>	<td>&nbsp;&gt;&nbsp;</td><td>&nbsp;&ne;&nbsp;</td><td>&nbsp;&lt;&nbsp;</td></tr-->
</table>
<button onclick='CalculateT2TestFromSummaryStatistics();'>Calculate</button>
<div id='t2testssanswer' class='answerDiv'>
<div id='t2testssanswerinternal'></div>
<canvas id='twomeancanvas' width="400" height="200"></canvas>
</div>

	</div>

<script>

function CalculateT2TestFromSummaryStatistics(){
try{
	var m1=eval(t2testssm1.value);
	var s1=eval(t2testsss1.value);
	var n1=eval(t2testssn1.value);
	var m2=eval(t2testssm2.value);
	var s2=eval(t2testsss2.value);
	var n2=eval(t2testssn2.value);
	
	if (isNaN(m1*s1*n1*m2*s2*n2)) alert('Input Error.');
	else if (!(n1>0) || !(n2>0)) alert('The sample size should be positive');
	else if (!(s1>0) || !(s2>0)) alert('The standard deviation should be positive');
	else{
		var m=m1-m2;
		var hm=0;
		var a=s1*s1/n1;
		var b=s2*s2/n2;
		var n=(((a+b)*(a+b)/((a*a/(n1-1))+(b*b/(n2-1))))+1);
		var s=sqrt(n*((s1*s1/n1)+(s2*s2/n2)));

		var z,p,z1,z2;
		z=(m-hm)/(s/sqrt(n));
		if (t2testsslt.checked){
			z1=z;
			z2=9
			p=tcdf(z,n-1);
		}
		else if (t2testssgt.checked){
			z1=-9;
			z2=z;
			p=1-tcdf(z,n-1);
		}
		else{
			z1=-abs(z);
			z2=abs(z);
			p=2*tcdf(-abs(z),n-1);
		}
		t2testssanswerinternal.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>t='+z.TOFIXED(printPrecision)+'</li><li>df='+(n-1).TOFIXED(printPrecision)+'</li></ul>';
drawBellSummary(twomeancanvas, hm, s/sqrt(n), hm+z1*s/sqrt(n), hm+z2*s/sqrt(n), m, 'red', 'lightgray', 'red', 'blue')
		t2testssanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}	
}
	function populateMeanTest2Stats(d){
		var inlist=0;
		var i;
		if (d==1){
		inlist=getChecked('meantest2left');
			if (listN[inlist]==0) alert ('That list is empty.');
			else{
				t2testssm1.value=listM[inlist].TOFIXED(printPrecision);
				t2testsss1.value=listS[inlist].TOFIXED(printPrecision);
				t2testssn1.value=listN[inlist].TOFIXED(printPrecision);
				t2intssm1.value=listM[inlist].TOFIXED(printPrecision);
				t2intsss1.value=listS[inlist].TOFIXED(printPrecision);
				t2intssn1.value=listN[inlist].TOFIXED(printPrecision);
				
				meanTest2LeftDataListDiv.style.display='none';
			}		
		}
		else{
			inlist=getChecked('meantest2right');
			if (listN[inlist]==0) alert ('That list is empty.');
			else{
				t2testssm2.value=listM[inlist];
				t2testsss2.value=listS[inlist];
				t2testssn2.value=listN[inlist];
				t2intssm2.value=listM[inlist];
				t2intsss2.value=listS[inlist];
				t2intssn2.value=listN[inlist];
				meanTest2RightDataListDiv.style.display='none';
			}
		}
	}
</script>

<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='matchedDiv' data-close='NonparametricDiv,onepropDiv,twopropDiv,onemeanDiv,twomeanDiv,anovaDiv,gofDiv,contingencyDiv,correlationDiv'>T-Test for Matched Pairs</button></li>

	<div id='matchedDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('mpradio1');
	var a=document.getElementsByClassName('mpradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(mpanswer);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('mpradio2');
	var a=document.getElementsByClassName('mpradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(mpanswer);}</script></td></tr>
	</table>


<table>
<!--tr><td>H<sub>0</sub>:</td>	<td></td><td>&nbsp;&leq;&nbsp;</td><td>&nbsp;=&nbsp;</td><td>&nbsp;&geq;&nbsp;</td></tr-->
<tr><td>H<sub>1:</sub></td>	<td>&mu;<sub>d</sub></td>
<td><label><input type='radio' name='mptype' id='mpgt' checked=true onclick='purge(mpanswer);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='mptype' id='mpne' onclick='purge(mpanswer);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='mptype' id='mplt' onclick='purge(mpanswer);'> &lt; &nbsp; </label></td>
<td>0</td>
</tr>
<!--tr><td>H<sub>1:</sub></td><td></td>	<td>&nbsp;&gt;&nbsp;</td><td>&nbsp;&ne;&nbsp;</td><td>&nbsp;&lt;&nbsp;</td></tr-->
</table>
<button onclick='CalculateMP();'>Calculate</button>
<div id='mpanswer' class='answerDiv'>
<div id='mpanswerinternal'></div>
<canvas id='mpcanvas' width='400' height='200'></canvas>
</div>
	</div>
	
<script>
function CalculateMP(){
try{
	var i=getChecked('mpradio1');
	var j=getChecked('mpradio2');;
	var k;
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else if (listN[i]!=listN[j]) alert('Your lists need to be the same length.');
	else{	
		var a=[];
		for (k=0;k<listN[i];k++)
			a[k]=list[i][k]-list[j][k];
		var r=summarizeArray(a);

		var m=r.m;
		var hm=0;
		var s=r.s; 
		var n=r.n;
		var z,p,z1,z2;
		z=(m-hm)/(s/sqrt(n));
		if (mplt.checked){
			p=tcdf(z,n-1);
			z1=z;
			z2=9;
			}
		else if (mpgt.checked){
			p=1-tcdf(z,n-1);
			z1=-9;
			z2=z;
			}
		else{
			p=2*tcdf(-abs(z),n-1);
			z1=-abs(z);
			z2=abs(z);
			}
		mpanswerinternal.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>t='+z.TOFIXED(printPrecision)+'</li><li>df='+(n-1).TOFIXED(printPrecision)+'</li></ul>';
drawBellSummary(mpcanvas, hm, s/sqrt(n), hm+z1*s/sqrt(n), hm+z2*s/sqrt(n), m, 'red', 'lightgray', 'red', 'blue')		
		mpanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>

<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='correlationDiv' data-close='NonparametricDiv,onepropDiv,twopropDiv,onemeanDiv,twomeanDiv,matchedDiv,anovaDiv,gofDiv,contingencyDiv'>Correlation</button></li>

	<div id='correlationDiv' class='expandable'>
	
	<table>
	<tr><td>X:</td>
	<td><script>printRadioList('corradiox');
	var a=document.getElementsByClassName('corradiox'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(coranswerDiv);}</script></td></tr>
	<tr><td>Y:</td>
	<td><script>printRadioList('corradioy');
	var a=document.getElementsByClassName('corradioy'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(coranswerDiv);}</script></td></tr>
	</table>
<br>
<button onclick='CalculateCorrelation();'>Calculate</button>
<div id='coranswerDiv' class='answerDiv'>
<div id='coranswer'></div>
<canvas id='corcanvas' width=400 height=400></canvas>
</div>
</div>

<script>

function CalculateCorrelation(){
try{
	var l1=getChecked('corradiox');
	var l2=getChecked('corradioy');
	var i;
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else if (listN[l1]!=listN[l2]) alert('Your lists need to be the same length.');
	else{	
		var sumprod, sumx, sumy, sumx2,r, P, t,i,j,n,m,b;

		n=listN[l1];
		sumx=listSum[l1];
		sumy=listSum[l2];
		sumprod=0;
		sumx2=0;
		for (i=0;i<n;i++){
			sumprod+=list[l1][i]*list[l2][i];
			sumx2+=list[l1][i]*list[l1][i];
			}
		m=(n*sumprod-sumx*sumy)/(n*sumx2-sumx*sumx);
		b=(sumy*sumx2-sumx*sumprod)/(n*sumx2-sumx*sumx);

		r=m*listS[l1]/listS[l2];
if (r==1) {t=Infinity; P=0;}
else{
		t=r/Math.sqrt((1-r*r)/(n-2));
		P=2*(1-tcdf(Math.abs(t),n-2));
}
		coranswer.innerHTML='<ul><li>y=mx+b</li><li>m='+m.TOFIXED(printPrecision)+'</li><li>b='+b.TOFIXED(printPrecision)+'</li><li>t='+t.TOFIXED(printPrecision)+'</li><li>df='+(n-2).TOFIXED(printPrecision)+'</li><li>P='+P.TOFIXED(printPrecision)+'</li><li>r='+r.TOFIXED(printPrecision)+'</li></ul>';
//	var l1=-1, l2=-1;
	var D=40;

	{
		var xlist=l1;
		var ylist=l2;
		var can=corcanvas;
		var ctx=can.getContext('2d');
		var w=can.width;
		var h=can.height;
		var xmin=listMin[xlist];
		var xmax=listMax[xlist];
		var ymin=listMin[ylist];
		var ymax=listMax[ylist];
		var n = listN[xlist];
		var W=w-2*D;
		var H=h-2*D;
		var wx=xmax-xmin;
		var wy=ymax-ymin;

		ctx.strokeStyle='gray';
		ctx.fillStyle='white';
		ctx.lineWidth=1;
		ctx.fillRect(0,0,w,h);
		ctx.beginPath();
		ctx.rect(0,0,w,h);
		ctx.rect(D,D,W,H);
		ctx.stroke();
		ctx.strokeStyle='black';
		for (i=0;i<n;i++){
			ctx.beginPath();
			ctx.arc(D+W*(list[xlist][i]-xmin)/wx, h-(D+H*(list[ylist][i]-ymin)/wy), 1,0,2*Math.PI);
			ctx.stroke();
		}
		ctx.font='12px Helvetica';
		ctx.fillStyle='black';
		var dx=(xmax-xmin)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6+W*(j*dx)/wx, h-D+6); 
			ctx.rotate(PI/2);
			ctx.fillText((xmin+j*dx).TOFIXED(2),0,0);
			ctx.restore();
		}		
		var dy=(ymax-ymin)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6,h-(D-6+H*(j*dy)/wy)); 
			ctx.textAlign='end';
			ctx.fillText((xmin+j*dy).TOFIXED(2),0,0);
			ctx.restore();
		}		
		ctx.strokeStyle='red';
		ctx.beginPath()
		var y1=m*xmin+b;
		var y2=m*xmax+b;
//ctx.arc(D+W*(list[xlist][i]-xmin)/wx, h-(D+H*(list[ylist][i]-ymin)/wy), 1,0,2*Math.PI);		
		ctx.moveTo(D+W*(xmin-xmin)/wx, h-(D+H*(y1-ymin)/wy));
		ctx.lineTo(D+W*(xmax-xmin)/wx, h-(D+H*(y2-ymin)/wy));
		ctx.stroke();
	}	
		
		coranswerDiv.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}

</script>
	

<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='gofDiv' data-close='NonparametricDiv,onepropDiv,twopropDiv,onemeanDiv,twomeanDiv,matchedDiv,anovaDiv,contingencyDiv,correlationDiv'>&chi;<sup>2</sup>  Test for Goodness of Fit</button></li>

	<div id='gofDiv' class='expandable'>
	<table>
	<tr><td>Observed:</td>
	<td><script>printRadioList('chi1');
	var a=document.getElementsByClassName('chi1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(chianswer);}</script></td></tr>
	<tr><td>Expected:</td>
	<td><script>printRadioList('chi2');
	var a=document.getElementsByClassName('chi2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(chianswer);}</script></td></tr>
	</table>
<button onclick='CalculateChiSquared();'>Calculate</button>
<div id='chianswer' class='answerDiv'>
<div id='chianswerinternal'></div>
<canvas id='chicanvas' width="400" height="200"></canvas>
</div>

	</div>
<script>
function CalculateChiSquared(){
try{
	var i=getChecked('chi1');
	var j=getChecked('chi2');;
	var k,chi2,P;
	var notzero=true;
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else if (listN[i]!=listN[j]) alert('Your lists need to be the same length.');
	else{	
		for (k=0;k<listN[j];k++)
			if (list[j][k]==0)
				notzero=false;
		if (!notzero) alert('You cannot have an expected value of 0.');
		else{
			if (listSum[i]!=listSum[j])
				for (k=0;k<listN[j];k++)
					list[j][k]=listSum[i]*list[j][k]/listSum[j]; console.log(list[j]);
			var a=[];
			for (k=0;k<listN[i];k++)
				a[k]=(list[i][k]-list[j][k])*(list[i][k]-list[j][k])/list[j][k];
			var r=summarizeArray(a);
			chi2=r.sum;
			P=1-chi2cdf(chi2,listN[i]-1);
			drawChiTail(chicanvas,chi2,listN[i]-1);
			chianswerinternal.innerHTML='<ul><li>P='+P.TOFIXED(printPrecision)+'</li><li>&chi;<sup>2</sup>='+chi2.TOFIXED(printPrecision)+'</li><li>df='+(listN[i]-1).TOFIXED(printPrecision)+'</li></ul>';
			chianswer.style.display='block';
		}
	}
}
catch(err){
	alert('Input Error.');
}		
}
function drawChiTail(cvs,a, df){
			var ctx=cvs.getContext('2d');
			var w=cvs.width;
			var h=cvs.height;
			var i,z;
			var M;
			var leftStop=10;
			var graphWidth=w-2*leftStop;
			var bottomStop=40;
			var H=0.9*(h-bottomStop);
			
			if (df>2) M=chi2pdf(df-2, df);
			else M=0.5;
			ctx.strokeStyle='gray';
			ctx.fillStyle='white';
			ctx.lineWidth=1;
			ctx.fillRect(0,0,w,h);
			ctx.beginPath();
			for (i=0;i<=graphWidth;i++){ 
				ctx.moveTo(i+leftStop,h-bottomStop);
				z=(i)*(3*df)/graphWidth; 
				ctx.lineTo(i+leftStop,h-Math.ceil(H*chi2pdf(z,df)/M)-bottomStop);
			}
			ctx.stroke();

			ctx.strokeStyle='red';
			ctx.beginPath();
			for (i=0;i<=w;i++){
				ctx.moveTo(i+leftStop,h-bottomStop);
				z=(i)*(3*df)/graphWidth;
				if ((a<=z))
					ctx.lineTo(i+leftStop,h-Math.ceil(H*chi2pdf(z,df)/M)-bottomStop);
			}
			ctx.stroke();
		//labels
		ctx.fillStyle='black';
		var theLabel;
		var dx=graphWidth/10;
		for (j=0;j<=10;j++){
			theLabel=(j*dx)*(3*df)/graphWidth
			ctx.save();
			ctx.translate(j*dx+leftStop-4, h-bottomStop+2);
			ctx.rotate(PI/2);
			ctx.fillText((theLabel).TOFIXED(2),0,0);
			ctx.restore();
			
		}			
		
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='contingencyDiv' data-close='NonparametricDiv,onepropDiv,twopropDiv,onemeanDiv,twomeanDiv,matchedDiv,anovaDiv,gofDiv,correlationDiv'>&chi;<sup>2</sup> Contingency Table</button></li>

	<div id='contingencyDiv' class='expandable'>
Select the columns to be included:<br>
Lists: <script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  id='conlist"+i+"' onclick='purge(contingencyanswer);' class='contingencycheckbox'><span class='contingencylabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('contingency'+'label');					
	var a=document.getElementsByClassName('contingencycheckbox');
	a[0].checked=true;
	a[1].checked=true;
</script><br>
<button onclick='CalculateContingency();'>Calculate</button>
<div id='contingencyanswer' class='answerDiv'>
<div id='contingencyanswerinternal'></div>
<canvas id='contingencycanvas' width="400" height="200"></canvas>
</div>

	</div>
<script>


function CalculateContingency(){
try{
	var i=0;
	var notempty=true;
	var samelength=true;
	var j=numLists-1;
	var k;
	var abox=document.getElementsByClassName('contingencycheckbox');

	var n=0;
	var f,l;
	for (i=0;i<numLists;i++)
		if (abox[i].checked){
			if (listN[i]<2) abox[i].checked=false;
			else n++;
		}
		
	if (n<2) alert('Select multiple lists to be included in the test.');
	else{
		f=0;
		while (abox[f].checked==false) f++;
		for (i=0;i<numLists;i++)
			if ((abox[i].checked) && (listN[i]!=listN[f]))
				samelength=false;
				
		if (!samelength) alert('Your lists must be the same length.');
		else{ 
			var Observed=[];
			var Expected=[];
			var ColumnTotals=[];
			var RowTotals=[];
			for (x=0;x<n;x++){
				Observed[x]=[];
				Expected[x]=[];
			}
			
			var i=0,j=0;
			for (x=0;x<numLists;x++)
				if (abox[x].checked){
					for (y=0;y<listN[x];y++)
						Observed[i].push(list[x][y]);
					ColumnTotals[i]=listSum[x];
					i++;	
				}
			var r, c, ct, rt, tt,nr,nc,P;
			var x,y,k,i;
			var l0=numLists;

			nr=Observed[0].length;
			var aa=[];
			var a=[];
			var b=[];
			
			nc=n;
			tt=0;
			
			for (x=0;x<nc;x++)
				for (y=0;y<nr;y++)
					tt+=Observed[x][y];
					
			for (y=0;y<nr;y++){
				RowTotals[y]=0;
				for (k=0;k<nc;k++)
					RowTotals[y]+=Observed[k][y];
			}			
			
			for (x=0;x<nc;x++)
				for (y=0;y<nr;y++)
					Expected[x][y]=RowTotals[y]*ColumnTotals[x]/tt;
					
			var ob, ex;
			for (x=0;x<nc;x++)
				for (y=0;y<nr;y++){
					ob=Observed[x][y];
					ex=Expected[x][y];
					aa.push((ob-ex)*(ob-ex)/ex);
				}
				
			var r=summarizeArray(aa);
			chi2=r.sum;

			P=1-chi2cdf(chi2,(nr-1)*(nc-1));			
			drawChiTail(contingencycanvas,chi2, (nr-1)*(nc-1));
			contingencyanswerinternal.innerHTML='<ul><li>P='+P.TOFIXED(printPrecision)+'</li><li>&chi;<sup>2</sup>='+chi2.TOFIXED(printPrecision)+'</li><li>df='+((nr-1)*(nc-1)).TOFIXED(printPrecision)+'</li></ul>';
			contingencyanswer.style.display='block';
		}
	}

}
catch(err){
	alert('Input Error.');
}	
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='anovaDiv' data-close='NonparametricDiv,onepropDiv,twopropDiv,onemeanDiv,twomeanDiv,matchedDiv,gofDiv,contingencyDiv,correlationDiv'>ANOVA</button> </li>
	<div id='anovaDiv' class='expandable'>
Select at least three lists to include in the test.<br>
Lists: <script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  id='anovalist"+i+"' onclick='purge(anovaanswer);'  class='anovacheckbox'><span class='anovalabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('anova'+'label');				
	var a=document.getElementsByClassName('anovacheckbox');
	a[0].checked=true;
	a[1].checked=true;
	a[2].checked=true;
</script><br>
<button onclick='CalculateANOVA();'>Calculate</button>
<div id='anovaanswer' class='answerDiv'></div>

	</div>
	
<script>

function CalculateANOVA(){
try{
	var xbb, k, sstreatment, sserror,N,mstreatment,mserror,F,p;
	var i,j;
	var listempty=false;  
	//k is the number of lists
	k=0;
	var listsToInclude=[];
	var a= document.getElementsByClassName('anovacheckbox');
	for (i=0;i<numLists;i++)
		if (listN[i]==0) a[i].checked=false;
	for (i=0;i<numLists;i++)
		if (a[i].checked) {
			k++; 
			listsToInclude.push(i);
		}
	if (k<3)
		alert('Select three or more nonempty lists.');
	else{ 
		var P=[];
		for (i=0;i<k;i++){
			P[i]=[];
			l=listsToInclude[i];
			for (j=0;j<listN[l];j++){
				P[i][j]=list[l][j];
			}
		}
		var report=anovaF(P);
			F=report.F;
			p=1-fcdf(F,report.DFB,report.DFW);
			anovaanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>F='+F.TOFIXED(printPrecision)+'</li></ul>';
			anovaanswer.style.display='block';
		
	}
}
catch{
	alert('Input error.');
}
}
</script>
<!--------------------------------------------------------------------------------------------------------->
</ul>
</div> <!-- PARAMETRIC DIV -->
<div id='NonparametricDiv' class='expandable'>
<h4>Nonparametric Tests</h3>
<ul>
<!--------------------------------------------------------------------------------------------------------->
<li><button class='expander' data-open='signtestonemeanDiv' data-close='rankcorrelationDiv,KruskalWallisDiv,RankSumDiv,WSRonemeanDiv,WSRmpDiv,signmatchedDiv'>Sign Test for One Sample</button></li>

	<div id='signtestonemeanDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('signtest');
	var a=document.getElementsByClassName('signtest'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(signtestssAnswerDiv);}
	</script><br>
		<table>
	<tr><td>H<sub>1:</sub></td><td>m</td>
	<td><label><input type='radio' name='signtestsstype' id='signtestssgt' checked=true onclick='purge(signtestssAnswerDiv);'> &gt; &nbsp;</label></td>
	<td><label><input type='radio' name='signtestsstype' id='signtestssne' onclick='purge(signtestssAnswerDiv);'> &ne; &nbsp;</label></td>
	<td><label><input type='radio' name='signtestsstype' id='signtestsslt' onclick='purge(signtestssAnswerDiv);'> &lt; &nbsp;</label></td>
	<td><input type='text' id='signtestssclaimedm' value='100' onkeydown='purge(signtestssAnswerDiv);'></td>
	</tr>
	</table>

	<button onclick='CalculateSignTest();'>Calculate</button>
	<div id='signtestssAnswerDiv' class='answerDiv expandable'>
	<div id='signtestssanswer'></div>
	</div>
	</div>
<script>
function CalculateSignTest(){
try{
	var i=getChecked('signtest'); 
	var k,d;
	var x=0;
	var n=0;
	var p,q;
	var med=eval(signtestssclaimedm.value); 
	if(listN[i]==0) alert('Your list is empty.');
	else{	
		for (k=0;k<listN[i];k++){
			d=list[i][k]-med;
			if (d!=0)
				n++;
			if (d>0)
				x++;
		}
		
		//binomcdf n p x
		if (signtestsslt.checked){
			p=binomcdf(n,0.5,x); 
			}
		else if (signtestssgt.checked){
			p=1-binomcdf(n,0.5,x-1);
			}
		else{
			p=binomcdf(n,0.5,x);
			q=1-binomcdf(n,0.5,x-1);
			p=min(1,2*min(p, q));
			}
		signtestssanswer.innerHTML='<ul><li>P= '+p.TOFIXED(printPrecision)+'</li><li>n= '+n+'</li><li>above: '+x+'</li></ul>';
		signtestssAnswerDiv.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>	

<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='signmatchedDiv' data-close='rankcorrelationDiv,KruskalWallisDiv,RankSumDiv,WSRonemeanDiv,WSRmpDiv,signtestonemeanDiv'>Sign Test for Matched Pairs</button></li>

	<div id='signmatchedDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('signmpradio1');
	var a=document.getElementsByClassName('signmpradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(signmpanswer);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('signmpradio2');
	var a=document.getElementsByClassName('signmpradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(signmpanswer);}</script></td></tr>
	</table>


<table>
<tr><td>H<sub>1:</sub></td>	<td>m<sub>d</sub></td>
<td><label><input type='radio' name='signmptype' id='signmpgt' checked=true onclick='purge(signmpanswer);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='signmptype' id='signmpne' onclick='purge(signmpanswer);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='signmptype' id='signmplt' onclick='purge(signmpanswer);'> &lt; &nbsp; </label></td>
<td>0</td>
</tr>
</table>
<button onclick='CalculateSignMP();'>Calculate</button>
<div id='signmpanswer' class='answerDiv'></div>
	</div>
<script>
function CalculateSignMP(){
try{
	var i=getChecked('signmpradio1');
	var j=getChecked('signmpradio2'); 
	var k,d;
	var x=0;
	var n=0;
	var p,q;
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else if (listN[i]!=listN[j]) alert('Your lists need to be the same length.');
	else{	
		for (k=0;k<listN[i];k++){
			d=list[i][k]-list[j][k];
			if (d!=0)
				n++;
			if (d>0)
				x++;
		}
		//binomcdf n p x
		if (signmplt.checked){
			p=binomcdf(n,0.5,x); 
			}
		else if (signmpgt.checked){
			p=1-binomcdf(n,0.5,x-1);
			}
		else{
			p=binomcdf(n,0.5,x);
			q=1-binomcdf(n,0.5,x-1);
			p=min(1,2*min(p, q));
			}
		signmpanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>n= '+n+'</li><li>above: '+x+'</li></ul>';
		signmpanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>	
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='WSRonemeanDiv' data-close='rankcorrelationDiv,KruskalWallisDiv,RankSumDiv,signtestonemeanDiv,WSRmpDiv,signmatchedDiv'>Wilcoxon Signed Ranks for One Sample</button></li>

	<div id='WSRonemeanDiv' class='expandable'>
	<table>
	<tr><td>H<sub>1:</sub></td><td>m</td>
	<td><label><input type='radio' name='wsrtestsstype' id='wsrtestssgt' checked=true onclick='purge(wsrtestssAnswerDiv);'> &gt; &nbsp;</label></td>
	<td><label><input type='radio' name='wsrtestsstype' id='wsrtestssne' onclick='purge(wsrtestssAnswerDiv);'> &ne; &nbsp;</label></td>
	<td><label><input type='radio' name='wsrtestsstype' id='wsrtestsslt' onclick='purge(wsrtestssAnswerDiv);'> &lt; &nbsp;</label></td>
	<td><input type='text' id='wsrtestssclaimedm' value='100' onkeydown='purge(wsrtestssAnswerDiv);'></td>
	</tr>
	</table>
	Data List: <br>
	<script>printRadioList('wsrtest');
	var a=document.getElementsByClassName('wsrtest'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(wsrtestssAnswerDiv);}
	</script><br>
	<button onclick='CalculateWSRTest();'>Calculate</button>
	<div id='wsrtestssAnswerDiv' class='answerDiv expandable'>
	<div id='wsrtestssanswer'></div>
	</div>
	</div>
	
<script>
//------------------------------------------------------------------------------------------
function convertToBinary(num, paddingLength) {
	let binaryString = num.toString(2); 
	return binaryString.padStart(paddingLength, '0'); 
}

function WSRDIST(ranks, sums, probs){ 
	var n=ranks.length;
	var N=Math.pow(2,n);
	var i,j,mask,s,t;
	var temp=[];
	for (i=0;i<N;i++){
	mask=convertToBinary(i, n).split('');
	s=0;
	for (j=0;j<n;j++)
		s+=ranks[j]*mask[j];
	t=s.toString();
	if (temp[t]==undefined){
		sums.push(s);
		temp[t]=1;
	}
	else
		temp[t]++;
	}
	for (i in temp)
		temp[i]=temp[i]/N;
	var a=sums.toSorted(function(a, b){return a - b});
	for (i=0;i<sums.length;i++)
		sums[i]=a[i];
	for (i=0;i<sums.length;i++)
		probs[i]=temp[sums[i].toString()];
}
function discretePLeq(T, vals, probs){
	var r=0;
	var i;
	for (i=0;i<vals.length;i++){
		if (vals[i]<=T)
			r+=probs[i];
	}
	return(r);
}
function discretePGeq(T, vals, probs){
	var r=0;
	var i;
	for (i=0;i<vals.length;i++){
		if (vals[i]>=T)
			r+=probs[i];
	}
	return(r);
}

//-------------------------------------------------------------------------------------------

//WITH EXACT CALCULATIONS
function CalculateWSRTest(){console.log('entering wsrt');
try{
	var i=getChecked('wsrtest'); 
	var k,d;
	var x=0;
	var n=0;
	var p,q;
	var diffs=[];
	var avals=[];
	var ranks=[];
	var Tpos=0, Tneg=0;
	var med=eval(wsrtestssclaimedm.value); 

	if(listN[i]==0) alert('Your list is empty.');
	else{	
		for (k=0;k<listN[i];k++){
			d=list[i][k]-med;
			if (d!=0){
				diffs.push(d);
				avals.push(abs(d));
			}
		}
		
		sortWSR(diffs, avals, ranks);
		for (i=0;i<diffs.length;i++){
			if (diffs[i]<0) Tneg+=ranks[i];
			else if (diffs[i]>0) Tpos+=ranks[i];
		}		
			
		var df=diffs.length-1;
		var n=diffs.length;
		var sums=[];
		var probs=[];

		if (n <=20){var method='exact';
		WSRDIST(ranks, sums, probs);
			p=discretePLeq(Tpos, sums, probs);
			q=discretePGeq(Tpos, sums, probs);
			if (wsrtestsslt.checked){
				p=p; 
				}
			else if (wsrtestssgt.checked){
				p=q;
				}
			else{
				p=min(1,2*min(p, q));
				}				
		}
		else{var method='normal approximation'
			var m=n*(n+1)/4;
			var s=sqrt(n*(n+1)*(2*n+1)/24);
			var t=(Tpos-m)/sqrt(n*(n+1)*(2*n+1)/24);
			
			if (wsrtestsslt.checked){
				p=normalcdf(t);//tcdf(t,df); 
				}
			else if (wsrtestssgt.checked){
				p=1-normalcdf(t);//tcdf(t,df);
				}
			else{
				p=normalcdf(t);//tcdf(t,df);
				p=min(1,2*min(p, 1-p));
				}	
		}		
		wsrtestssanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>method: '+method+'</li></ul>';
		wsrtestssAnswerDiv.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}	
}
</script>		
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='WSRmpDiv' data-close='rankcorrelationDiv,KruskalWallisDiv,RankSumDiv,WSRonemeanDiv,signtestonemeanDiv,signmatchedDiv'>Wilcoxon Signed Ranks for Matched Pairs</button></li>

	<div id='WSRmpDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('wsrmpradio1');
	var a=document.getElementsByClassName('wsrmpradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(wsrmpanswer);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('wsrmpradio2');
	var a=document.getElementsByClassName('wsrmpradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(wsrmpanswer);}</script></td></tr>
	</table>


<table>
<tr><td>H<sub>1:</sub></td>	<td>m<sub>d</sub></td>
<td><label><input type='radio' name='wsrmptype' id='wsrmpgt' checked=true onclick='purge(wsrmpanswer);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='wsrmptype' id='wsrmpne' onclick='purge(wsrmpanswer);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='wsrmptype' id='wsrmplt' onclick='purge(wsrmpanswer);'> &lt; &nbsp; </label></td>
<td>0</td>
</tr>
</table>
<button onclick='CalculateWSRMP();'>Calculate</button>
<div id='wsrmpanswer' class='answerDiv'></div>
	</div>

<script>

function sortWSR(diffs, avals, ranks){
	var i,j,td, ta,r,k;
	
	for (i=0;i<diffs.length;i++){
		for (j=i+1;j<diffs.length;j++){
			if (avals[i] > avals[j]){
				td=diffs[i];
				ta=avals[i];
				diffs[i]=diffs[j];
				avals[i]=avals[j];
				diffs[j]=td;
				avals[j]=ta;
			}
		}
	}
	for (i=0;i<diffs.length;i++)
		ranks[i]=i+1;
	for (i=0;i<diffs.length-1;i++){
		if (avals[i]==avals[i+1]){
			j=0;
			r=0;
			while (avals[i]==avals[i+j]){
				r+=ranks[i+j];
				j++;
			}
			r=r/j;
			for (k=0;k<j;k++)
				ranks[i+k]=r;
			i=i+j-1;	
		}
	}
}
//ORIGINAL
function CalculateWSRMP(){
try{
	var i=getChecked('wsrmpradio1'); 
	var j=getChecked('wsrmpradio2'); 
	var k,d;
	var x=0;
	var n=0;
	var p;
	var diffs=[];
	var avals=[];
	var ranks=[];
	var Tpos=0, Tneg=0;
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else if (listN[i]!=listN[j]) alert('Your lists need to be the same length.');
	else{	
		for (k=0;k<listN[i];k++){
			d=list[i][k]-list[j][k];
			if (d!=0){
				diffs.push(d);
				avals.push(abs(d));
			}
		}
		sortWSR(diffs, avals, ranks);
		for (i=0;i<diffs.length;i++){
			if (diffs[i]<0) Tneg+=ranks[i];
			else if (diffs[i]>0) Tpos+=ranks[i];
		}
		
		var df=diffs.length-1;
		var n=diffs.length;
		var m=n*(n+1)/4;
		var s=sqrt(n*(n+1)*(2*n+1)/24);
		var t=(Tpos-m)/sqrt(n*(n+1)*(2*n+1)/24);
		
		if (wsrmplt.checked){
			p=normalcdf(t);//tcdf(t,df); 
			}
		else if (wsrmpgt.checked){
			p=1-normalcdf(t);//tcdf(t,df);
			}
		else{
			p=normalcdf(t);//tcdf(t,df);
			p=min(1,2*min(p, 1-p));
			}
		wsrmpanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li></ul>';
		wsrmpanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
//WITH EXACT
function CalculateWSRMP(){
try{
	var i=getChecked('wsrmpradio1'); 
	var j=getChecked('wsrmpradio2'); 
	var k,d;
	var x=0;
	var n=0;
	var p,q;
	var diffs=[];
	var avals=[];
	var ranks=[];
	var Tpos=0, Tneg=0;
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else if (listN[i]!=listN[j]) alert('Your lists need to be the same length.');
	else{	
		for (k=0;k<listN[i];k++){
			d=list[i][k]-list[j][k];
			if (d!=0){
				diffs.push(d);
				avals.push(abs(d));
			}
		}
		sortWSR(diffs, avals, ranks);
		for (i=0;i<diffs.length;i++){
			if (diffs[i]<0) Tneg+=ranks[i];
			else if (diffs[i]>0) Tpos+=ranks[i];
		}

		var df=diffs.length-1;
		var n=diffs.length;
		var sums=[];
		var probs=[];
		if (n <=20){var method='exact';
		WSRDIST(ranks, sums, probs);
			p=discretePLeq(Tpos, sums, probs);
			q=discretePGeq(Tpos, sums, probs);
			if (wsrmplt.checked){
				p=p; 
				}
			else if (wsrmpgt.checked){
				p=q;
				}
			else{
				p=min(1,2*min(p, q));
				}				
		}
		else{var method='normal approximation';
			var m=n*(n+1)/4;
			var s=sqrt(n*(n+1)*(2*n+1)/24);
			var t=(Tpos-m)/sqrt(n*(n+1)*(2*n+1)/24);
			
			if (wsrmplt.checked){
				p=normalcdf(t);//tcdf(t,df); 
				}
			else if (wsrmpgt.checked){
				p=1-normalcdf(t);//tcdf(t,df);
				}
			else{
				p=normalcdf(t);//tcdf(t,df);
				p=min(1,2*min(p, 1-p));
				}
		}	
		wsrmpanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>method: '+method+'</li></ul>';
		wsrmpanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>	
<!------------------------------------------------------------------------------------------------------------------------------------>

<li><button class='expander' data-open='RankSumDiv' data-close='rankcorrelationDiv,KruskalWallisDiv,WSRmpDiv,WSRonemeanDiv,signtestonemeanDiv,signmatchedDiv'>Wilcoxon Rank Sum for Two Independent Samples</button></li>

	<div id='RankSumDiv' class='expandable'>
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('RankSumradio1');
	var a=document.getElementsByClassName('RankSumradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RankSumanswer);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('RankSumradio2');
	var a=document.getElementsByClassName('RankSumradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RankSumanswer);}</script></td></tr>
	</table>


<table>
<tr><td>H<sub>1:</sub></td>	<td>m<sub>1</sub></td>
<td><label><input type='radio' name='RankSumtype' id='RankSumgt' checked=true onclick='purge(RankSumanswer);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='RankSumtype' id='RankSumne' onclick='purge(RankSumanswer);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='RankSumtype' id='RankSumlt' onclick='purge(RankSumanswer);'> &lt; &nbsp; </label></td>
<td>m<sub>2</sub></td>
</tr>
</table>
<button onclick='CalculateRankSum();'>Calculate</button>
<div id='RankSumanswer' class='answerDiv'></div>
	</div>

<script>

function combos(n,k){
	if (k==0)
		return([[]]);
	else if (k>n)
		return([]);
	else{
		var a=combos(n-1, k);
		var b=combos(n-1, k-1);
		for (let i in b)
			b[i].push(n-1);
		var c=a.concat(b);
		return(c);
	}
}

function RankSumDIST(ranks, sums, probs,K){
	var n=ranks.length;
	var sets=combos(n,K);
	var N=sets.length;
	var i,j,s,t;
	var temp=[];
	for (i=0;i<N;i++){
		s=0;
		for (j=0;j<K;j++)
			s+=ranks[sets[i][j]];
		t=s.toString();
		if (temp[t]==undefined){
			sums.push(s);
			temp[t]=1;
		}
		else
			temp[t]++;
	}
	for (i in temp)
		temp[i]=temp[i]/N;
		
	var a=sums.toSorted(function(a, b){return a - b});
	for (i=0;i<sums.length;i++)
		sums[i]=a[i];
	for (i=0;i<sums.length;i++)
		probs[i]=temp[sums[i].toString()];
}

function CalculateRankSum(){
try{
	var i=getChecked('RankSumradio1'); 
	var j=getChecked('RankSumradio2'); 
	var k,d,l;
	var x=0;
	var p=0,q;
	var set=[];
	var val=[];
	var ranks=[];
	var sums=[];
	var listsToInclude=[];
	listsToInclude.push(i);
	listsToInclude.push(j);
	var ni=[];
	if (i==j) alert('Select two different lists.');
	else if(listN[i]*listN[j]==0) alert('One of your lists is empty.');
	else{	
		for (i=0;i<listsToInclude.length;i++){
			l=listsToInclude[i];
			ni.push(listN[l]);
			for (j=0;j<listN[l];j++){
				set.push(i);
				val.push(list[l][j]);
			}
		}
		
		sortWSR(set, val, ranks);
		for (i=0;i<listsToInclude.length;i++)
			sums[i]=0;
		for (i=0;i<ranks.length;i++)
			sums[set[i]]+=ranks[i]

		var n=ranks.length;
		if (n <=20){var method='exact';
			var dsums=[];
			var probs=[];
			RankSumDIST(ranks, dsums, probs, ni[0]);
			
			p=discretePLeq(sums[0], dsums, probs);
			q=discretePGeq(sums[0], dsums, probs);
			if (RankSumlt.checked){
				p=p; 
				}
			else if (RankSumgt.checked){
				p=q;
				}
			else{
				p=min(1,2*min(p, q));
				}			
		}
		else{var method='normal distribution';
			var n1=ni[0];
			var n2=ni[1];
			var R=sums[0];

			var m=n1*(n1+n2+1)/2;
			var s=sqrt(n1*n2*(n1+n2+1)/12);
			var z=(R-m)/s;

			p=normalcdf(z);
			q=1-p;
			if (RankSumlt.checked){
				p=p; 
				}
			else if (RankSumgt.checked){
				p=q;
				}
			else{
				p=min(1,2*min(p, q));
				}
		}		
		RankSumanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>method: '+method+'</li></ul>';
		RankSumanswer.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>	

<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='KruskalWallisDiv' data-close='rankcorrelationDiv,anovaDiv,RankSumDiv,WSRonemeanDiv,WSRmpDiv,signtestonemeanDiv,signmatchedDiv'>Kruskal-Wallis Test (ANOVA on ranks)</button> </li>
	<div id='KruskalWallisDiv' class='expandable'>
Select at least three lists to include in the test.<br>
Lists: <script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  id='kwlist"+i+"' onclick='purge(kwanswer);'  class='kwcheckbox'><span class='kwlabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('kw'+'label');			
	var a=document.getElementsByClassName('kwcheckbox');
	a[0].checked=true;
	a[1].checked=true;
	a[2].checked=true;
</script><br>
<button onclick='CalculateKruskalWallis();'>Calculate</button>
<div id='kwanswer' class='answerDiv'></div>
	</div>
	
<script>
function CalculateKruskalWallis(){
try{
	var i,j,l;
	var listempty=false;  
	//k is the number of lists
	var k=0;
	var a= document.getElementsByClassName('kwcheckbox');
	var listsToInclude=[];
	var ni=[];
	var set=[];
	var val=[];
	var ranks=[];
	var sums=[];
	for (i=0;i<numLists;i++)
		if (listN[i]==0) a[i].checked=false;
	for (i=0;i<numLists;i++)
		if (a[i].checked) {
			k++; 
			listsToInclude.push(i);
		}
	if (k<3)
		alert('Select three or more nonempty lists.');
	else{ 
		for (i=0;i<listsToInclude.length;i++){
			l=listsToInclude[i];
			ni.push(listN[l]);
			for (j=0;j<listN[l];j++){
				set.push(i);
				val.push(list[l][j]);
			}
		}
		
		sortWSR(set, val, ranks);
		for (i=0;i<listsToInclude.length;i++)
			sums[i]=0;
		for (i=0;i<ranks.length;i++)
			sums[set[i]]+=ranks[i]
		//console.log(ni);
		//console.log(ranks);
		//console.log(sums);
		var N=0;
		for (i=0;i<k;i++)
			N+=ni[i];
		var H=0;
		for (i=0;i<k;i++)
			H+=sums[i]*sums[i]/ni[i];
		H=H*12/(N*(N+1));
		H=H-3*(N+1);
		//console.log(H);
		var p=1-chi2cdf(H, k-1);
		//console.log(p);
		kwanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>H: '+H.TOFIXED(printPrecision)+'</li></ul>';
		kwanswer.style.display='block';
		
	}
}
catch(err){
	alert('Input Error.');
}		
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='rankcorrelationDiv' data-close='KruskalWallisDiv,RankSumDiv,WSRonemeanDiv,WSRmpDiv,signtestonemeanDiv,signmatchedDiv'>Rank Correlation</button></li>

	<div id='rankcorrelationDiv' class='expandable'>
	
	<table>
	<tr><td>X:</td>
	<td><script>printRadioList('rankcorradiox');
	var a=document.getElementsByClassName('rankcorradiox'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(rankcoranswerDiv);}</script></td></tr>
	<tr><td>Y:</td>
	<td><script>printRadioList('rankcorradioy');
	var a=document.getElementsByClassName('rankcorradioy'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(rankcoranswerDiv);}</script></td></tr>
	</table>
<br>
<button onclick='rankCalculateCorrelation();'>Calculate</button>
<div id='rankcoranswerDiv' class='answerDiv'>
<div id='rankcoranswer'></div>
<canvas id='rankcorcanvas' width=400 height=400></canvas>
</div>
</div>

<script>
//sortWSR(diffs, avals, ranks)
function rankCalculateCorrelation(){
try{
	var l1=getChecked('rankcorradiox');
	var l2=getChecked('rankcorradioy');
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else if (listN[l1]!=listN[l2]) alert('Your lists need to be the same length.');
	else{	
		var sumprod, sumx, sumy, sumx2,r, P, t,i,j,n,m,b;
		var ranksX=[], ranksY=[];
		var n=listN[l1];
		var dummy=[];
		var tv, tr,td;
		
		for (i=0;i<n;i++)
			dummy[i]=i;
			
		sortWSR(dummy, list[l1], ranksX)		
		//put list back in order		
		for (i=0;i<n;i++)
			for (j=i+1;j<n;j++)
				if (dummy[i]>dummy[j]){
					tv=list[l1][i];
					tr=ranksX[i];
					td=dummy[i];
					list[l1][i]=list[l1][j];
					ranksX[i]=ranksX[j];
					dummy[i]=dummy[j];
					list[l1][j]=tv;
					ranksX[j]=tr;
					dummy[j]=td;
				}
				
		for (i=0;i<n;i++)
			dummy[i]=i;
			
		sortWSR(dummy, list[l2], ranksY)		
		for (i=0;i<n;i++)
			for (j=i+1;j<n;j++)
				if (dummy[i]>dummy[j]){
					tv=list[l2][i];
					tr=ranksY[i];
					td=dummy[i];
					list[l2][i]=list[l2][j];
					ranksY[i]=ranksY[j];
					dummy[i]=dummy[j];
					list[l2][j]=tv;
					ranksY[j]=tr;
					dummy[j]=td;
				}
				
		var summaryX=summarizeArray(ranksX);
		var summaryY=summarizeArray(ranksY);
		
		
		sumx=summaryX.sum;
		sumy=summaryY.sum
		sumprod=0;
		sumx2=0;
		for (i=0;i<n;i++){
			sumprod+=ranksX[i]*ranksY[i];
			sumx2+=ranksX[i]*ranksX[i];
			}
		m=(n*sumprod-sumx*sumy)/(n*sumx2-sumx*sumx);
		b=(sumy*sumx2-sumx*sumprod)/(n*sumx2-sumx*sumx);

		r=m*summaryX.s/summaryY.s;
if (r==1) {t=Infinity; P=0;}
else{
		t=r/Math.sqrt((1-r*r)/(n-2));
		P=2*(1-tcdf(Math.abs(t),n-2));
}		
		rankcoranswer.innerHTML='<ul><li>y=mx+b</li><li>m='+m.TOFIXED(printPrecision)+'</li><li>b='+b.TOFIXED(printPrecision)+'</li><li>t='+t.TOFIXED(printPrecision)+'</li><li>df='+(n-2)+'</li><li>P='+P.TOFIXED(printPrecision)+'</li><li>r='+r.TOFIXED(printPrecision)+'</li></ul>';
//	var l1=-1, l2=-1;
	var D=40;

	if (false){
		//var xlist=l1;
		//var ylist=l2;
		var can=rankcorcanvas;
		var ctx=can.getContext('2d');
		var w=can.width;
		var h=can.height;
		var xmin=summaryX.min;//listMin[xlist];
		var xmax=summaryX.max;//listMax[xlist];
		var ymin=summaryY.min;//listMin[ylist];
		var ymax=summaryY.max;//listMax[ylist];
		//var n = listN[xlist];
		var W=w-2*D;
		var H=h-2*D;
		var wx=xmax-xmin;
		var wy=ymax-ymin;

		ctx.strokeStyle='gray';
		ctx.fillStyle='white';
		ctx.lineWidth=1;
		ctx.fillRect(0,0,w,h);
		ctx.beginPath();
		ctx.rect(0,0,w,h);
		ctx.rect(D,D,W,H);
		ctx.stroke();
		ctx.strokeStyle='black';
		for (i=0;i<n;i++){
			ctx.beginPath();
			ctx.arc(D+W*(ranksX[i]-xmin)/wx, h-(D+H*(ranksY[i]-ymin)/wy), 1,0,2*Math.PI);
			ctx.stroke();
		}
		ctx.font='12px Helvetica';
		ctx.fillStyle='black';
		var dx=(xmax-xmin)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6+W*(j*dx)/wx, h-D+6); 
			ctx.rotate(PI/2);
			ctx.fillText((xmin+j*dx).TOFIXED(2),0,0);
			ctx.restore();
		}		
		var dy=(ymax-ymin)/10;
		for (j=0;j<11;j++){
			ctx.save();
			ctx.translate(D-6,h-(D-6+H*(j*dy)/wy)); 
			ctx.textAlign='end';
			ctx.fillText((xmin+j*dy).TOFIXED(2),0,0);
			ctx.restore();
		}		
		ctx.strokeStyle='red';
		ctx.beginPath()
		var y1=m*xmin+b;
		var y2=m*xmax+b;
//ctx.arc(D+W*(list[xlist][i]-xmin)/wx, h-(D+H*(list[ylist][i]-ymin)/wy), 1,0,2*Math.PI);		
		ctx.moveTo(D+W*(xmin-xmin)/wx, h-(D+H*(y1-ymin)/wy));
		ctx.lineTo(D+W*(xmax-xmin)/wx, h-(D+H*(y2-ymin)/wy));
		ctx.stroke();
	}	
		
		rankcoranswerDiv.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}		
}

</script>
<!------------------------------------------------------------------------------------------------------------------------------------>
<li><button class='expander' data-open='runstestDiv' data-close='signtestonemeanDiv,rankcorrelationDiv,KruskalWallisDiv,RankSumDiv,WSRonemeanDiv,WSRmpDiv,signmatchedDiv'>Runs Test for Randomness</button></li>

	<div id='runstestDiv' class='expandable'>
	Data List: <br>
	<script>printRadioList('runstest');
	var a=document.getElementsByClassName('runstest'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(runstestAnswerDiv);}
	</script><br>
	<button onclick='CalculateRunsTest();'>Calculate</button>
	<div id='runstestAnswerDiv' class='answerDiv expandable'>
	<div id='runstestanswer'></div>
	</div>
	</div>
<script>
function choose(n,k){
	if (n==k)
		return(1)
	else if (k==0)
		return(1);
	else if (n==0)
		return(0)
	else if (k==1)
		return(n)
	else return(choose(n-1,k)+choose(n-1, k-1));
}
function runpdf(n1,n2,u){
	var k;
	if (u%2==0){
		k=u/2;
		return(2*choose(n1-1,k-1)*choose(n2-1,k-1)/choose(n1+n2,n1));
	}
	else{
		k=(u-1)/2;
		return((choose(n1-1,k)*choose(n2-1,k-1)+choose(n1-1,k-1)*choose(n2-1,k))/choose(n1+n2,n1));
	}
}
function runcdfLTE(n1, n2, u){
	if (u<2) return(0);
	else{
		var r=0;
		for (let U=2;U<=u;U++){
			r+=runpdf(n1,n2,U); 
		}
		return(r);	
	}
}
function runcdfGTE(n1, n2, u){
	if (u<2) return(0);
	else{
		var m=min(n1,n2);
		var r=0;
		for (let U=u;U<=m;U++)
			r+=runpdf(n1,n2,U);
		return (r);	
	}
}
function CalculateRunsTest(){
try{
	var l=getChecked('runstest'); 
	var med=eval(signtestssclaimedm.value); 
	if(listN[l]==0) alert('Your list is empty.');
	else{
		var med=listQ2[l];
		var p,q;
		var D=[];
		var i;
		var n0=0;
		var n1=0;
		var n=listN[l];
		var elements=[];
		elements.push(list[l][0]);
		for (i=1;i<n;i++)
			if (elements.indexOf(list[l][i])==-1)
				elements.push(list[l][i]);
		if (elements.length == 2)
			med=(listMax[l]+listMin[l])/2;
		for (i=0;i<n;i++)
			if (list[l][i]>=med){
				D.push(1);
				n0++;
			}
			else {
				D.push(0);
				n1++;
			}
		var R=0;
		for (i=0;i<n;i++)
			if (D[i]!=D[i+1])
				R++;		
				
		if (n<=20){var method='exact';
			p=runcdfLTE(n0,n1,R);
			q=runcdfGTE(n0,n1,R);
			p=min(1,2*min(p,q));
		}
		else{var method='normal approximation';
			var m=2*n0*n1/n+1;
			var s=sqrt(2*n0*n1*(2*n0*n1-n)/(n*n*(n-1)));
			var z=(R-m)/s;		
			p=2*normalcdf(-abs(z));
		}
		runstestanswer.innerHTML='<ul><li>P='+p.TOFIXED(printPrecision)+'</li><li>z='+z.TOFIXED(printPrecision)+'</li><li>n: '+n+'</li><li>runs: '+R+'</li><li>above: '+n0+'</li><li>below: '+n1+'</li></ul>';
		runstestAnswerDiv.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}
}
</script>
<!------------------------------------------------------------------------------------------------------------------------------------>

</ul>	
</div> <!-- NONPARAMETRIC DIV -->
<!------------------------------------------------------------------------------------------------------------------------------------>
	

<div id='ResampleDiv' class='expandable'>
<h4>Resampling Tests</h3>
<ul>
<li><button class='expander' data-open='resampleAbout' data-close='OnePropResample,OneMeanResample,TwoPropResample,TwoMeanResample,MPResample,CorrelationResample,GOFResample,CTResample,ANOVAResample'>About</button></li>
<div id='resampleAbout' class='expandable'>
<p>
In these tests, an ideal population is created satisfying the null hypothesis. Then 10,000 samples are drawn from the ideal population, and a test statistic is computed for each sample. The P-value is the proportion of the samples with test statistics as extreme as the original. 
Each test gives a histogram indicating the test statistics for the 10,000 samples. The original test statistic is displayed in green, and the extreme test statistics are displayed in red.
</p>
<p>
The test statistics used are:
<table border=1>
<tr><td>One Proportion</td><td>sample propotions</td></tr>
<tr><td>One Mean</td><td>sample mean</td></tr>
<tr><td>Two Proportions</td><td>difference of sample proportions</td></tr>
<tr><td>Two Means</td><td>difference of sample means</td></tr>
<tr><td>Matched Pairs</td><td>mean of paired differences</td></tr>
<tr><td>Correlation</td><td>Pearson correlation coefficient</td></tr>
<tr><td>Goodness of Fit</td><td>&chi;<sup>2</sup></td></tr>
<tr><td>Contingency Table</td><td>&chi;<sup>2</sup></td></tr>
<tr><td>ANOVA</td><td>F</td></tr>
</table>
</p>
</div>

<li><button class='expander' data-open='OnePropResample' data-close='resampleAbout,OneMeanResample,TwoPropResample,TwoMeanResample,MPResample,CorrelationResample,GOFResample,CTResample,ANOVAResample'>One Proportion</button></li>
<div id='OnePropResample' class='expandable'>
<!--Create a population of 0s and 1s to match the hypothesized proportion. Resample from this population with replacement and count how many resamples have means at least as extreme as the original data.-->

	<table>
	<tr><td>Successes:</td> <td>x=</td><td><input type='text' id='RSpropx' value="50" onkeydown='purge(RSpropAnswerDiv);' ></td></tr>
	<tr><td>Sample Size:</td><td>n=</td><td><input type='text' id='RSpropn' value="100" onkeydown='purge(RSpropAnswerDiv);'  ></td></tr>
	</table>
	<table>
	<tr><td>H<sub>1:</sub></td>	<td>p</td>
	<td><label><input type='radio' name='RSproptype' id='RSpropgt' checked=true onclick='purge(RSpropAnswerDiv);'> &gt; &nbsp; </label></td>
	<td><label><input type='radio' name='RSproptype' id='RSpropne' onclick='purge(RSpropAnswerDiv);'> &ne; &nbsp; </label></td>
	<td><label><input type='radio' name='RSproptype' id='RSproplt' onclick='purge(RSpropAnswerDiv);'> &lt; &nbsp; </label></td>
	<td><input type='text' id='RSpropcp' value='0.5' onkeydown='purge(RSpropAnswerDiv);'></td>
	</tr>
	</table>
	<button onclick='RSCalculateOneProp();'>Calculate</button><br>
	<div id='RSpropAnswerDiv' class='answerDiv expandable'>
	<div id='RSpropanswer'></div>
	<canvas id='RSpropcanvas' width="400" height="200"></canvas>
	</div>
</div>
<script>
function RSCalculateOneProp(){
try{
	var n=eval(RSpropn.value);
	var x=eval(RSpropx.value);
	var hp=eval(RSpropcp.value);
	if (!((hp>0)&&(hp<1))) alert('The claimed proportion should be between 0 and 1');
	else{
		var phat=x/n;
		var i,s;
		var numSamples=globalNumSamples;
		var population=[];
		var sample=[];
		var popSize=1000;
		var sampleMeans=[];
		for (i=0;i<popSize*hp;i++)
			population.push(1);
		for (;i<popSize;i++)
			population.push(0);
		var lowerCutoff=(hp-abs(phat-hp));
		var upperCutoff=(hp+abs(phat-hp));
		var plt=0;
		var pgt=0;
		for (s=0;s<numSamples;s++){
			sample=[];
			for (i=0;i<n;i++)
				sample.push(population[floor(random()*popSize)]);
			var r=summarizeArray(sample);
			sampleMeans.push(r.m);
			if (r.sum<=x) plt++;
			if (r.sum>=x) pgt++;
		}
		var p;
		var bounds=[];
			if ((RSproplt.checked)) {p=plt/numSamples; bounds=[phat,null]}
			else if ((RSpropgt.checked)) {p=pgt/numSamples; bounds=[null,phat];}
			else {p=min(1,2*min(plt, pgt)/numSamples); bounds=[lowerCutoff, upperCutoff];}
		var dummy=[phat];
		
		drawBootSummary(RSpropcanvas, sampleMeans,dummy, [], [],bounds);
		RSpropanswer.innerHTML='P= '+p.TOFIXED(printPrecision);
		RSpropAnswerDiv.style.display='block';
	}
}
catch{
	alert('Input Error.');
}
}
</script>


<li><button class='expander' data-open='OneMeanResample' data-close='resampleAbout,OnePropResample,TwoPropResample,TwoMeanResample,MPResample,CorrelationResample,GOFResample,CTResample,ANOVAResample'>One Mean</button></li>
<div id='OneMeanResample' class='expandable'>
<!--Modify the original data to have the hypothesized mean. Then resample the modified data with replacement and count how many resamples have means at least as extreme as the original data.-->
	Data List: <br>
	<script>printRadioList('RSonemeantest');
	var a=document.getElementsByClassName('RSonemeantest'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RSonemeanAnswerDiv);}
	</script><br>
	<table>
	<tr><td>H<sub>1:</sub></td><td>&mu;</td>
	<td><label><input type='radio' name='RSonemeantype' id='RSonemeangt' checked=true onclick='purge(RSonemeanAnswerDiv);'> &gt; &nbsp;</label></td>
	<td><label><input type='radio' name='RSonemeantype' id='RSonemeanne' onclick='purge(RSonemeanAnswerDiv);'> &ne; &nbsp;</label></td>
	<td><label><input type='radio' name='RSonemeantype' id='RSonemeanlt' onclick='purge(RSonemeanAnswerDiv);'> &lt; &nbsp;</label></td>
	<td><input type='text' id='RSonemeanssclaimedm' value='100' onkeydown='purge(RSonemeanAnswerDiv);'></td>
	</tr>
	</table>

	<button onclick='RSCalculateMeanTest();'>Calculate</button>
	<div id='RSonemeanAnswerDiv' class='answerDiv expandable'>
	<div id='RSonemeananswer'></div>
	<canvas id='RSmeancanvas' width="400" height="200"></canvas>
	</div>
</div>
<script>
function RSCalculateMeanTest(){
try{
	var l=getChecked('RSonemeantest');
	var n=listN[l];
	if (n==0) alert('Your list is empty.');
	else{
		var hm=eval(RSonemeanssclaimedm.value)
		var population=[];
		var i,s;
		var m=listM[l];
		for (i=0;i<n;i++)
			population[i]=list[l][i]-m+hm;
		var sample=[];
		var sampleMeans=[];
		var numSamples=globalNumSamples;
		var plt=0;
		var pgt=0;
		var r;
		for (s=0;s<numSamples;s++){
			sample=[];
			for (i=0;i<n;i++){
				sample.push(population[floor(random()*n)]);
			}
			r=summarizeArray(sample);
			sampleMeans.push(r.m);
			if (r.m<=m) plt++;
			if (r.m>=m) pgt++;
		}
		var p;
		var bounds=[];
		var lowerCutoff=hm-abs(m-hm);
		var upperCutoff=hm+abs(m-hm);
		
			if ((RSonemeanlt.checked)) {p=plt/numSamples; bounds=[m,null];}
			else if ((RSonemeangt.checked)) {p=pgt/numSamples; bounds=[null,m];}
			else {p=min(1,2*min(plt, pgt)/numSamples); bounds=[lowerCutoff, upperCutoff];}
		var dummy=[m];
		drawBootSummary(RSmeancanvas, sampleMeans,dummy, [], [], bounds);
		RSonemeananswer.innerHTML='P= '+p.TOFIXED(printPrecision);
		RSonemeanAnswerDiv.style.display='block';
	}
}
catch{
	alert('Input error.');
}
}
</script>
<li><button class='expander' data-open='TwoPropResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoMeanResample,MPResample,CorrelationResample,GOFResample,CTResample,ANOVAResample'>Two Proportions</button></li>
<div id='TwoPropResample' class='expandable'>
<!--Combine the two samples of 0s and 1s into one population. Then resample WITHOUT replacement to create samples with the original sizes. Count how many have differences as extreme as the original data.-->
	<table border=1>
	<tr><th>Sample 1</th><th>Sample 2</th></tr>
	<tr><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>1</sub>=</td><td><input type='text' id='RStwopropx1' value="45" onkeydown='purge(RStwopropanswer);'></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>1</sub>=</td><td><input type='text' id='RStwopropn1' value="100" onkeydown='purge(RStwopropanswer);' ></td></tr>
	</table>
	</td><td>
	<table>
	<tr><td>Successes:</td> <td>x<sub>2</sub>=</td><td><input type='text' id='RStwopropx2' value="50" onkeydown='purge(RStwopropanswer);' ></td></tr>
	<tr><td>Sample Size:</td><td>n<sub>2</sub>=</td><td><input type='text' id='RStwopropn2' value="100" onkeydown='purge(RStwopropanswer);' ></td></tr>
	</table>
	</td><tr>
	</table>

	<table>
	<tr><td>H<sub>1:</sub></td>	<td>p<sub>1</sub></td>
	<td><label><input type='radio' name='RStwoproptype' id='RStwopropgt' checked=true onclick='purge(RStwopropanswer);'> &gt; &nbsp; </label></td>
	<td><label><input type='radio' name='RStwoproptype' id='RStwopropne' onclick='purge(RStwopropanswer);'> &ne; &nbsp; </label></td>
	<td><label><input type='radio' name='RStwoproptype' id='RStwoproplt' onclick='purge(RStwopropanswer);'> &lt; &nbsp; </label></td>
	<td>p<sub>2</sub></td>
	</tr>
	</table>
	<button onclick='RSCalculateTwoProp();'>Calculate</button>
	<div id='RStwopropanswer' class='answerDiv expandable' >
	<div id='RStwoproprealanswer'></div>
	<canvas id='RStwopropcanvas' width="400" height="200"></canvas>
	</div>
</div>
<script>
function permute(a,b){
	var c=[];
	var i,j;
	var tb,tc;
	for (i=0;i<a.length;i++){
		b[i]=a[i];
		c[i]=random();
	}
	for (i=0;i<a.length;i++)
		for (j=i+1;j<a.length;j++)
			if (c[j]<c[i]){
				tc=c[i];
				tb=b[i];
				c[i]=c[j];
				b[i]=b[j];
				c[j]=tc;
				b[j]=tb;
			}
}
function RSCalculateTwoProp(){
try{
	var x1=eval(RStwopropx1.value);
	var n1=eval(RStwopropn1.value);
	var x2=eval(RStwopropx2.value);
	var n2=eval(RStwopropn2.value);
	if (!(n1>0) || !(n2>0)) alert('The sample size should be positive.');
	else if (!(x1>0) || !(x2>0)) alert('The number of successes should be positive.');
	else{ 
		var phat1=x1/n1;
		var phat2=x2/n2;
		var firstDiff=phat1-phat2;
//console.log(firstDiff);		
		var n=n1+n2;
		var i,j,s,d;
		var population=[];
		var permuted=[]
		var sample1=[];
		var sample2=[];
		var r1,r2;
		var sampleMeans=[];
		var plt=0;
		var pgt=0;
		var numSamples=globalNumSamples;
		for (i=0;i<x1;i++)
			population.push(1);
		for (;i<n1;i++)
			population.push(0);
		for (;i<n1+x2;i++)
			population.push(1);
		for (;i<n;i++)
			population.push(0);
//console.log(x1,n1);
//console.log(x2,n2);
//console.log(n);
//console.log(population);			
		for (s=0;s<numSamples;s++){
			sample1=[];
			sample2=[];
			permuted=[];
			permute(population, permuted);
			for (i=0;i<n1;i++)
				sample1.push(permuted[i]);
			for (;i<n;i++)
				sample2.push(permuted[i]);
			r1=summarizeArray(sample1);
			r2=summarizeArray(sample2);
			d=r1.m-r2.m;
			sampleMeans.push(d);
			if (d<=firstDiff) plt++;
			if (d>=firstDiff) pgt++;
		}
		var p;
		var bounds=[];
		var lowerCutoff=-abs(firstDiff);
		var upperCutoff=abs(firstDiff);
			if ((RStwoproplt.checked)) {p=plt/numSamples; bounds=[firstDiff,null];}
			else if ((RStwopropgt.checked)) {p=pgt/numSamples; bounds=[null,firstDiff];}
			else {p=min(1,2*min(plt, pgt)/numSamples); bounds=[lowerCutoff, upperCutoff];}
		var dummy=[firstDiff];
		drawBootSummary(RStwopropcanvas, sampleMeans,dummy, [], [], bounds);
		RStwoproprealanswer.innerHTML='P= '+p.TOFIXED(printPrecision);
		RStwopropanswer.style.display='block';		
	}
	
}
catch{
	alert('Input error.');
}
}
</script>
<li><button class='expander' data-open='TwoMeanResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoPropResample,MPResample,CorrelationResample,GOFResample,CTResample,ANOVAResample'>Two Independent Means</button></li>
<div id='TwoMeanResample' class='expandable'>
<!--Combine the two samples into one population. Then resample WITHOUT replacement to create samples with the original sizes. Count how many have differences as extreme as the original data.-->
	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('RStwomeanradio1');
	var a=document.getElementsByClassName('RStwomeanradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RStwomeanAnswerDiv);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('RStwomeanradio2');
	var a=document.getElementsByClassName('RStwomeanradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RStwomeanAnswerDiv);}</script></td></tr>
	</table>


<table>
<tr><td>H<sub>1:</sub></td>	<td>&mu;<sub>1</sub></td>
<td><label><input type='radio' name='RStwomeantype' id='RStwomeangt' checked=true onclick='purge(RStwomeanAnswerDiv);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='RStwomeantype' id='RStwomeanne' onclick='purge(RStwomeanAnswerDiv);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='RStwomeantype' id='RStwomeanlt' onclick='purge(RStwomeanAnswerDiv);'> &lt; &nbsp; </label></td>
<td>&mu;<sub>2</sub></td>
</tr>
</table>
<button onclick='RSCalculateTwoMean();'>Calculate</button>
<div id='RStwomeanAnswerDiv' class='answerDiv'>
	<div id='RStwomeananswer'></div>
	<canvas id='RStwomeancanvas' width="400" height="200"></canvas>
</div>
</div>
<script>
function RSCalculateTwoMean(){
try{
	var l1=getChecked('RStwomeanradio1');
	var l2=getChecked('RStwomeanradio2');
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else{	
		var n1=listN[l1];
		var n2=listN[l2];
		var n=n1+n2;
		var firstDiff=listM[l1]-listM[l2];
		var population=[];
		var i,s;
		for (i=0;i<n1;i++)
			population.push(list[l1][i]);
		for (i=0;i<n2;i++)
			population.push(list[l2][i]);
		var sample1=[];
		var sample2=[];
		var permuted=[];
		var sampleMeans=[];
		var numSamples=globalNumSamples;
		var r1, r2, d;
		var plt=0;
		var pgt=0;
		for (s=0;s<numSamples;s++){
			sample1=[];
			sample2=[];
			permuted=[];
			permute(population, permuted);
			for (i=0;i<n1;i++) sample1.push(permuted[i]);
			for (;i<n;i++) sample2.push(permuted[i]);
			r1=summarizeArray(sample1);
			r2=summarizeArray(sample2);
			d=r1.m-r2.m;
			sampleMeans.push(d);
			if (d<=firstDiff) plt++;
			if (d>=firstDiff) pgt++;
		}
		var p;
		var bounds=[];
		var lowerCutoff=-abs(firstDiff);
		var upperCutoff=abs(firstDiff);
			if ((RStwomeanlt.checked)) {p=plt/numSamples; bounds=[firstDiff,null];}
			else if ((RStwomeangt.checked)) {p=pgt/numSamples; bounds=[null,firstDiff];}
			else {p=min(1,2*min(plt, pgt)/numSamples); bounds=[lowerCutoff, upperCutoff];}
		var dummy=[firstDiff];
		drawBootSummary(RStwomeancanvas, sampleMeans,dummy, [], [], bounds);
		RStwomeananswer.innerHTML='P= '+p.TOFIXED(printPrecision);
		RStwomeanAnswerDiv.style.display='block';				
	}
}
catch{
	alert('Input error.');
}
}
</script>


<li><button class='expander' data-open='MPResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoPropResample,TwoMeanResample,CorrelationResample,GOFResample,CTResample,ANOVAResample'>Matched Pairs</button></li>
<div id='MPResample' class='expandable'>
<!--Calculate the absolute value of the difference of each pair. Randomly assign a positive or negative to each and average. Count how many times the result is as extreme as the original difference.-->

	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('RSmpradio1');
	var a=document.getElementsByClassName('RSmpradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RSmpAnswerDiv);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('RSmpradio2');
	var a=document.getElementsByClassName('RSmpradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RSmpAnswerDiv);}</script></td></tr>
	</table>


<table>
<tr><td>H<sub>1:</sub></td>	<td>&mu;<sub>d</sub></td>
<td><label><input type='radio' name='RSmptype' id='RSmpgt' checked=true onclick='purge(RSmpAnswerDiv);'> &gt; &nbsp; </label></td>
<td><label><input type='radio' name='RSmptype' id='RSmpne' onclick='purge(RSmpAnswerDiv);'> &ne; &nbsp; </label></td>
<td><label><input type='radio' name='RSmptype' id='RSmplt' onclick='purge(RSmpAnswerDiv);'> &lt; &nbsp; </label></td>
<td>0</td>
</tr>
</table>
<button onclick='RSCalculateMP();'>Calculate</button>
<div id='RSmpAnswerDiv' class='answerDiv'>
	<div id='RSmpanswer'></div>
	<canvas id='RSmpcanvas' width="400" height="200"></canvas>
</div>
</div>
<script>
function rpm(){
	return(2*round(random())-1);
}
function RSCalculateMP(){
try{
	var l1=getChecked('RSmpradio1');
	var l2=getChecked('RSmpradio2');
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else if (listN[l1]!=listN[l2]) alert('Your lists need to be the same length.');
	else{	
		var n=listN[l1];
		var diffs=[];
		var i;
		for (i=0;i<n;i++)
			diffs[i]=(list[l1][i]-list[l2][i]);
		var r=summarizeArray(diffs);
		var d=r.m;
		for (i=0;i<n;i++)
			diffs[i]=abs(diffs[i]);
		var sample=[];
		var numSamples=globalNumSamples;
		var plt=0;
		var pgt=0;
		var sampleMeans=[];
		for (s=0;s<numSamples;s++){
			sample=[];
			for (i=0;i<n;i++)
				sample[i]=rpm()*diffs[i];
			r=summarizeArray(sample);
			sampleMeans.push(r.m);
			if (r.m>=d) pgt++;
			if (r.m<=d) plt++;
		}	
		var p;
		var bounds=[];
		var lowerCutoff=-abs(d);
		var upperCutoff=abs(d);
		
			if ((RSmplt.checked)) {p=plt/numSamples; bounds=[d,null];}
			else if ((RSmpgt.checked)) {p=pgt/numSamples; bounds=[null,d];}
			else {p=min(1,2*min(plt, pgt)/numSamples); bounds=[lowerCutoff, upperCutoff];}
		var dummy=[d];
		drawBootSummary(RSmpcanvas, sampleMeans,dummy, [], [], bounds);
		RSmpanswer.innerHTML='P= '+p.TOFIXED(printPrecision);
		RSmpAnswerDiv.style.display='block';
		
	}	
}
catch{
	alert('Input error.');
}
}
</script>


<li><button class='expander' data-open='CorrelationResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoPropResample,TwoMeanResample,MPResample,GOFResample,CTResample,ANOVAResample'>Correlation</button></li>
<div id='CorrelationResample' class='expandable'>
<!--Hold the x-values fixed and shuffle the y-values. Calculate r for each shuffle and count how many times the result is as extreme as the original.-->

	<table>
	<tr><td>List 1:</td>
	<td>
	<script>printRadioList('RScorradio1');
	var a=document.getElementsByClassName('RScorradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RScorAnswerDiv);}</script></td></tr>
	<tr><td>List 2:</td>
	<td><script>printRadioList('RScorradio2');
	var a=document.getElementsByClassName('RScorradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RScorAnswerDiv);}</script></td></tr>
	</table>

<button onclick='RSCalculateCor();'>Calculate</button>
<div id='RScorAnswerDiv' class='answerDiv'>
	<div id='RScoranswer'></div>
	<canvas id='RScorcanvas' width="400" height="200"></canvas>
</div>
</div>
<script>
function corReport(a,b){
		var sumprod, sumx, sumy, sumx2,r, P, t,i,j,n,m,b;
		var r1=summarizeArray(a);
		var r2=summarizeArray(b);
		
		n=r1.n;
		sumx=r1.sum;
		sumy=r2.sum;
		sumprod=0;
		sumx2=0;
		for (i=0;i<n;i++){
			sumprod+=a[i]*b[i];
			sumx2+=a[i]*a[i];
			}
		m=(n*sumprod-sumx*sumy)/(n*sumx2-sumx*sumx);
		b=(sumy*sumx2-sumx*sumprod)/(n*sumx2-sumx*sumx);

		r=m*r1.s/r2.s;
		return({r: r, m: m, b: b})
}
function RSCalculateCor(){

try{
	var l1=getChecked('RScorradio1');
	var l2=getChecked('RScorradio2');
	var i,s;
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else if (listN[l1]!=listN[l2]) alert('Your lists need to be the same length.');
	else{	
	
		var report=corReport(list[l1], list[l2]);
		var r=report.r;
		var m=report.m;
		var b=report.b;
		var sumprod, sumx, sumy, sumx2,r, P, t,i,j,n,m,b;
		var P=0;
		
		var numSamples=globalNumSamples;
		var sampleMeans=[];
		var permuted=[];
		var plt=0;
		var pgt=0;
		var report;
		
		for (s=0;s<numSamples;s++){
			permuted=[];
			permute(list[l2], permuted);
			report=corReport(list[l1], permuted);
			if (report.r<=r) plt++;
			if (report.r>=r) pgt++;
			sampleMeans.push(report.r);
		}
		var bounds=[];
		var lowerCutoff=-abs(r);
		var upperCutoff=abs(r);
		P=min(1,2*min(plt, pgt)/numSamples);
		bounds=[lowerCutoff, upperCutoff];
		var dummy=[r];
		drawBootSummary(RScorcanvas, sampleMeans,dummy, [], [], bounds);
		
		RScoranswer.innerHTML='<ul><li>y=mx+b</li><li>m='+m.TOFIXED(printPrecision)+'</li><li>b='+b.TOFIXED(printPrecision)+'</li><li>P='+P.TOFIXED(printPrecision)+'</li><li>r='+r.TOFIXED(printPrecision)+'</li></ul>';
		RScorAnswerDiv.style.display='block';
	}
}
catch(err){
	alert('Input Error.');
}

}
</script>

<li><button class='expander' data-open='GOFResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoPropResample,TwoMeanResample,MPResample,CorrelationResample,CTResample,ANOVAResample'>Goodness of Fit</button></li>
<div id='GOFResample' class='expandable'>
<!--Create a population with the expected distribution. Resample from this population WITH REPLACEMENT many times and compute a Chi-Squared stat for each resample. Compare to the original.-->
	<table>
	<tr><td>Observed:</td>
	<td>
	<script>printRadioList('RSGOFradio1');
	var a=document.getElementsByClassName('RSGOFradio1'+'radio');
	a[0].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RSGOFAnswerDiv);}</script></td></tr>
	<tr><td>Expected:</td>
	<td><script>printRadioList('RSGOFradio2');
	var a=document.getElementsByClassName('RSGOFradio2'+'radio');
	a[1].checked=true;
	for (let i=0;i<a.length;i++)
		a[i].onclick=function(){purge(RSGOFAnswerDiv);}</script></td></tr>
	</table>



<button onclick='RSCalculateGOF();'>Calculate</button>
<div id='RSGOFAnswerDiv' class='answerDiv'>
	<div id='RSGOFanswer'></div>
	<canvas id='RSGOFcanvas' width="400" height="200"></canvas>
</div>
</div>
<script>
function chiGOF(observed, expected){
	var x=0;
	var diff, expect;
	var i;
	var n=observed.length;
	for (i=0;i<n;i++){
		expect=expected[i];
		diff=observed[i]-expect;
		x+=diff*diff/expect;
	}

	return(x);
}
function bootstrapGOF(observed, probabilities, sampleMeans){
	var i,j,s;
	var expected=[];
	var population=[];
	var sample=[];
	var cutoffs=[];
	var counts=[];
	var cumulativeProbabilities=[];
	var numSamples=globalNumSamples;
	var populationSize=1000;
	var n=observed.length;
	var r=summarizeArray(observed);
	var sampleSize=r.sum;
	var x;
	for (i=0;i<n;i++)
		expected[i]=probabilities[i]*sampleSize;
	var chi=chiGOF(observed, expected); 
	var pgt=0;
	cumulativeProbabilities[0]=probabilities[0];
	for (i=1;i<n;i++)
		cumulativeProbabilities[i]=probabilities[i]+cumulativeProbabilities[i-1];
	cumulativeProbabilities[cumulativeProbabilities.length-1]=1;
	for (i=0;i<n;i++)
		cutoffs[i]=populationSize*cumulativeProbabilities[i];
	j=0;
	for (i=0;i<n;i++)
		for (;j<cutoffs[i];j++)
			population.push(i);
	for (s=0;s<numSamples;s++){
		sample=[];
		for (i=0;i<sampleSize;i++)
			sample.push(population[floor(random()*populationSize)]);
		counts=[];
		for (i=0;i<n;i++)
			counts[i]=0;
		for (i=0;i<sampleSize;i++)
			counts[sample[i]]++;
		x=chiGOF(counts, expected);
		sampleMeans.push(x);	
		if (x>=chi) pgt++;
	}
	return({x: chi, p: pgt/numSamples});	
}
function RSCalculateGOF(){
try{
	var l1=getChecked('RSmpradio1');
	var l2=getChecked('RSmpradio2');
	if (l1==l2) alert('Select two different lists.');
	else if(listN[l1]*listN[l2]==0) alert('One of your lists is empty.');
	else if (listN[l1]!=listN[l2]) alert('Your lists need to be the same length.');
	else{	
		var n=listN[l1];
		var observed=[];
		var probabilities=[];
		var i;
		for (i=0;i<n;i++){
			observed[i]=list[l1][i];
			probabilities[i]=list[l2][i]/listSum[l2];
		}
		var sampleMeans=[];
		var chi=bootstrapGOF(observed, probabilities, sampleMeans);
		var dummy=[chi.x];
		var bounds=[null,chi.x]
		drawBootSummary(RSGOFcanvas, sampleMeans,dummy, [], [], bounds);
		RSGOFanswer.innerHTML='<ul><li>P= '+chi.p.TOFIXED(printPrecision)+'</li><li>&chi;<sup>2</sup>='+chi.x.TOFIXED(printPrecision)+'</li></ul>';
		RSGOFAnswerDiv.style.display='block';
		
	}
	
}
catch{
	alert('Input Error.');
}
}
</script>

<li><button class='expander' data-open='CTResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoPropResample,TwoMeanResample,MPResample,CorrelationResample,GOFResample,ANOVAResample'>Contingency Table</button></li>
<div id='CTResample' class='expandable'>
<!--Mimic GOF process (or just reuse it).-->

Select at least three lists to include in the test.<br>
Lists: <script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  id='RSCTlist"+i+"' onclick='purge(RSCTAnswerDiv);'  class='RSCTcheckbox'><span class='RSCTlabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('RSCT'+'label');		
	var a=document.getElementsByClassName('RSCTcheckbox');
	a[0].checked=true;
	a[1].checked=true;
</script><br>
<button onclick='RSCalculateCT();'>Calculate</button>
<div id='RSCTAnswerDiv' class='answerDiv'>
	<div id='RSCTanswer'></div>
	<canvas id='RSCTcanvas' width="400" height="200"></canvas>
</div>
</div>
<script>
function RSCalculateCT(){

try{
	var i=0;
	var notempty=true;
	var samelength=true;
	var j=numLists-1;
	var k;
	var abox=document.getElementsByClassName('RSCTcheckbox');

	var n=0;
	var f,l;
	for (i=0;i<numLists;i++)
		if (abox[i].checked){
			if (listN[i]<2) abox[i].checked=false;
			else n++;
		}
		
	if (n<2) alert('Select multiple lists to be included in the test.');
	else{
		f=0;
		while (abox[f].checked==false) f++;
		for (i=0;i<numLists;i++)
			if ((abox[i].checked) && (listN[i]!=listN[f]))
				samelength=false;
				
		if (!samelength) alert('Your lists must be the same length.');
		else{ 
			var Observed=[];
			var Expected=[];
			var ColumnTotals=[];
			var RowTotals=[];
			for (x=0;x<n;x++){
				Observed[x]=[];
				Expected[x]=[];
			}
			
			var i=0,j=0;
			for (x=0;x<numLists;x++)
				if (abox[x].checked){
					for (y=0;y<listN[x];y++)
						Observed[i].push(list[x][y]);
					ColumnTotals[i]=listSum[x];
					i++;	
				}
			var r, c, ct, rt, tt,nr,nc,P;
			var x,y,k,i;
			var l0=numLists;

			nr=Observed[0].length;
			var aa=[];
			var a=[];
			var b=[];
			
			nc=n;
			tt=0;
			
			for (x=0;x<nc;x++)
				for (y=0;y<nr;y++)
					tt+=Observed[x][y];
					
			for (y=0;y<nr;y++){
				RowTotals[y]=0;
				for (k=0;k<nc;k++)
					RowTotals[y]+=Observed[k][y];
			}			
			
			for (x=0;x<nc;x++)
				for (y=0;y<nr;y++)
					Expected[x][y]=RowTotals[y]*ColumnTotals[x]/tt;
					
			var OB=[], EX=[];
			for (x=0;x<nc;x++)
				for (y=0;y<nr;y++){
					OB.push(Observed[x][y]);
					EX.push(Expected[x][y]);
				}
			var r=summarizeArray(EX);
			for (i=0;i<EX.length;i++) 
				EX[i]=EX[i]/r.sum;
			var sampleMeans=[];
			var chi=bootstrapGOF(OB, EX, sampleMeans);
			var dummy=[chi.x];
			var bounds=[null,chi.x]
			drawBootSummary(RSCTcanvas, sampleMeans,dummy, [], [], bounds);
			RSCTanswer.innerHTML='<ul><li>P= '+chi.p.TOFIXED(printPrecision)+'</li><li>&chi;<sup>2</sup>='+chi.x.TOFIXED(printPrecision)+'</li></ul>';
			RSCTAnswerDiv.style.display='block';
		}
	}

}
catch(err){
	alert('Input Error.');
}	

}
</script>

<li><button class='expander' data-open='ANOVAResample' data-close='resampleAbout,OnePropResample,OneMeanResample,TwoPropResample,TwoMeanResample,MPResample,CorrelationResample,GOFResample,CTResample'>ANOVA</button></li>
<div id='ANOVAResample' class='expandable'>
<!--Combine samples into one population. Resample WITHOUT REPLACEMENT from this population to form samples with the original sizes and calculate F for each. Compare these to the original F.-->

Select at least three lists to include in the test.<br>
Lists: <script>
	for (let i=0;i<numLists;i++)
		document.write("<label><input type='checkbox'  id='RSANOVAlist"+i+"' onclick='purge(RSANOVAAnswerDiv);'  class='RSANOVAcheckbox'><span class='RSANOVAlabel'>"+listLabel[i]+"</span></label>&nbsp;");
	allLabelNames.push('RSANOVA'+'label');	
	var a=document.getElementsByClassName('RSANOVAcheckbox');
	a[0].checked=true;
	a[1].checked=true;
	a[2].checked=true;
</script><br>
<button onclick='RSCalculateANOVA();'>Calculate</button>
<div id='RSANOVAAnswerDiv' class='answerDiv'>
	<div id='RSANOVAanswer'></div>
	<canvas id='RSANOVAcanvas' width="400" height="200"></canvas>
</div>
</div>
<script>
function RSCalculateANOVA(){
try{
	var i,j,l,s;
	var listempty=false;  
	//k is the number of lists
	var k=0;
	var a= document.getElementsByClassName('RSANOVAcheckbox');
	var listsToInclude=[];
	var ni=[];
	var population=[];
	for (i=0;i<numLists;i++)
		if (listN[i]==0) a[i].checked=false;
	for (i=0;i<numLists;i++)
		if (a[i].checked) {
			k++; 
			listsToInclude.push(i);
		}
	if (k<3)
		alert('Select three or more nonempty lists.');
	else{ 
		//make array of samples and a population
		var P=[];
		var population=[];
		for (i=0;i<k;i++){
			P[i]=[];
			l=listsToInclude[i];
			for (j=0;j<listN[l];j++){
				P[i][j]=list[l][j];
				population.push(list[l][j]);
			}
		}
		var n=[];
		for (i=0;i<k;i++)
			n[i]=P[i].length;
		var firstReport=anovaF(P);
		var numSamples=globalNumSamples;
		var samples=[];
		var sampleMeans=[];
		var permuted=[];
		var sampleReport;
		var pgt=0;
		for (s=0;s<numSamples;s++){
			samples=[];
			for (i=0;i<k;i++)
				samples[i]=[];
			permuted=[];
			permute(population, permuted);
			l=0;
			for (i=0;i<k;i++)
				for (j=0;j<n[i];j++)
					samples[i].push(permuted[l++]);
			sampleReport=anovaF(samples);
			sampleMeans.push(sampleReport.F);
			if (sampleReport.F>=firstReport.F) pgt++;
		}
		var p=pgt/numSamples;
		bounds=[null,firstReport.F];
		var dummy=[firstReport.F];
		drawBootSummary(RSANOVAcanvas, sampleMeans,dummy, [], [], bounds);
		RSANOVAanswer.innerHTML='<ul><li>P= '+p.TOFIXED(printPrecision)+'</li><li>F= '+firstReport.F.TOFIXED(printPrecision)+'</li></ul>';
		RSANOVAAnswerDiv.style.display='block';
	}	
}
catch{
	alert('Input error.');
}
}
function anovaF(P){
	//assume that P is an array of arrays. P[i] is an array with the ith sample.
	var r=[]; //for list summaries
	var i,j;
	var k=P.length; //number of samples
	for (i=0;i<k;i++)
		r[i]=summarizeArray(P[i]);
	var N=0; //sum of sample sizes
	for (i=0;i<k;i++)
		N+=r[i].n;
	var SUM=0; //total sum;
	for (i=0;i<k;i++)
		for (j=0;j<r[i].n;j++)
			SUM+=P[i][j];
	var GM=SUM/N; //grand mean
	var SSB=0; //sum of squares between groups
	for (i=0;i<k;i++)
		SSB+=r[i].n*(r[i].m-GM)*(r[i].m-GM);
	var SSW=0; //sum of squares within groups
	for (i=0;i<k;i++)
		SSW+=(r[i].n-1)*r[i].s2;
	var MSB=SSB/(k-1); //mean sum of squares between
	var MSW=SSW/(N-k);
	var F=MSB/MSW;
	return({SSB: SSB, SSW: SSW, MSB: MSB, MSW: MSW, F: F, DFB: k-1, DFW: N-k}); 
/**/}
</script>
</ul>
</div><!--resample div -->

<!--subpage for tests-->
</div>
<!--subpage for tests-->
</div> <!-- testsDiv-->
<!--tests------------------------------------------------------------->


</div> <!--content-->

<div id='settings'>
<button class='closer' onclick='hideSettings()'>X</button>
<h4>Settings</h4>
<ul>
<li> <label><input type='checkbox' id='specialBox' onclick='showhidespecials();'> Hide bootstrap, nonparametric, and resampling options.</label></li>
<li> Data separation character: <label><input type='radio' onclick='setSeparationCharacter(",");' name='separationcharacter' checked=true> comma</label> &nbsp;
<label><input type='radio' onclick='setSeparationCharacter(";");' name='separationcharacter'> semicolon</label></li>
<li> Number of bootstrap samples:
<label><input type='radio' onclick='setBootstrapSamples(10000);' name='numsamplesradio' checked=true> 10000</label>
<label><input type='radio' onclick='setBootstrapSamples(5000);' name='numsamplesradio' > 5000</label>
<label><input type='radio' onclick='setBootstrapSamples(1000);' name='numsamplesradio' > 1000</label>
<label><input type='radio' onclick='setBootstrapSamples(100);' name='numsamplesradio' > 100</label>
</li>
</ul>
</div>
<script>
function setBootstrapSamples(n){
	globalNumSamples=n;
}
function setSeparationCharacter(c){
	globalSeparationCharacter=c;
}
function showSettings(){
	if (settings.style.display!='block') settings.style.display='block';
	else settings.style.display='none';
}
function hideSettings(){
	settings.style.display='none';
}
function showhidespecials(){
	var a=document.getElementsByClassName('special');
	var i;
	for (i=0;i<a.length;i++)
		if (a[i].style.display!='none') a[i].style.display='none';
		else  a[i].style.display='inline';
}
</script>

</body>
<script>setupAll();</script>
<script>

function getPasteTargetIndex(ID){
	var r=-1;
	var i;
	for (i=0;i<numLists;i++){
		if (listTextArea[i].id==ID)
			r=i;
	}		
	return(r);		
}

function setuppaste(){

	for (l=0;l<numLists;l++)
	listTextArea[l].addEventListener('paste', (event) => { 
			// Access the pasted data
			var i=getPasteTargetIndex(event.target.id);
			var pastedData = event.clipboardData.getData('text/plain');
			var rows=pastedData.split('\n');
			var alldata=[];
			var maxcols=0;
			var j,k;
			for (j=0;j<rows.length;j++){
				alldata[j]=rows[j].split('\t');
				if (maxcols<alldata[j].length) maxcols=alldata[j].length;
			}
			if (i+maxcols>numLists)
				alert('Sorry, that is too many columns.')
			else{
				for (j=0;j<maxcols;j++)
					list[i+j]=[];
				for (j=0;j<alldata.length;j++){
					for (k=0;k<alldata[j].length;k++)
						list[i+k].push(alldata[j][k]);
				}
				printLists();
				processLists();
			}	
			event.preventDefault();
		});
		
}
setuppaste();

</script>
</html>